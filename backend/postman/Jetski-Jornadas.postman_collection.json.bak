{
  "info": {
    "_postman_id": "jetski-jornadas-v2",
    "name": "Jetski - Jornadas por Persona",
    "description": "Collection organizada por jornadas com **PERSONAS REAIS** executando cada operaÃ§Ã£o.\n\n## ğŸ‘¥ Personas do Sistema\n\n- ğŸ‘‘ **ADMIN_TENANT**: Administrador do tenant (cria dados mestres, convida usuÃ¡rios)\n- ğŸ‘” **GERENTE**: Gerente de operaÃ§Ãµes (confirma reservas, autoriza operaÃ§Ãµes)\n- ğŸ¯ **OPERADOR**: Operador de pier (check-in, check-out, opera o sistema)\n- ğŸ’¼ **VENDEDOR**: Vendedor/Parceiro (cria reservas, atende clientes)\n- ğŸ”§ **MECANICO**: MecÃ¢nico (executa manutenÃ§Ãµes, registra peÃ§as) ğŸ†• v2.2\n\n## ğŸ­ AutenticaÃ§Ã£o Multi-Persona\n\nCada jornada usa o token da persona correta:\n- Vendedor cria reserva â†’ usa `vendedor_token`\n- Gerente confirma â†’ usa `gerente_token`\n- Operador faz check-in/out â†’ usa `operador_token`\n- Admin configura sistema â†’ usa `admin_token`\n\n## âœ… Testes Automatizados (v2.1+)\n\n**100% dos requests possuem validaÃ§Ãµes:**\n- Status codes esperados (200, 201, 400, 401, 403, 404)\n- Estrutura de response (IDs, campos obrigatÃ³rios)\n- TransiÃ§Ãµes de estado (AGUARDANDO_SINAL â†’ CONFIRMADA â†’ EM_CURSO â†’ FINALIZADA)\n- Regras de negÃ³cio (RN01: arredondamento de 15 minutos)\n\n**Logs visuais de billing (RN01):**\n- Check-outs exibem cÃ¡lculo detalhado no console\n- FÃ³rmula: `billable = ceil((used - tolerance) / 15) Ã— 15`\n- Exemplo:\n```\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\nâ•‘         ğŸ“Š CÃLCULO RN01 - LOCAÃ‡ÃƒO              â•‘\nâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\nâ•‘ â±ï¸  Tempo Usado:        45 minutos            â•‘\nâ•‘ ğŸ TolerÃ¢ncia:          5 minutos             â•‘\nâ•‘ ğŸ’° Tempo CobrÃ¡vel:      45 min                â•‘\nâ•‘ ğŸ’µ Valor Total:         R$ 262.50             â•‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n```\n\n## Como usar\n\n1. Configure no **ambiente** as credenciais de cada persona:\n   - `admin_username` / `admin_password`\n   - `gerente_username` / `gerente_password`\n   - `operador_username` / `operador_password`\n   - `vendedor_username` / `vendedor_password`\n\n2. Execute **\"0. Setup - Autenticar Personas\"** para obter todos os tokens\n\n3. Execute as jornadas em ordem - cada request usa automaticamente o token correto!\n\n4. Verifique o **Console do Postman** para ver logs de execuÃ§Ã£o e cÃ¡lculos RN01\n\n## Jornadas DisponÃ­veis\n\n### ğŸ” 0. Setup - Autenticar Personas\nObtÃ©m tokens de todas as 4 personas (Admin, Gerente, Operador, Vendedor)\n\n### ğŸ—ï¸ 1. ConfiguraÃ§Ã£o do Sistema (Admin)\nAdmin cria: Modelo â†’ Jetski â†’ Vendedor â†’ Cliente\n\n### ğŸ“… 2. Cliente com Reserva - Multi-Persona\n1. Cliente aceita termos (Operador)\n2. **Vendedor** cria reserva ğŸ’¼\n3. Cliente paga sinal (Vendedor)\n4. **Gerente** confirma reserva ğŸ‘”\n5. **Operador** aloca jetski ğŸ¯\n6. **Operador** faz check-in ğŸ¯\n7. **Operador** faz check-out ğŸ¯ (com log RN01)\n8. Consultar resultado (Gerente)\n\n### ğŸš¶ 3. Cliente Walk-in (Operador)\nOperador verifica disponibilidade â†’ Check-in â†’ Check-out (com log RN01)\n\n### ğŸ”§ 4. ManutenÃ§Ã£o Preventiva - Multi-Persona ğŸ†• v2.2\nFluxo completo de manutenÃ§Ã£o com bloqueio de agendamento (RN06):\n1. ğŸ¯ Operador: Altera status para MANUTENCAO\n2. ğŸ’¼ Vendedor: Tenta criar reserva (**DEVE FALHAR** - 400)\n3. ğŸ¯ Operador: Retorna status para DISPONIVEL\n4. ğŸ’¼ Vendedor: Cria reserva (**AGORA FUNCIONA** - 201)\n\n### ğŸš« 6. Jornadas Negativas - Testes RBAC\n**10 cenÃ¡rios de teste de autorizaÃ§Ã£o:**\n- 5 violaÃ§Ãµes de papel (403 Forbidden)\n- 3 violaÃ§Ãµes de autenticaÃ§Ã£o (401 Unauthorized)\n- 2 violaÃ§Ãµes de lÃ³gica de negÃ³cio (400 Bad Request)\n\n### ğŸ“Š 7. Consultas por Persona\nCada persona consulta o que tem permissÃ£o\n\n---\n\n**VersÃ£o:** 2.3.0 (Environments Multi-Persona + Testes Data-Driven)  \n**Ãšltima atualizaÃ§Ã£o:** 2025-10-25  \n**Sprint:** 2 (Check-in/Check-out)  \n**Changelog v2.2:**\n- ğŸ†• 5Âª persona: ğŸ”§ MECANICO com autenticaÃ§Ã£o separada\n- ğŸ†• Jornada de ManutenÃ§Ã£o Preventiva com teste RN06\n- ğŸ†• ValidaÃ§Ã£o de bloqueio de agendamento durante manutenÃ§Ã£o\n- ğŸ“ RenumeraÃ§Ã£o de seÃ§Ãµes (4â†’ManutenÃ§Ã£o, 6â†’Negativas, 7â†’Consultas)\n\n**Changelog v2.1:**\n- âœ… Testes automatizados em 100% dos requests\n- âœ… Logs visuais de cÃ¡lculo RN01 nos check-outs\n- âœ… 10 cenÃ¡rios de testes negativos (RBAC + Auth + Business Logic)\n- âœ… ValidaÃ§Ãµes de transiÃ§Ãµes de estado\n\n**Changelog v2.3:**\n- ğŸŒ 3 ambientes prÃ©-configurados (Local/Dev/Staging) com credenciais de 5 personas\n- ğŸ“Š Arquivo CSV com 10 cenÃ¡rios de teste RN01 para data-driven testing\n- ğŸ”— VariÃ¡vel base_url adicionada como alias de api_url\n- ğŸ“‚ Pasta data/ criada para arquivos de teste\n- ğŸ“ DocumentaÃ§Ã£o completa de ambientes e testes data-driven",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "jetski-team"
  },
  "variable": [
    {
      "key": "admin_token",
      "value": "",
      "type": "string",
      "description": "JWT do ADMIN_TENANT"
    },
    {
      "key": "gerente_token",
      "value": "",
      "type": "string",
      "description": "JWT do GERENTE"
    },
    {
      "key": "operador_token",
      "value": "",
      "type": "string",
      "description": "JWT do OPERADOR"
    },
    {
      "key": "vendedor_token",
      "value": "",
      "type": "string",
      "description": "JWT do VENDEDOR"
    },
    {
      "key": "mecanico_token",
      "value": "",
      "type": "string",
      "description": "JWT do MECANICO"
    },
    {
      "key": "modelo_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "jetski_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "vendedor_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "cliente_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "reserva_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "locacao_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "os_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "ğŸ” 0. Setup - Autenticar Personas",
      "description": "ObtÃ©m tokens JWT de todas as 5 personas do sistema.\n\n**Configurar no ambiente:**\n- admin_username / admin_password\n- gerente_username / gerente_password\n- operador_username / operador_password\n- vendedor_username / vendedor_password\n- mecanico_username / mecanico_password\n\n**Resultado:**\nTokens salvos em variÃ¡veis de coleÃ§Ã£o para uso automÃ¡tico nas jornadas.",
      "item": [
        {
          "name": "1. ğŸ‘‘ Login Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m access_token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.access_token).to.be.a('string');",
                  "    pm.expect(jsonData.access_token.length).to.be.greaterThan(100);",
                  "});",
                  "",
                  "pm.test('Token type Ã© Bearer', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('admin_token', jsonData.access_token);",
                  "    console.log('âœ… ğŸ‘‘ ADMIN_TENANT autenticado com sucesso!');",
                  "} else {",
                  "    console.error('âŒ Erro ao autenticar admin:', pm.response.text());",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {"key": "grant_type", "value": "password"},
                {"key": "client_id", "value": "{{client_id}}"},
                {"key": "client_secret", "value": "{{client_secret}}"},
                {"key": "username", "value": "{{admin_username}}"},
                {"key": "password", "value": "{{admin_password}}"},
                {"key": "scope", "value": "openid profile email"}
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/{{keycloak_realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{keycloak_realm}}", "protocol", "openid-connect", "token"]
            },
            "description": "Autentica como **ADMIN_TENANT** e salva token em `admin_token`"
          }
        },
        {
          "name": "2. ğŸ‘” Login Gerente",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m access_token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.access_token).to.be.a('string');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('gerente_token', jsonData.access_token);",
                  "    console.log('âœ… ğŸ‘” GERENTE autenticado com sucesso!');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {"key": "grant_type", "value": "password"},
                {"key": "client_id", "value": "{{client_id}}"},
                {"key": "client_secret", "value": "{{client_secret}}"},
                {"key": "username", "value": "{{gerente_username}}"},
                {"key": "password", "value": "{{gerente_password}}"},
                {"key": "scope", "value": "openid profile email"}
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/{{keycloak_realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{keycloak_realm}}", "protocol", "openid-connect", "token"]
            },
            "description": "Autentica como **GERENTE** e salva token em `gerente_token`"
          }
        },
        {
          "name": "3. ğŸ¯ Login Operador",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m access_token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.access_token).to.be.a('string');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('operador_token', jsonData.access_token);",
                  "    console.log('âœ… ğŸ¯ OPERADOR autenticado com sucesso!');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {"key": "grant_type", "value": "password"},
                {"key": "client_id", "value": "{{client_id}}"},
                {"key": "client_secret", "value": "{{client_secret}}"},
                {"key": "username", "value": "{{operador_username}}"},
                {"key": "password", "value": "{{operador_password}}"},
                {"key": "scope", "value": "openid profile email"}
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/{{keycloak_realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{keycloak_realm}}", "protocol", "openid-connect", "token"]
            },
            "description": "Autentica como **OPERADOR** e salva token em `operador_token`"
          }
        },
        {
          "name": "4. ğŸ’¼ Login Vendedor",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m access_token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.access_token).to.be.a('string');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('vendedor_token', jsonData.access_token);",
                  "    console.log('âœ… ğŸ’¼ VENDEDOR autenticado com sucesso!');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {"key": "grant_type", "value": "password"},
                {"key": "client_id", "value": "{{client_id}}"},
                {"key": "client_secret", "value": "{{client_secret}}"},
                {"key": "username", "value": "{{vendedor_username}}"},
                {"key": "password", "value": "{{vendedor_password}}"},
                {"key": "scope", "value": "openid profile email"}
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/{{keycloak_realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{keycloak_realm}}", "protocol", "openid-connect", "token"]
            },
            "description": "Autentica como **VENDEDOR** e salva token em `vendedor_token`"
          }
        },
        {
          "name": "5. ğŸ”§ Login MecÃ¢nico",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m access_token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.access_token).to.be.a('string');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('mecanico_token', jsonData.access_token);",
                  "    console.log('âœ… ğŸ”§ MECANICO autenticado com sucesso!');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {"key": "grant_type", "value": "password"},
                {"key": "client_id", "value": "{{client_id}}"},
                {"key": "client_secret", "value": "{{client_secret}}"},
                {"key": "username", "value": "{{mecanico_username}}"},
                {"key": "password", "value": "{{mecanico_password}}"},
                {"key": "scope", "value": "openid profile email"}
              ]
            },
            "url": {
              "raw": "{{keycloak_url}}/realms/{{keycloak_realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{keycloak_realm}}", "protocol", "openid-connect", "token"]
            },
            "description": "Autentica como **MECANICO** e salva token em `mecanico_token`"
          }
        },
        {
          "name": "6. ğŸ¯ Get Tenant ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m array de tenants', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.tenants).to.be.an('array');",
                  "    pm.expect(response.tenants.length).to.be.greaterThan(0);",
                  "});",
                  "",
                  "pm.test('Primeiro tenant possui ID vÃ¡lido', function () {",
                  "    const response = pm.response.json();",
                  "    const tenant = response.tenants[0];",
                  "    pm.expect(tenant.tenantId).to.be.a('string');",
                  "    pm.expect(tenant.roles).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.tenants && response.tenants.length > 0) {",
                  "        const tenant = response.tenants[0];",
                  "        pm.environment.set('tenant_id', tenant.tenantId);",
                  "        console.log('âœ… Tenant configurado:', tenant.tenantId);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/user/tenants",
              "host": ["{{base_url}}"],
              "path": ["v1", "user", "tenants"]
            },
            "description": "ObtÃ©m tenant_id usando token do operador"
          }
        }
      ]
    },
    {
      "name": "ğŸ—ï¸ 1. ConfiguraÃ§Ã£o do Sistema (Admin)",
      "description": "ğŸ‘‘ **ADMIN_TENANT** configura dados mestres do sistema",
      "item": [
        {
          "name": "1.1. ğŸ‘‘ Admin cria Modelo",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Gera timestamp Ãºnico para evitar duplicaÃ§Ã£o em mÃºltiplas execuÃ§Ãµes",
                  "const timestamp = Date.now();",
                  "pm.collectionVariables.set('run_timestamp', timestamp);",
                  "pm.collectionVariables.set('modelo_nome', `VX Cruiser HO ${timestamp}`);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m modelo_id', function () {",
                  "    const modelo = pm.response.json();",
                  "    pm.expect(modelo.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Modelo possui dados corretos', function () {",
                  "    const modelo = pm.response.json();",
                  "    pm.expect(modelo.nome).to.include('VX Cruiser HO');",
                  "    pm.expect(modelo.fabricante).to.eql('Yamaha');",
                  "});",
                  "",
                  "pm.test('PreÃ§o base e tolerÃ¢ncia estÃ£o corretos', function () {",
                  "    const modelo = pm.response.json();",
                  "    pm.expect(modelo.precoBaseHora).to.eql(350.00);",
                  "    pm.expect(modelo.toleranciaMin).to.eql(5);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const modelo = pm.response.json();",
                  "    pm.collectionVariables.set('modelo_id', modelo.id);",
                  "    console.log('âœ… ğŸ‘‘ Admin criou modelo:', modelo.nome, '(', modelo.id, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{admin_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fabricante\": \"Yamaha\",\n  \"nome\": \"{{modelo_nome}}\",\n  \"capacidadePessoas\": 3,\n  \"potenciaHp\": 180,\n  \"precoBaseHora\": 350.00,\n  \"toleranciaMin\": 5,\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/modelos",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "modelos"]
            },
            "description": "**Persona:** ğŸ‘‘ ADMIN_TENANT\n\nAdmin cria modelo de jetski (Yamaha VX Cruiser)"
          }
        },
        {
          "name": "1.2. ğŸ‘‘ Admin cadastra Jetski",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Usa o timestamp da execuÃ§Ã£o para gerar sÃ©rie Ãºnica",
                  "const timestamp = pm.collectionVariables.get('run_timestamp') || Date.now();",
                  "pm.collectionVariables.set('jetski_serie', `YAMAHA-VX-${timestamp}`);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m jetski_id', function () {",
                  "    const jetski = pm.response.json();",
                  "    pm.expect(jetski.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Jetski estÃ¡ vinculado ao modelo correto', function () {",
                  "    const jetski = pm.response.json();",
                  "    pm.expect(jetski.modeloId).to.eql(pm.collectionVariables.get('modelo_id'));",
                  "});",
                  "",
                  "pm.test('Jetski estÃ¡ DISPONIVEL', function () {",
                  "    const jetski = pm.response.json();",
                  "    pm.expect(jetski.status).to.eql('DISPONIVEL');",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const jetski = pm.response.json();",
                  "    pm.collectionVariables.set('jetski_id', jetski.id);",
                  "    console.log('âœ… ğŸ‘‘ Admin cadastrou jetski:', jetski.serie, '(', jetski.id, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{admin_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modeloId\": \"{{modelo_id}}\",\n  \"serie\": \"{{jetski_serie}}\",\n  \"ano\": 2024,\n  \"horimetroAtual\": 100.5,\n  \"status\": \"DISPONIVEL\",\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/jetskis",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "jetskis"]
            },
            "description": "**Persona:** ğŸ‘‘ ADMIN_TENANT\n\nAdmin cadastra jetski fÃ­sico na frota"
          }
        },
        {
          "name": "1.3. ğŸ‘‘ Admin cadastra Vendedor",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Usa o timestamp da execuÃ§Ã£o para gerar nome e documento Ãºnicos",
                  "const timestamp = pm.collectionVariables.get('run_timestamp') || Date.now();",
                  "pm.collectionVariables.set('vendedor_nome', `JoÃ£o Silva ${timestamp}`);",
                  "pm.collectionVariables.set('vendedor_documento', `${timestamp.toString().slice(-11)}`);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m vendedor_id', function () {",
                  "    const vendedor = pm.response.json();",
                  "    pm.expect(vendedor.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Vendedor possui comissÃ£o configurada', function () {",
                  "    const vendedor = pm.response.json();",
                  "    // Backend retorna regraComissaoJson (string) ao invÃ©s de objeto estruturado",
                  "    if (vendedor.regraComissaoJson) {",
                  "        const regra = JSON.parse(vendedor.regraComissaoJson);",
                  "        pm.expect(regra.tipo).to.eql('PERCENTUAL');",
                  "        pm.expect(regra.valor).to.eql(10.0);",
                  "    } else if (vendedor.regraComissao) {",
                  "        // Fallback caso backend mude para objeto estruturado",
                  "        pm.expect(vendedor.regraComissao.tipo).to.eql('PERCENTUAL');",
                  "        pm.expect(vendedor.regraComissao.valor).to.eql(10.0);",
                  "    } else {",
                  "        // Se nenhum campo de comissÃ£o presente, apenas valida criaÃ§Ã£o",
                  "        pm.expect(vendedor.id).to.exist;",
                  "    }",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const vendedor = pm.response.json();",
                  "    pm.collectionVariables.set('vendedor_id', vendedor.id);",
                  "    console.log('âœ… ğŸ‘‘ Admin cadastrou vendedor:', vendedor.nome, '(', vendedor.id, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{admin_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"{{vendedor_nome}}\",\n  \"tipo\": \"PARCEIRO\",\n  \"documento\": \"{{vendedor_documento}}\",\n  \"regraComissao\": {\n    \"tipo\": \"PERCENTUAL\",\n    \"valor\": 10.0\n  },\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/vendedores",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "vendedores"]
            },
            "description": "**Persona:** ğŸ‘‘ ADMIN_TENANT\n\nAdmin cadastra vendedor/parceiro"
          }
        },
        {
          "name": "1.4. ğŸ‘‘ Admin cadastra Cliente",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Usa o timestamp da execuÃ§Ã£o para gerar dados Ãºnicos do cliente",
                  "const timestamp = pm.collectionVariables.get('run_timestamp') || Date.now();",
                  "pm.collectionVariables.set('cliente_nome', `Maria Oliveira ${timestamp}`);",
                  "pm.collectionVariables.set('cliente_documento', `${timestamp.toString().slice(-11)}`);",
                  "pm.collectionVariables.set('cliente_email', `maria.${timestamp}@example.com`);"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m cliente_id', function () {",
                  "    const cliente = pm.response.json();",
                  "    pm.expect(cliente.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Cliente possui dados completos', function () {",
                  "    const cliente = pm.response.json();",
                  "    pm.expect(cliente.nome).to.exist;",
                  "    pm.expect(cliente.email).to.exist;",
                  "    pm.expect(cliente.documento).to.exist;",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const cliente = pm.response.json();",
                  "    pm.collectionVariables.set('cliente_id', cliente.id);",
                  "    console.log('âœ… ğŸ‘‘ Admin cadastrou cliente:', cliente.nome, '(', cliente.id, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{admin_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"{{cliente_nome}}\",\n  \"documento\": \"{{cliente_documento}}\",\n  \"email\": \"{{cliente_email}}\",\n  \"telefone\": \"+5511987654321\",\n  \"dataNascimento\": \"1990-05-15\",\n  \"genero\": \"FEMININO\",\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/clientes",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "clientes"]
            },
            "description": "**Persona:** ğŸ‘‘ ADMIN_TENANT\n\nAdmin cadastra cliente no sistema"
          }
        }
      ]
    },
    {
      "name": "ğŸ“… 2. Cliente com Reserva - Multi-Persona",
      "description": "Jornada completa com **4 personas diferentes**:\n\nğŸ¯ OPERADOR â†’ Cliente aceita termos\nğŸ’¼ VENDEDOR â†’ Cria reserva e confirma sinal\nğŸ‘” GERENTE â†’ Confirma reserva\nğŸ¯ OPERADOR â†’ Aloca jetski, check-in, check-out",
      "item": [
        {
          "name": "2.1. ğŸ¯ Operador: Cliente aceita termos",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"aceite\": true,\n  \"ipAddress\": \"192.168.1.100\",\n  \"userAgent\": \"PostmanRuntime\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/clientes/{{cliente_id}}/accept-terms",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "clientes", "{{cliente_id}}", "accept-terms"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador registra aceite de termos do cliente no balcÃ£o"
          }
        },
        {
          "name": "2.2. ğŸ’¼ Vendedor: Criar Reserva",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Gera data de inÃ­cio (agora + 1 hora)",
                  "const now = new Date();",
                  "const dataInicio = new Date(now.getTime() + (1 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('reserva_data_inicio', dataInicio.toISOString());",
                  "",
                  "// Gera data de fim (inÃ­cio + 2 horas)",
                  "const dataFim = new Date(dataInicio.getTime() + (2 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('reserva_data_fim', dataFim.toISOString());",
                  "",
                  "console.log('ğŸ“… Data inÃ­cio:', dataInicio.toISOString());",
                  "console.log('ğŸ“… Data fim:', dataFim.toISOString());"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m reserva_id', function () {",
                  "    const reserva = pm.response.json();",
                  "    pm.expect(reserva.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Status da reserva Ã© PENDENTE', function () {",
                  "    const reserva = pm.response.json();",
                  "    pm.expect(reserva.status).to.eql('PENDENTE');",
                  "});",
                  "",
                  "pm.test('Vendedor correto estÃ¡ associado', function () {",
                  "    const reserva = pm.response.json();",
                  "    pm.expect(reserva.vendedorId).to.eql(pm.collectionVariables.get('vendedor_id'));",
                  "});",
                  "",
                  "pm.test('Cliente e modelo estÃ£o vinculados', function () {",
                  "    const reserva = pm.response.json();",
                  "    pm.expect(reserva.clienteId).to.eql(pm.collectionVariables.get('cliente_id'));",
                  "    pm.expect(reserva.modeloId).to.eql(pm.collectionVariables.get('modelo_id'));",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const reserva = pm.response.json();",
                  "    pm.collectionVariables.set('reserva_id', reserva.id);",
                  "    console.log('âœ… ğŸ’¼ Vendedor criou reserva:', reserva.id, '(status:', reserva.status, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modeloId\": \"{{modelo_id}}\",\n  \"clienteId\": \"{{cliente_id}}\",\n  \"vendedorId\": \"{{vendedor_id}}\",\n  \"dataInicio\": \"{{reserva_data_inicio}}\",\n  \"dataFimPrevista\": \"{{reserva_data_fim}}\",\n  \"observacoes\": \"Reserva criada pelo vendedor\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas"]
            },
            "description": "**Persona:** ğŸ’¼ VENDEDOR\n\nVendedor cria reserva para o cliente (ganha comissÃ£o)"
          }
        },
        {
          "name": "2.3. ğŸ’¼ Vendedor: Confirmar Sinal",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"valorSinal\": 200.00\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas/{{reserva_id}}/confirmar-sinal",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas", "{{reserva_id}}", "confirmar-sinal"]
            },
            "description": "**Persona:** ğŸ’¼ VENDEDOR\n\nVendedor confirma pagamento do sinal pelo cliente"
          }
        },
        {
          "name": "2.4. ğŸ‘” Gerente: Confirmar Reserva",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{gerente_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas/{{reserva_id}}/confirmar",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas", "{{reserva_id}}", "confirmar"]
            },
            "description": "**Persona:** ğŸ‘” GERENTE\n\nGerente revisa e confirma a reserva (autorizaÃ§Ã£o necessÃ¡ria)"
          }
        },
        {
          "name": "2.5. ğŸ¯ Operador: Alocar Jetski",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"jetskiId\": \"{{jetski_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas/{{reserva_id}}/alocar-jetski",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas", "{{reserva_id}}", "alocar-jetski"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador aloca jetski especÃ­fico quando cliente chega"
          }
        },
        {
          "name": "2.6. ğŸ¯ Operador: Check-in",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m locacao_id', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Status da locaÃ§Ã£o Ã© EM_CURSO', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.status).to.eql('EM_CURSO');",
                  "});",
                  "",
                  "pm.test('Horimetro de inÃ­cio foi registrado', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.horimetroInicio).to.be.a('number');",
                  "    pm.expect(locacao.horimetroInicio).to.be.greaterThan(0);",
                  "});",
                  "",
                  "pm.test('Reserva estÃ¡ vinculada', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.reservaId).to.eql(pm.collectionVariables.get('reserva_id'));",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const locacao = pm.response.json();",
                  "    pm.collectionVariables.set('locacao_id', locacao.id);",
                  "    console.log('âœ… ğŸ¯ Operador fez check-in! LocaÃ§Ã£o:', locacao.id, '(status:', locacao.status, ')');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reservaId\": \"{{reserva_id}}\",\n  \"horimetroInicio\": 100.5,\n  \"observacoes\": \"Operador realizou check-in. Jetski revisado.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/check-in/reserva",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "check-in", "reserva"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador faz check-in do cliente no pier"
          }
        },
        {
          "name": "2.7. ğŸ¯ Operador: Check-out",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Status da locaÃ§Ã£o Ã© FINALIZADA', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.status).to.eql('FINALIZADA');",
                  "});",
                  "",
                  "pm.test('Horimetro de fim foi registrado', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.horimetroFim).to.be.a('number');",
                  "    pm.expect(locacao.horimetroFim).to.be.greaterThan(locacao.horimetroInicio);",
                  "});",
                  "",
                  "pm.test('RN01: CÃ¡lculo de tempo e valor realizados', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.minutosUsados).to.be.a('number');",
                  "    pm.expect(locacao.minutosFaturaveis).to.be.a('number');",
                  "    pm.expect(locacao.valorTotal).to.be.a('number');",
                  "});",
                  "",
                  "pm.test('RN01: Minutos faturÃ¡veis sÃ£o mÃºltiplos de 15', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.minutosFaturaveis % 15).to.eql(0);",
                  "});",
                  "",
                  "// Log visual do cÃ¡lculo RN01",
                  "if (pm.response.code === 200) {",
                  "    const l = pm.response.json();",
                  "    const usedMin = l.minutosUsados || 0;",
                  "    const tolerance = l.toleranciaMinutos || 0;",
                  "    const billableMin = l.minutosFaturaveis || 0;",
                  "    const valor = l.valorTotal || 0;",
                  "    ",
                  "    console.log('');",
                  "    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');",
                  "    console.log('â•‘         ğŸ“Š CÃLCULO RN01 - LOCAÃ‡ÃƒO              â•‘');",
                  "    console.log('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£');",
                  "    console.log('â•‘ â±ï¸  Tempo Usado:        ' + String(usedMin).padEnd(18) + ' minutos  â•‘');",
                  "    console.log('â•‘ ğŸ TolerÃ¢ncia:          ' + String(tolerance).padEnd(18) + ' minutos  â•‘');",
                  "    console.log('â•‘ ğŸ’° Tempo CobrÃ¡vel:      ' + String(billableMin).padEnd(18) + ' min      â•‘');",
                  "    console.log('â•‘ ğŸ’µ Valor Total:         R$ ' + String(valor.toFixed(2)).padEnd(16) + '      â•‘');",
                  "    console.log('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£');",
                  "    console.log('â•‘ ğŸ“ FÃ³rmula RN01:                               â•‘');",
                  "    console.log('â•‘ billable = ceil((used - tolerance) / 15) * 15  â•‘');",
                  "    console.log('â•‘ valor = (billable / 60) Ã— preÃ§o_hora           â•‘');",
                  "    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');",
                  "    console.log('');",
                  "    console.log('âœ… ğŸ¯ Operador finalizou locaÃ§Ã£o:', l.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"horimetroFim\": 102.75,\n  \"observacoes\": \"Operador realizou check-out. Cliente satisfeito.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/{{locacao_id}}/check-out",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "{{locacao_id}}", "check-out"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador faz check-out quando cliente retorna"
          }
        },
        {
          "name": "2.8. ğŸ‘” Gerente: Consultar Resultado",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{gerente_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/{{locacao_id}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "{{locacao_id}}"]
            },
            "description": "**Persona:** ğŸ‘” GERENTE\n\nGerente consulta locaÃ§Ã£o finalizada com RN01 aplicada"
          }
        }
      ]
    },
    {
      "name": "ğŸš¶ 3. Cliente Walk-in (Operador)",
      "description": "ğŸ¯ **OPERADOR** atende cliente sem reserva",
      "item": [
        {
          "name": "3.1. ğŸ¯ Operador: Verificar Disponibilidade",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Gera data de inÃ­cio (agora + 10 minutos) sem o 'Z' para LocalDateTime",
                  "const now = new Date();",
                  "const dataInicio = new Date(now.getTime() + (10 * 60 * 1000));",
                  "pm.collectionVariables.set('walk_in_data_inicio', dataInicio.toISOString().replace('Z', ''));",
                  "",
                  "// Gera data de fim (inÃ­cio + 2 horas) sem o 'Z' para LocalDateTime",
                  "const dataFim = new Date(dataInicio.getTime() + (2 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('walk_in_data_fim', dataFim.toISOString().replace('Z', ''));",
                  "",
                  "console.log('ğŸ“… Walk-in disponibilidade - Data inÃ­cio:', dataInicio.toISOString().replace('Z', ''));",
                  "console.log('ğŸ“… Walk-in disponibilidade - Data fim:', dataFim.toISOString().replace('Z', ''));"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas/disponibilidade?modeloId={{modelo_id}}&dataInicio={{walk_in_data_inicio}}&dataFimPrevista={{walk_in_data_fim}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas", "disponibilidade"],
              "query": [
                {"key": "modeloId", "value": "{{modelo_id}}"},
                {"key": "dataInicio", "value": "{{walk_in_data_inicio}}"},
                {"key": "dataFimPrevista", "value": "{{walk_in_data_fim}}"}
              ]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador verifica se hÃ¡ jetski disponÃ­vel"
          }
        },
        {
          "name": "3.2. ğŸ¯ Operador: Check-in Walk-in",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contÃ©m locacao_id', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.id).to.be.a('string');",
                  "});",
                  "",
                  "pm.test('Status da locaÃ§Ã£o Ã© EM_CURSO', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.status).to.eql('EM_CURSO');",
                  "});",
                  "",
                  "pm.test('NÃ£o possui reserva vinculada (walk-in)', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.reservaId).to.be.null;",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const locacao = pm.response.json();",
                  "    pm.collectionVariables.set('locacao_id', locacao.id);",
                  "    console.log('âœ… ğŸ¯ Operador fez check-in walk-in:', locacao.id, '(sem reserva)');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"jetskiId\": \"{{jetski_id}}\",\n  \"clienteId\": \"{{cliente_id}}\",\n  \"horimetroInicio\": 102.75,\n  \"duracaoPrevista\": 60,\n  \"observacoes\": \"Cliente walk-in sem reserva\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/check-in/walk-in",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "check-in", "walk-in"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador cria locaÃ§Ã£o direta para cliente sem reserva"
          }
        },
        {
          "name": "3.3. ğŸ¯ Operador: Check-out",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Status da locaÃ§Ã£o Ã© FINALIZADA', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.status).to.eql('FINALIZADA');",
                  "});",
                  "",
                  "pm.test('RN01: CÃ¡lculo de tempo e valor realizados', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.minutosUsados).to.be.a('number');",
                  "    pm.expect(locacao.minutosFaturaveis).to.be.a('number');",
                  "    pm.expect(locacao.valorTotal).to.be.a('number');",
                  "});",
                  "",
                  "pm.test('RN01: Minutos faturÃ¡veis sÃ£o mÃºltiplos de 15', function () {",
                  "    const locacao = pm.response.json();",
                  "    pm.expect(locacao.minutosFaturaveis % 15).to.eql(0);",
                  "});",
                  "",
                  "// Log visual do cÃ¡lculo RN01",
                  "if (pm.response.code === 200) {",
                  "    const l = pm.response.json();",
                  "    const usedMin = l.minutosUsados || 0;",
                  "    const tolerance = l.toleranciaMinutos || 0;",
                  "    const billableMin = l.minutosFaturaveis || 0;",
                  "    const valor = l.valorTotal || 0;",
                  "    ",
                  "    console.log('');",
                  "    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');",
                  "    console.log('â•‘      ğŸ“Š CÃLCULO RN01 - WALK-IN                 â•‘');",
                  "    console.log('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£');",
                  "    console.log('â•‘ â±ï¸  Tempo Usado:        ' + String(usedMin).padEnd(18) + ' minutos  â•‘');",
                  "    console.log('â•‘ ğŸ TolerÃ¢ncia:          ' + String(tolerance).padEnd(18) + ' minutos  â•‘');",
                  "    console.log('â•‘ ğŸ’° Tempo CobrÃ¡vel:      ' + String(billableMin).padEnd(18) + ' min      â•‘');",
                  "    console.log('â•‘ ğŸ’µ Valor Total:         R$ ' + String(valor.toFixed(2)).padEnd(16) + '      â•‘');",
                  "    console.log('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£');",
                  "    console.log('â•‘ ğŸ“ FÃ³rmula RN01:                               â•‘');",
                  "    console.log('â•‘ billable = ceil((used - tolerance) / 15) * 15  â•‘');",
                  "    console.log('â•‘ valor = (billable / 60) Ã— preÃ§o_hora           â•‘');",
                  "    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');",
                  "    console.log('');",
                  "    console.log('âœ… ğŸ¯ Operador finalizou walk-in:', l.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"horimetroFim\": 103.75,\n  \"observacoes\": \"Retorno OK\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/{{locacao_id}}/check-out",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "{{locacao_id}}", "check-out"]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador finaliza locaÃ§Ã£o walk-in"
          }
        }
      ]
    },
    {
      "name": "ğŸ”§ 4. ManutenÃ§Ã£o Preventiva - Multi-Persona",
      "description": "Jornada completa de manutenÃ§Ã£o com **bloqueio de agendamento**.\n\n**Fluxo:**\n1. ğŸ¯ Operador identifica problema no jetski\n2. ğŸ‘” Gerente cria OS de ManutenÃ§Ã£o (jetski â†’ INDISPONIVEL)\n3. ğŸ’¼ Vendedor tenta criar reserva (**DEVE FALHAR** - 400)\n4. ğŸ‘” Gerente atribui OS ao mecÃ¢nico\n5. ğŸ”§ MecÃ¢nico inicia manutenÃ§Ã£o\n6. ğŸ”§ MecÃ¢nico registra peÃ§as utilizadas\n7. ğŸ”§ MecÃ¢nico conclui manutenÃ§Ã£o\n8. ğŸ‘” Gerente aprova OS (jetski â†’ DISPONIVEL)\n9. ğŸ’¼ Vendedor cria reserva (**AGORA FUNCIONA** - 201)\n\n**Teste de Regra RN06:** Jetski em manutenÃ§Ã£o nÃ£o pode ser reservado.",
      "item": [
        {
          "name": "4.1. ğŸ¯ Operador: Alterar status para MANUTENCAO",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Jetski estÃ¡ em MANUTENCAO', function () {",
                  "    const jetski = pm.response.json();",
                  "    pm.expect(jetski.status).to.eql('MANUTENCAO');",
                  "});",
                  "",
                  "console.log('âœ… ğŸ¯ Operador alterou jetski para MANUTENCAO');"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/jetskis/{{jetski_id}}/status?status=MANUTENCAO",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "jetskis", "{{jetski_id}}", "status"],
              "query": [
                {"key": "status", "value": "MANUTENCAO"}
              ]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador identifica problema e altera status para MANUTENCAO. Jetski ficarÃ¡ INDISPONIVEL para novas reservas (RN06)."
          }
        },
        {
          "name": "4.2. ğŸ’¼ Vendedor: Tentar criar reserva (DEVE FALHAR)",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Gera data de inÃ­cio (agora + 30 minutos)",
                  "const now = new Date();",
                  "const dataInicio = new Date(now.getTime() + (30 * 60 * 1000));",
                  "pm.collectionVariables.set('manutencao_falha_data_inicio', dataInicio.toISOString());",
                  "",
                  "// Gera data de fim (inÃ­cio + 1 hora)",
                  "const dataFim = new Date(dataInicio.getTime() + (1 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('manutencao_falha_data_fim', dataFim.toISOString());"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 400 Bad Request', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Mensagem indica jetski indisponÃ­vel', function () {",
                  "    const error = pm.response.json();",
                  "    pm.expect(error.message).to.include('disponÃ­vel');",
                  "});",
                  "",
                  "console.log('âœ… RN06 validada: Jetski em manutenÃ§Ã£o NÃƒO pode ser reservado!');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modeloId\": \"{{modelo_id}}\",\n  \"jetskiId\": \"{{jetski_id}}\",\n  \"clienteId\": \"{{cliente_id}}\",\n  \"vendedorId\": \"{{vendedor_id}}\",\n  \"dataInicio\": \"{{manutencao_falha_data_inicio}}\",\n  \"dataFimPrevista\": \"{{manutencao_falha_data_fim}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas"]
            },
            "description": "**Persona:** ğŸ’¼ VENDEDOR\n\n**Teste RN06:** Vendedor tenta criar reserva com jetski em manutenÃ§Ã£o.\n\n**Esperado:** 400 Bad Request (jetski indisponÃ­vel)"
          }
        },
        {
          "name": "4.3. ğŸ¯ Operador: Retornar status para DISPONIVEL",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 200 OK', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Jetski estÃ¡ DISPONIVEL novamente', function () {",
                  "    const jetski = pm.response.json();",
                  "    pm.expect(jetski.status).to.eql('DISPONIVEL');",
                  "});",
                  "",
                  "console.log('âœ… ğŸ¯ Operador finalizou manutenÃ§Ã£o: jetski DISPONIVEL');"
                ]
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/jetskis/{{jetski_id}}/status?status=DISPONIVEL",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "jetskis", "{{jetski_id}}", "status"],
              "query": [
                {"key": "status", "value": "DISPONIVEL"}
              ]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador finaliza manutenÃ§Ã£o e retorna jetski ao status DISPONIVEL. Jetski pode ser reservado novamente."
          }
        },
        {
          "name": "4.4. ğŸ’¼ Vendedor: Criar reserva (AGORA FUNCIONA)",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Gera data de inÃ­cio (agora + 1 hora)",
                  "const now = new Date();",
                  "const dataInicio = new Date(now.getTime() + (1 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('manutencao_data_inicio', dataInicio.toISOString());",
                  "",
                  "// Gera data de fim (inÃ­cio + 2 horas)",
                  "const dataFim = new Date(dataInicio.getTime() + (2 * 60 * 60 * 1000));",
                  "pm.collectionVariables.set('manutencao_data_fim', dataFim.toISOString());"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Reserva criada com sucesso', function () {",
                  "    const reserva = pm.response.json();",
                  "    pm.expect(reserva.id).to.be.a('string');",
                  "    pm.expect(reserva.status).to.eql('PENDENTE');",
                  "});",
                  "",
                  "console.log('âœ… ğŸ’¼ Vendedor criou reserva apÃ³s manutenÃ§Ã£o concluÃ­da!');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modeloId\": \"{{modelo_id}}\",\n  \"jetskiId\": \"{{jetski_id}}\",\n  \"clienteId\": \"{{cliente_id}}\",\n  \"vendedorId\": \"{{vendedor_id}}\",\n  \"dataInicio\": \"{{manutencao_data_inicio}}\",\n  \"dataFimPrevista\": \"{{manutencao_data_fim}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas"]
            },
            "description": "**Persona:** ğŸ’¼ VENDEDOR\n\n**Sucesso:** Vendedor cria reserva apÃ³s manutenÃ§Ã£o concluÃ­da.\n\n**Esperado:** 201 Created"
          }
        }
      ]
    },
    {
      "name": "ğŸš« 6. Jornadas Negativas - Testes de AutorizaÃ§Ã£o",
      "description": "## ğŸ”’ Testes de SeguranÃ§a e RBAC\n\nValida que o sistema **bloqueia corretamente** operaÃ§Ãµes nÃ£o autorizadas.\n\n### Grupos de Testes:\n\n**A. ViolaÃ§Ãµes de Papel (Role)**\n- Vendedor/Operador tentando operaÃ§Ãµes de Gerente/Admin\n\n**B. ViolaÃ§Ãµes de AutenticaÃ§Ã£o**\n- Requests sem token, com token invÃ¡lido ou expirado\n\n**C. ViolaÃ§Ãµes de LÃ³gica de NegÃ³cio**\n- Check-out sem check-in, reserva sem sinal, etc.\n\nTodos os testes devem **FALHAR com cÃ³digos esperados** (400/401/403).",
      "item": [
        {
          "name": "6.1. âŒ Vendedor tenta fazer check-in (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 403 Forbidden', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "pm.test('Mensagem de erro indica falta de permissÃ£o', function () {",
                  "    const error = pm.response.json();",
                  "    pm.expect(error.status).to.eql(403);",
                  "});",
                  "",
                  "console.log('âœ… RBAC correto: Vendedor NÃƒO pode fazer check-in (apenas Operador)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reservaId\": \"{{reserva_id}}\",\n  \"horimetroInicio\": 100.5\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/check-in/reserva",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "check-in", "reserva"]
            },
            "description": "**Teste:** Vendedor NÃƒO pode fazer check-in (papel incorreto)\n\n**Esperado:** 403 Forbidden\n\n**RazÃ£o:** Apenas OPERADOR pode executar check-in/check-out"
          }
        },
        {
          "name": "6.2. âŒ Vendedor tenta fazer check-out (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 403 Forbidden', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "console.log('âœ… RBAC correto: Vendedor NÃƒO pode fazer check-out');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"horimetroFim\": 105.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/{{locacao_id}}/check-out",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "{{locacao_id}}", "check-out"]
            },
            "description": "**Teste:** Vendedor NÃƒO pode fazer check-out\n\n**Esperado:** 403 Forbidden"
          }
        },
        {
          "name": "6.3. âŒ Operador tenta confirmar reserva (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 403 Forbidden', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "console.log('âœ… RBAC correto: Operador NÃƒO pode confirmar reserva (apenas Gerente)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas/{{reserva_id}}/confirmar",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas", "{{reserva_id}}", "confirmar"]
            },
            "description": "**Teste:** Operador NÃƒO pode confirmar reserva (precisa autorizaÃ§Ã£o de Gerente)\n\n**Esperado:** 403 Forbidden"
          }
        },
        {
          "name": "6.4. âŒ Operador tenta criar modelo (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 403 Forbidden', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "console.log('âœ… RBAC correto: Operador NÃƒO pode criar modelo (apenas Admin)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fabricante\": \"Sea-Doo\",\n  \"nome\": \"GTX\",\n  \"precoBaseHora\": 400.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/modelos",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "modelos"]
            },
            "description": "**Teste:** Operador NÃƒO pode criar modelos (operaÃ§Ã£o de Admin)\n\n**Esperado:** 403 Forbidden"
          }
        },
        {
          "name": "6.5. âŒ Vendedor tenta criar jetski (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 403 Forbidden', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "console.log('âœ… RBAC correto: Vendedor NÃƒO pode cadastrar jetskis (apenas Admin)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modeloId\": \"{{modelo_id}}\",\n  \"serie\": \"FAKE-002\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/jetskis",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "jetskis"]
            },
            "description": "**Teste:** Vendedor NÃƒO pode cadastrar jetskis na frota\n\n**Esperado:** 403 Forbidden"
          }
        },
        {
          "name": "6.6. âŒ Request sem token (401)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 401 Unauthorized', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "",
                  "console.log('âœ… Auth correto: Request sem token retorna 401');"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/modelos",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "modelos"]
            },
            "description": "**Teste:** Request sem header Authorization\n\n**Esperado:** 401 Unauthorized"
          }
        },
        {
          "name": "6.7. âŒ Request com token invÃ¡lido (401)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 401 Unauthorized', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "",
                  "console.log('âœ… Auth correto: Token invÃ¡lido retorna 401');"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer INVALID_TOKEN_12345"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/modelos",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "modelos"]
            },
            "description": "**Teste:** Token JWT invÃ¡lido/mal formado\n\n**Esperado:** 401 Unauthorized"
          }
        },
        {
          "name": "6.8. âŒ Check-out sem check-in (400)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 400 Bad Request ou 404 Not Found', function () {",
                  "    pm.expect([400, 404]).to.include(pm.response.code);",
                  "});",
                  "",
                  "console.log('âœ… LÃ³gica de negÃ³cio correta: Check-out sem locaÃ§Ã£o ativa falha');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"horimetroFim\": 999.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/99999999-9999-9999-9999-999999999999/check-out",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "99999999-9999-9999-9999-999999999999", "check-out"]
            },
            "description": "**Teste:** Check-out em locaÃ§Ã£o inexistente\n\n**Esperado:** 400 ou 404"
          }
        },
        {
          "name": "6.9. âŒ Check-in em reserva inexistente (404)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code Ã© 404 Not Found', function () {",
                  "    pm.response.to.have.status(404);",
                  "});",
                  "",
                  "pm.test('Mensagem indica reserva nÃ£o encontrada', function () {",
                  "    const error = pm.response.json();",
                  "    pm.expect(error.message).to.include('nÃ£o encontrada');",
                  "});",
                  "",
                  "console.log('âœ… LÃ³gica correta: Check-in requer reserva existente');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"},
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reservaId\": \"99999999-9999-9999-9999-999999999999\",\n  \"horimetroInicio\": 100.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes/check-in/reserva",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes", "check-in", "reserva"]
            },
            "description": "**Teste:** Check-in em reserva inexistente\n\n**Esperado:** 404 Not Found (recurso nÃ£o existe)"
          }
        }
      ]
    },
    {
      "name": "ğŸ“Š 7. Consultas por Persona",
      "description": "Cada persona consulta o que tem permissÃ£o de ver",
      "item": [
        {
          "name": "7.1. ğŸ‘” Gerente: LocaÃ§Ãµes em Curso",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{gerente_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/locacoes?status=EM_CURSO",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "locacoes"],
              "query": [{"key": "status", "value": "EM_CURSO"}]
            },
            "description": "**Persona:** ğŸ‘” GERENTE\n\nGerente monitora locaÃ§Ãµes em andamento"
          }
        },
        {
          "name": "7.2. ğŸ¯ Operador: Reservas do Dia",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{operador_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas?status=CONFIRMADA",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas"],
              "query": [{"key": "status", "value": "CONFIRMADA"}]
            },
            "description": "**Persona:** ğŸ¯ OPERADOR\n\nOperador vÃª reservas confirmadas aguardando check-in"
          }
        },
        {
          "name": "7.3. ğŸ’¼ Vendedor: Minhas Reservas",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{vendedor_token}}"},
              {"key": "X-Tenant-Id", "value": "{{tenant_id}}"}
            ],
            "url": {
              "raw": "{{base_url}}/v1/tenants/{{tenant_id}}/reservas",
              "host": ["{{base_url}}"],
              "path": ["v1", "tenants", "{{tenant_id}}", "reservas"]
            },
            "description": "**Persona:** ğŸ’¼ VENDEDOR\n\nVendedor consulta reservas que criou (comissÃµes)"
          }
        }
      ]
    }
  ]
}
