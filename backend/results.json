{
  "collection": {
    "_": {
      "postman_id": "sprint3-jornadas-com-testes"
    },
    "item": [
      {
        "id": "b8f74886-fce0-4481-b68e-92ee3518cf78",
        "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
        "description": {
          "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "043a1159-d237-43cd-adce-4ccdb082317e",
            "name": "Auth - Get Gerente Token",
            "request": {
              "description": {
                "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "gerente@acme.com"
                  },
                  {
                    "key": "password",
                    "value": "gerente123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "8173d90c-4d56-4f23-9e1b-222900fad890",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "pm.test('Resposta cont√©m access_token', function() {",
                    "    const json = pm.response.json();",
                    "    pm.expect(json).to.have.property('access_token');",
                    "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Token possui tipo Bearer', function() {",
                    "    const json = pm.response.json();",
                    "    pm.expect(json.token_type).to.eql('Bearer');",
                    "});",
                    "",
                    "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                    "const json = pm.response.json();",
                    "pm.environment.set('gerente_token', json.access_token);",
                    "pm.environment.set('token_expires_in', json.expires_in);",
                    "",
                    "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                  ],
                  "_lastExecutionId": "4d926c4e-9f9d-4a55-a63d-b97b9af9dfe3"
                }
              }
            ]
          },
          {
            "id": "955d92d8-ea1a-49ef-a82b-86767ecc2316",
            "name": "Auth - Get Operador Token",
            "request": {
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "operador@acme.com"
                  },
                  {
                    "key": "password",
                    "value": "operador123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "ec89b935-e15f-4da6-a042-936be908595b",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.environment.set('operador_token', json.access_token);",
                    "console.log('‚úÖ Token do OPERADOR salvo');"
                  ],
                  "_lastExecutionId": "84a764e3-08a9-480d-9628-e3b0112f2656"
                }
              }
            ]
          },
          {
            "id": "6a55bf83-4a2c-4e0e-b2fa-dadc7f9d3d72",
            "name": "Auth - Get Financeiro Token",
            "request": {
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "gerente@acme.com"
                  },
                  {
                    "key": "password",
                    "value": "gerente123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "667f77a0-c12b-457f-97a1-ac976c30b8ee",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.environment.set('financeiro_token', json.access_token);",
                    "console.log('‚úÖ Token do FINANCEIRO salvo');"
                  ],
                  "_lastExecutionId": "bab9240f-b673-42ad-b8c9-44bccb896334"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
        "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
        "description": {
          "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
            "name": "1.1 Consolidar Fechamento Di√°rio",
            "request": {
              "description": {
                "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "consolidar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "5b58a257-9149-426f-aedb-313633a45acd",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "pm.test('Resposta √© JSON v√°lido', function() {",
                    "    pm.response.to.be.json;",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID do fechamento', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Status inicial √© \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                    "    pm.expect(json.bloqueado).to.be.false;",
                    "});",
                    "",
                    "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                    "    const dtReferencia = pm.variables.get('dt_referencia');",
                    "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                    "});",
                    "",
                    "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                    "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                    "});",
                    "",
                    "pm.test('Possui breakdown por forma de pagamento', function() {",
                    "    pm.expect(json).to.have.property('totalDinheiro');",
                    "    pm.expect(json).to.have.property('totalCartao');",
                    "    pm.expect(json).to.have.property('totalPix');",
                    "});",
                    "",
                    "pm.test('Total faturado = soma das formas de pagamento', function() {",
                    "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                    "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                    "});",
                    "",
                    "// Salvar ID para pr√≥ximas requisi√ß√µes",
                    "pm.environment.set('fechamento_diario_id', json.id);",
                    "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                  ],
                  "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                  "type": "text/javascript",
                  "exec": [
                    "// Definir data de refer√™ncia (hoje)",
                    "const hoje = new Date().toISOString().split('T')[0];",
                    "pm.variables.set('dt_referencia', hoje);",
                    "console.log('üìÖ Data de refer√™ncia:', hoje);"
                  ],
                  "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                }
              }
            ]
          },
          {
            "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
            "name": "1.2 Consultar Fechamento Criado",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('ID corresponde ao criado', function() {",
                    "    const id = pm.environment.get('fechamento_diario_id');",
                    "    pm.expect(json.id).to.eql(id);",
                    "});",
                    "",
                    "pm.test('Possui operador respons√°vel', function() {",
                    "    pm.expect(json).to.have.property('operadorId');",
                    "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Timestamps de auditoria presentes', function() {",
                    "    pm.expect(json).to.have.property('createdAt');",
                    "    pm.expect(json).to.have.property('updatedAt');",
                    "});"
                  ],
                  "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                }
              }
            ]
          },
          {
            "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
            "name": "1.3 Fechar o Dia (Lock)",
            "request": {
              "description": {
                "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para \"fechado\"', function() {",
                    "    pm.expect(json.status).to.eql('fechado');",
                    "});",
                    "",
                    "pm.test('Agora est√° bloqueado (RN06)', function() {",
                    "    pm.expect(json.bloqueado).to.be.true;",
                    "});",
                    "",
                    "pm.test('Possui data de fechamento', function() {",
                    "    pm.expect(json).to.have.property('dtFechamento');",
                    "    pm.expect(json.dtFechamento).to.not.be.null;",
                    "});",
                    "",
                    "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                  ],
                  "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                }
              }
            ]
          },
          {
            "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
            "name": "1.4 Tentar Reabrir (Gerente)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "reabrir"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status voltou para \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('Bloqueio foi removido', function() {",
                    "    pm.expect(json.bloqueado).to.be.false;",
                    "});",
                    "",
                    "pm.test('Data de fechamento foi limpa', function() {",
                    "    pm.expect(json.dtFechamento).to.be.null;",
                    "});",
                    "",
                    "console.log('üîì Fechamento reaberto pelo GERENTE');"
                  ],
                  "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                }
              }
            ]
          },
          {
            "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
            "name": "1.5 Fechar Novamente",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.expect(json.status).to.eql('fechado');"
                  ],
                  "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                }
              }
            ]
          },
          {
            "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
            "name": "1.6 Aprovar Fechamento (Gerente)",
            "request": {
              "description": {
                "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© \"aprovado\"', function() {",
                    "    pm.expect(json.status).to.eql('aprovado');",
                    "});",
                    "",
                    "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                    "    pm.expect(json.bloqueado).to.be.true;",
                    "});",
                    "",
                    "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                  ],
                  "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                }
              }
            ]
          },
          {
            "id": "1090e477-250f-4a06-b728-129231fcca7c",
            "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
            "request": {
              "description": {
                "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "reabrir"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 400 Bad Request', function() {",
                    "    pm.response.to.have.status(400);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Mensagem de erro apropriada', function() {",
                    "    pm.expect(json.message).to.include('aprovado');",
                    "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                    "});",
                    "",
                    "pm.test('Tipo de erro √© BusinessException', function() {",
                    "    pm.expect(json.error).to.include('Business');",
                    "});",
                    "",
                    "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                  ],
                  "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
        "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
        "description": {
          "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
            "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "politicas-comissao"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID da pol√≠tica', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "});",
                    "",
                    "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                    "    pm.expect(json.nivel).to.eql('MODELO');",
                    "});",
                    "",
                    "pm.test('Tipo √© PERCENTUAL', function() {",
                    "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                    "});",
                    "",
                    "pm.test('Percentual configurado corretamente', function() {",
                    "    pm.expect(json.percentual).to.eql(12.0);",
                    "});",
                    "",
                    "pm.test('Pol√≠tica est√° ativa', function() {",
                    "    pm.expect(json.ativo).to.be.true;",
                    "});",
                    "",
                    "pm.environment.set('politica_comissao_id', json.id);",
                    "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                  ],
                  "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                }
              }
            ]
          },
          {
            "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
            "name": "2.2 Listar Pol√≠ticas Ativas",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "politicas-comissao"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [
                  {
                    "key": "ativo",
                    "value": "true"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                    "    const politicaId = pm.environment.get('politica_comissao_id');",
                    "    const found = json.find(p => p.id === politicaId);",
                    "    pm.expect(found).to.not.be.undefined;",
                    "});"
                  ],
                  "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                }
              }
            ]
          },
          {
            "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
            "name": "2.3 Consultar Comiss√µes Pendentes",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "pendentes"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array de comiss√µes', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "if (json.length > 0) {",
                    "    const comissao = json[0];",
                    "    ",
                    "    pm.test('Comiss√£o possui estrutura correta', function() {",
                    "        pm.expect(comissao).to.have.property('id');",
                    "        pm.expect(comissao).to.have.property('vendedorId');",
                    "        pm.expect(comissao).to.have.property('locacaoId');",
                    "        pm.expect(comissao).to.have.property('valorBase');",
                    "        pm.expect(comissao).to.have.property('valorComissao');",
                    "        pm.expect(comissao).to.have.property('taxaAplicada');",
                    "        pm.expect(comissao).to.have.property('status');",
                    "    });",
                    "    ",
                    "    pm.test('Status √© PENDENTE', function() {",
                    "        pm.expect(comissao.status).to.eql('PENDENTE');",
                    "    });",
                    "    ",
                    "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                    "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                    "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                    "    });",
                    "    ",
                    "    // Salvar para aprova√ß√£o",
                    "    pm.environment.set('comissao_id', comissao.id);",
                    "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                    "}"
                  ],
                  "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                }
              }
            ]
          },
          {
            "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
            "name": "2.4 Aprovar Comiss√£o (Gerente)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "{{comissao_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                  "type": "text/javascript",
                  "exec": [
                    "const comissaoId = pm.environment.get('comissao_id');",
                    "",
                    "if (!comissaoId) {",
                    "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                    "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                    "    return;",
                    "}",
                    "",
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para APROVADA', function() {",
                    "    pm.expect(json.status).to.eql('APROVADA');",
                    "});",
                    "",
                    "pm.test('Valores permanecem inalterados', function() {",
                    "    pm.expect(json).to.have.property('valorComissao');",
                    "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                    "});",
                    "",
                    "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                  ],
                  "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                }
              }
            ]
          },
          {
            "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
            "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
            "request": {
              "description": {
                "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "aguardando-pagamento"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{financeiro_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "if (json.length > 0) {",
                    "    pm.test('Todas t√™m status APROVADA', function() {",
                    "        json.forEach(c => {",
                    "            pm.expect(c.status).to.eql('APROVADA');",
                    "        });",
                    "    });",
                    "}"
                  ],
                  "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                }
              }
            ]
          },
          {
            "id": "5f116071-06b9-4553-babb-471cbf605103",
            "name": "2.6 Pagar Comiss√£o (Financeiro)",
            "request": {
              "description": {
                "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "{{comissao_id}}",
                  "pagar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{financeiro_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                  "type": "text/javascript",
                  "exec": [
                    "const comissaoId = pm.environment.get('comissao_id');",
                    "",
                    "if (!comissaoId) {",
                    "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                    "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                    "    return;",
                    "}",
                    "",
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© PAGA', function() {",
                    "    pm.expect(json.status).to.eql('PAGA');",
                    "});",
                    "",
                    "pm.test('Possui data de pagamento', function() {",
                    "    pm.expect(json).to.have.property('dataPagamento');",
                    "    pm.expect(json.dataPagamento).to.not.be.null;",
                    "});",
                    "",
                    "pm.test('M√©todo de pagamento registrado', function() {",
                    "    pm.expect(json).to.have.property('metodoPagamento');",
                    "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                    "});",
                    "",
                    "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                  ],
                  "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "6335246c-3e9a-494e-a814-d88238c2b727",
        "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
        "description": {
          "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
            "name": "3.1 Consolidar M√™s",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "consolidar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID do fechamento mensal', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "});",
                    "",
                    "pm.test('M√™s e ano corretos', function() {",
                    "    const mes = pm.variables.get('mes_referencia');",
                    "    const ano = pm.variables.get('ano_referencia');",
                    "    pm.expect(json.mes).to.eql(parseInt(mes));",
                    "    pm.expect(json.ano).to.eql(parseInt(ano));",
                    "});",
                    "",
                    "pm.test('Status inicial √© \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('Possui totais consolidados', function() {",
                    "    pm.expect(json).to.have.property('totalReceita');",
                    "    pm.expect(json).to.have.property('totalDespesas');",
                    "    pm.expect(json).to.have.property('diasOperacao');",
                    "});",
                    "",
                    "pm.test('Possui breakdown de comiss√µes', function() {",
                    "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                    "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                    "    pm.expect(json).to.have.property('totalComissoesPagas');",
                    "});",
                    "",
                    "pm.environment.set('fechamento_mensal_id', json.id);",
                    "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                  ],
                  "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                  "type": "text/javascript",
                  "exec": [
                    "// Definir m√™s/ano (m√™s atual)",
                    "const hoje = new Date();",
                    "const mes = (hoje.getMonth() + 1).toString();",
                    "const ano = hoje.getFullYear().toString();",
                    "pm.variables.set('mes_referencia', mes);",
                    "pm.variables.set('ano_referencia', ano);",
                    "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                  ],
                  "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                }
              }
            ]
          },
          {
            "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
            "name": "3.2 Fechar M√™s",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "{{fechamento_mensal_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "b19152e6-6334-437c-82ed-812952bad509",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para \"fechado\"', function() {",
                    "    pm.expect(json.status).to.eql('fechado');",
                    "});"
                  ],
                  "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                }
              }
            ]
          },
          {
            "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
            "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
            "request": {
              "description": {
                "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "{{fechamento_mensal_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© \"aprovado\"', function() {",
                    "    pm.expect(json.status).to.eql('aprovado');",
                    "});",
                    "",
                    "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                  ],
                  "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                }
              }
            ]
          }
        ],
        "event": []
      }
    ],
    "event": [
      {
        "listen": "prerequest",
        "script": {
          "id": "b28ccc97-998e-4a6a-a12b-3cea1dab783b",
          "type": "text/javascript",
          "exec": [
            "// Script global de pr√©-requisi√ß√£o",
            "console.log('üöÄ Executando requisi√ß√£o:', pm.info.requestName);",
            "",
            "// Validar se token est√° presente (exceto para auth)",
            "if (!pm.info.requestName.includes('Auth')) {",
            "    const token = pm.environment.get('gerente_token') || ",
            "                  pm.environment.get('operador_token') || ",
            "                  pm.environment.get('financeiro_token');",
            "    ",
            "    if (!token) {",
            "        console.warn('‚ö†Ô∏è Nenhum token encontrado - execute Setup primeiro');",
            "    }",
            "}"
          ],
          "_lastExecutionId": "884c05a9-8f79-4367-8d47-cf6e78b4d668"
        }
      },
      {
        "listen": "test",
        "script": {
          "id": "35bc3eda-077c-4e2e-8e2b-b8de1c19988b",
          "type": "text/javascript",
          "exec": [
            "// Script global de testes",
            "pm.test('Response time √© aceit√°vel', function() {",
            "    pm.expect(pm.response.responseTime).to.be.below(5000);",
            "});",
            "",
            "pm.test('N√£o possui erros 5xx', function() {",
            "    pm.expect(pm.response.code).to.be.below(500);",
            "});"
          ],
          "_lastExecutionId": "01770a50-6f5a-433f-8b9a-923a2281f067"
        }
      }
    ],
    "variable": [
      {
        "type": "string",
        "value": "http://localhost:8090/api",
        "key": "baseUrl"
      },
      {
        "type": "string",
        "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",
        "key": "tenantId"
      },
      {
        "type": "string",
        "value": "http://localhost:8081",
        "key": "keycloakUrl"
      },
      {
        "type": "string",
        "value": "33333333-3333-3333-3333-333333333333",
        "key": "modelo_id"
      },
      {
        "type": "string",
        "value": "44444444-4444-4444-4444-444444444444",
        "key": "jetski_id"
      }
    ],
    "info": {
      "_postman_id": "sprint3-jornadas-com-testes",
      "name": "Jetski Sprint 3 - Jornadas Completas com Testes",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
      "description": {
        "content": "Collection completa com jornadas de Combust√≠vel (RN03), Comiss√µes (RN04) e Fechamento (RN06) com testes automatizados.\n\n**M√≥dulos Cobertos:**\n- ‚õΩ Combust√≠vel (RN03): pol√≠ticas, abastecimento\n- üí∞ Comiss√µes (RN04): c√°lculo hier√°rquico, aprova√ß√£o, pagamento\n- üìä Fechamento (RN06): di√°rio e mensal com bloqueio\n\n**Features:**\n- ‚úÖ Testes automatizados em cada requisi√ß√£o\n- ‚úÖ Vari√°veis din√¢micas (IDs salvos automaticamente)\n- ‚úÖ Valida√ß√£o de status codes, estrutura JSON, valores\n- ‚úÖ Scripts de pr√©-requisi√ß√£o para setup\n- ‚úÖ Cleanup autom√°tico entre jornadas\n\n**Como Usar:**\n1. Importe o environment `Local.postman_environment.json`\n2. Execute a pasta \"0Ô∏è‚É£ Setup\" para autenticar\n3. Execute as jornadas sequencialmente ou use Collection Runner\n4. Veja os resultados dos testes na aba \"Test Results\"\n\n**Vers√£o:** 0.8.0 (Sprint 3)\n**Total de Testes:** ~80 assertions automatizados",
        "type": "text/plain"
      }
    }
  },
  "environment": {
    "_": {
      "postman_variable_scope": "environment",
      "postman_exported_at": "2025-10-18T00:00:00.000Z",
      "postman_exported_using": "Postman/10.0.0"
    },
    "id": "local-env",
    "name": "Local",
    "values": [
      {
        "type": "any",
        "value": "http://localhost:8090/api",
        "key": "api_url"
      },
      {
        "type": "any",
        "value": "http://localhost:8081",
        "key": "keycloak_url"
      },
      {
        "description": {
          "content": "Keycloak URL (camelCase) - usado pela collection Jornadas",
          "type": "text/plain"
        },
        "type": "any",
        "value": "http://localhost:8081",
        "key": "keycloakUrl"
      },
      {
        "type": "any",
        "value": "jetski-saas",
        "key": "keycloak_realm"
      },
      {
        "type": "any",
        "value": "jetski-api",
        "key": "client_id"
      },
      {
        "type": "any",
        "value": "jetski-secret",
        "key": "client_secret"
      },
      {
        "description": {
          "content": "Username for ADMIN_TENANT persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin@acme.com",
        "key": "admin_username"
      },
      {
        "description": {
          "content": "Password for ADMIN_TENANT persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin123",
        "key": "admin_password"
      },
      {
        "description": {
          "content": "Username for GERENTE persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "gerente@acme.com",
        "key": "gerente_username"
      },
      {
        "description": {
          "content": "Password for GERENTE persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "gerente123",
        "key": "gerente_password"
      },
      {
        "description": {
          "content": "Username for OPERADOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "operador@acme.com",
        "key": "operador_username"
      },
      {
        "description": {
          "content": "Password for OPERADOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "operador123",
        "key": "operador_password"
      },
      {
        "description": {
          "content": "Username for VENDEDOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "vendedor@acme.com",
        "key": "vendedor_username"
      },
      {
        "description": {
          "content": "Password for VENDEDOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "vendedor123",
        "key": "vendedor_password"
      },
      {
        "description": {
          "content": "Username for MECANICO persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "mecanico@acme.com",
        "key": "mecanico_username"
      },
      {
        "description": {
          "content": "Password for MECANICO persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "mecanico123",
        "key": "mecanico_password"
      },
      {
        "description": {
          "content": "Legacy - use admin_username instead",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin@acme.com",
        "key": "username"
      },
      {
        "description": {
          "content": "Legacy - use admin_password instead",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin123",
        "key": "password"
      },
      {
        "description": {
          "content": "Alias for api_url (used by Jornadas collection)",
          "type": "text/plain"
        },
        "type": "any",
        "value": "http://localhost:8090/api",
        "key": "base_url"
      },
      {
        "description": {
          "content": "Default tenant ID - ser√° atualizado automaticamente ao listar tenants",
          "type": "text/plain"
        },
        "type": "any",
        "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",
        "key": "tenant_id"
      },
      {
        "description": {
          "content": "Tenant ID (camelCase) - usado pela collection Jornadas",
          "type": "text/plain"
        },
        "type": "any",
        "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",
        "key": "tenantId"
      },
      {
        "description": {
          "content": "JWT access token - preenchido automaticamente pelo request 'Get Access Token'",
          "type": "text/plain"
        },
        "type": "any",
        "value": "",
        "key": "access_token"
      },
      {
        "description": {
          "content": "JWT refresh token - preenchido automaticamente",
          "type": "text/plain"
        },
        "type": "any",
        "value": "",
        "key": "refresh_token"
      },
      {
        "description": {
          "content": "Token expiration time in seconds",
          "type": "text/plain"
        },
        "type": "any",
        "value": 600,
        "key": "token_expires_in"
      },
      {
        "type": "any",
        "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ",
        "key": "gerente_token"
      },
      {
        "type": "any",
        "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjMxYWRmNDg3LWU5NWYtMzA3Mi1jNTdlLTI3YzI3NjBmOWUwNiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzkzYjYzMDktZDE4ZC00M2VkLWJiNzQtYWI1NTgxMjIxYTQyIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImY0NGIyMTIzLWE3ZTktZWZmOC1kMWJjLWI5OGZhYzI0ZjliZCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIm9mZmxpbmVfYWNjZXNzIiwiT1BFUkFET1IiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInRlbmFudF9pZCI6ImEwZWViYzk5LTljMGItNGVmOC1iYjZkLTZiYjliZDM4MGExMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLWpldHNraS1zYWFzIiwib2ZmbGluZV9hY2Nlc3MiLCJPUEVSQURPUiIsInVtYV9hdXRob3JpemF0aW9uIl0sIm5hbWUiOiJPcGVyYWRvciBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvcGVyYWRvckBhY21lLmNvbSIsImdpdmVuX25hbWUiOiJPcGVyYWRvciIsImZhbWlseV9uYW1lIjoiQUNNRSIsImVtYWlsIjoib3BlcmFkb3JAYWNtZS5jb20ifQ.QLbo3TqQCEgXnqIUwsWltJc3yREauRyZDT_o9aKjWA4N6DTZTXiAg-TPfw4Webzk2muK6l597VmbIPnubHwn02t2gTmKkd-2CBcKEwGdZTErY0Dh12hLd-X1zyJ6FC5YotBwQRt6x3H92idRgZYEUi0y3n2ebtOkXhEYMUoaqmG0ovwvKEAv0qbeXV90eRxd4CSr2MN19ztR2QjWgnFLXZ7Fgr1-0bAtsNqhckG6Xsfs7njHllqA3biDIDDeiWUCBZyKEgv0BzDocLd0fZ3-nFD3Ms9IGRyOcRhJnU05jo6S4Vvxl1aBGfYZlH6-UbC0YUM3TWTFlBZiFSWYuk2MUg",
        "key": "operador_token"
      },
      {
        "type": "any",
        "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjRiYmMxNzVlLWE5MzItYTcyYS03ZTAwLTdmNTI2NmY5MWRhMiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImQ5NDA2MTRmLTIzNGEtMmYzNC1jZmU1LTE0MWVjMTJlODk2MCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.omf1wttCTNiJh8TZBwaTK6DP25GAKfvgQQd72kOeTtCdNYoYDzJ2gygAChAI95frq6tCy7-meZsE3GtJ4M-FpaKe_-NYxto6Wf9gb-tAE9dH8f_fDZ45do4KGUhbTvIPyzeUicT3TqZGzB2nV3fUkJC82WAk_NbmYXlp6CqNCJveZnf1LIfXjil4K7_sXa4HyPPwqDwxPYTgjz8RP56IYUg3PZqP9FbeY9iEKNr9XrR1SOGCsGiLY_5MN1ezNHnefQzTvwtWBsMxgZHu7pPGKdwBcG_t6w5m9FVsKnswCe8Izc1JiApel-NqF4ojyJuaI7PKWXpYAkeTuErRnIKCDQ",
        "key": "financeiro_token"
      },
      {
        "type": "any",
        "value": null,
        "key": "fechamento_diario_id"
      },
      {
        "type": "any",
        "value": null,
        "key": "politica_comissao_id"
      },
      {
        "type": "any",
        "value": null,
        "key": "fechamento_mensal_id"
      }
    ]
  },
  "globals": {
    "id": "66d36b62-b8e1-4cf4-871e-e6ab852bc29a",
    "values": []
  },
  "run": {
    "stats": {
      "iterations": {
        "total": 1,
        "pending": 0,
        "failed": 0
      },
      "items": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "scripts": {
        "total": 59,
        "pending": 0,
        "failed": 1
      },
      "prerequests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "requests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "tests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "assertions": {
        "total": 96,
        "pending": 0,
        "failed": 50
      },
      "testScripts": {
        "total": 38,
        "pending": 0,
        "failed": 1
      },
      "prerequestScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      }
    },
    "timings": {
      "responseAverage": 52.1578947368421,
      "responseMin": 13,
      "responseMax": 568,
      "responseSd": 122.63049468687146,
      "dnsAverage": 0,
      "dnsMin": 0,
      "dnsMax": 0,
      "dnsSd": 0,
      "firstByteAverage": 0,
      "firstByteMin": 0,
      "firstByteMax": 0,
      "firstByteSd": 0,
      "started": 1762330444165,
      "completed": 1762330445731
    },
    "executions": [
      {
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 19,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "1492c6c4-75e9-46e3-aca8-8a9f5dc87a6e",
          "httpRequestId": "c77b0061-b756-4b8c-be2b-f5fe5d3d0142"
        },
        "item": {
          "id": "043a1159-d237-43cd-adce-4ccdb082317e",
          "name": "Auth - Get Gerente Token",
          "request": {
            "description": {
              "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente@acme.com"
                },
                {
                  "key": "password",
                  "value": "gerente123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8173d90c-4d56-4f23-9e1b-222900fad890",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Resposta cont√©m access_token', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('access_token');",
                  "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Token possui tipo Bearer', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                  "const json = pm.response.json();",
                  "pm.environment.set('gerente_token', json.access_token);",
                  "pm.environment.set('token_expires_in', json.expires_in);",
                  "",
                  "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                ],
                "_lastExecutionId": "4d926c4e-9f9d-4a55-a63d-b97b9af9dfe3"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "08d4e757-3de2-45ee-bf4e-176fdcfedacf",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "116",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "gerente@acme.com"
              },
              {
                "key": "password",
                "value": "gerente123"
              }
            ]
          }
        },
        "response": {
          "id": "3fdc1d28-7bac-455b-95f1-981348805994",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "2465"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              97,
              99,
              99,
              101,
              115,
              115,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              83,
              85,
              122,
              73,
              49,
              78,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              69,
              82,
              48,
              57,
              119,
              84,
              86,
              108,
              122,
              85,
              49,
              57,
              117,
              100,
              109,
              74,
              76,
              89,
              48,
              111,
              52,
              100,
              70,
              104,
              71,
              77,
              48,
              53,
              113,
              89,
              107,
              86,
              112,
              86,
              50,
              70,
              71,
              81,
              50,
              53,
              107,
              81,
              49,
              112,
              110,
              84,
              107,
              49,
              73,
              98,
              88,
              90,
              80,
              100,
              51,
              74,
              110,
              73,
              110,
              48,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              69,
              119,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              98,
              50,
              53,
              121,
              100,
              72,
              74,
              118,
              79,
              109,
              70,
              104,
              89,
              50,
              70,
              104,
              78,
              122,
              99,
              52,
              76,
              84,
              85,
              49,
              90,
              71,
              73,
              116,
              89,
              84,
              69,
              120,
              89,
              121,
              49,
              108,
              90,
              68,
              89,
              50,
              76,
              84,
              78,
              106,
              89,
              106,
              70,
              108,
              90,
              106,
              103,
              51,
              78,
              87,
              70,
              107,
              79,
              83,
              73,
              115,
              73,
              109,
              108,
              122,
              99,
              121,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              104,
              100,
              87,
              81,
              105,
              79,
              105,
              74,
              104,
              89,
              50,
              78,
              118,
              100,
              87,
              53,
              48,
              73,
              105,
              119,
              105,
              99,
              51,
              86,
              105,
              73,
              106,
              111,
              105,
              89,
              84,
              73,
              50,
              77,
              122,
              65,
              119,
              89,
              87,
              85,
              116,
              78,
              106,
              78,
              105,
              90,
              83,
              48,
              48,
              89,
              84,
              78,
              106,
              76,
              87,
              69,
              122,
              89,
              84,
              65,
              116,
              90,
              68,
              107,
              53,
              78,
              109,
              82,
              107,
              77,
              84,
              78,
              108,
              89,
              122,
              82,
              107,
              73,
              105,
              119,
              105,
              100,
              72,
              108,
              119,
              73,
              106,
              111,
              105,
              81,
              109,
              86,
              104,
              99,
              109,
              86,
              121,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              69,
              122,
              79,
              87,
              78,
              106,
              89,
              122,
              89,
              121,
              76,
              87,
              90,
              107,
              89,
              84,
              73,
              116,
              78,
              68,
              107,
              120,
              78,
              121,
              48,
              53,
              79,
              87,
              77,
              51,
              76,
              84,
              99,
              121,
              79,
              68,
              86,
              108,
              78,
              68,
              90,
              104,
              89,
              50,
              89,
              121,
              77,
              67,
              73,
              115,
              73,
              109,
              70,
              106,
              99,
              105,
              73,
              54,
              73,
              106,
              69,
              105,
              76,
              67,
              74,
              121,
              90,
              87,
              70,
              115,
              98,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              79,
              110,
              115,
              105,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              105,
              79,
              108,
              115,
              105,
              90,
              71,
              86,
              109,
              89,
              88,
              86,
              115,
              100,
              67,
              49,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              49,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              107,
              100,
              70,
              85,
              107,
              86,
              79,
              86,
              69,
              85,
              105,
              76,
              67,
              74,
              118,
              90,
              109,
              90,
              115,
              97,
              87,
              53,
              108,
              88,
              50,
              70,
              106,
              89,
              50,
              86,
              122,
              99,
              121,
              73,
              115,
              73,
              110,
              86,
              116,
              89,
              86,
              57,
              104,
              100,
              88,
              82,
              111,
              98,
              51,
              74,
              112,
              101,
              109,
              70,
              48,
              97,
              87,
              57,
              117,
              73,
              108,
              49,
              57,
              76,
              67,
              74,
              121,
              90,
              88,
              78,
              118,
              100,
              88,
              74,
              106,
              90,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              79,
              110,
              115,
              105,
              89,
              87,
              78,
              106,
              98,
              51,
              86,
              117,
              100,
              67,
              73,
              54,
              101,
              121,
              74,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              116,
              89,
              87,
              53,
              104,
              90,
              50,
              85,
              116,
              89,
              87,
              78,
              106,
              98,
              51,
              86,
              117,
              100,
              67,
              73,
              115,
              73,
              109,
              49,
              104,
              98,
              109,
              70,
              110,
              90,
              83,
              49,
              104,
              89,
              50,
              78,
              118,
              100,
              87,
              53,
              48,
              76,
              87,
              120,
              112,
              98,
              109,
              116,
              122,
              73,
              105,
              119,
              105,
              100,
              109,
              108,
              108,
              100,
              121,
              49,
              119,
              99,
              109,
              57,
              109,
              97,
              87,
              120,
              108,
              73,
              108,
              49,
              57,
              102,
              83,
              119,
              105,
              99,
              50,
              78,
              118,
              99,
              71,
              85,
              105,
              79,
              105,
              74,
              119,
              99,
              109,
              57,
              109,
              97,
              87,
              120,
              108,
              73,
              71,
              86,
              116,
              89,
              87,
              108,
              115,
              73,
              105,
              119,
              105,
              100,
              71,
              86,
              117,
              89,
              87,
              53,
              48,
              88,
              50,
              108,
              107,
              73,
              106,
              111,
              105,
              89,
              84,
              66,
              108,
              90,
              87,
              74,
              106,
              79,
              84,
              107,
              116,
              79,
              87,
              77,
              119,
              89,
              105,
              48,
              48,
              90,
              87,
              89,
              52,
              76,
              87,
              74,
              105,
              78,
              109,
              81,
              116,
              78,
              109,
              74,
              105,
              79,
              87,
              74,
              107,
              77,
              122,
              103,
              119,
              89,
              84,
              69,
              120,
              73,
              105,
              119,
              105,
              90,
              87,
              49,
              104,
              97,
              87,
              120,
              102,
              100,
              109,
              86,
              121,
              97,
              87,
              90,
              112,
              90,
              87,
              81,
              105,
              79,
              110,
              82,
              121,
              100,
              87,
              85,
              115,
              73,
              110,
              74,
              118,
              98,
              71,
              86,
              122,
              73,
              106,
              112,
              98,
              73,
              109,
              82,
              108,
              90,
              109,
              70,
              49,
              98,
              72,
              81,
              116,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              116,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              72,
              82,
              86,
              74,
              70,
              84,
              108,
              82,
              70,
              73,
              105,
              119,
              105,
              98,
              50,
              90,
              109,
              98,
              71,
              108,
              117,
              90,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              76,
              67,
              74,
              49,
              98,
              87,
              70,
              102,
              89,
              88,
              86,
              48,
              97,
              71,
              57,
              121,
              97,
              88,
              112,
              104,
              100,
              71,
              108,
              118,
              98,
              105,
              74,
              100,
              76,
              67,
              74,
              117,
              89,
              87,
              49,
              108,
              73,
              106,
              111,
              105,
              82,
              50,
              86,
              121,
              90,
              87,
              53,
              48,
              90,
              83,
              66,
              66,
              81,
              48,
              49,
              70,
              73,
              105,
              119,
              105,
              90,
              50,
              120,
              118,
              89,
              109,
              70,
              115,
              88,
              51,
              74,
              118,
              98,
              71,
              86,
              122,
              73,
              106,
              112,
              98,
              73,
              110,
              82,
              108,
              98,
              109,
              70,
              117,
              100,
              67,
              49,
              104,
              89,
              50,
              49,
              108,
              73,
              108,
              48,
              115,
              73,
              109,
              100,
              121,
              98,
              51,
              86,
              119,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              48,
              90,
              87,
              53,
              104,
              98,
              110,
              81,
              116,
              89,
              87,
              78,
              116,
              90,
              83,
              74,
              100,
              76,
              67,
              74,
              119,
              99,
              109,
              86,
              109,
              90,
              88,
              74,
              121,
              90,
              87,
              82,
              102,
              100,
              88,
              78,
              108,
              99,
              109,
              53,
              104,
              98,
              87,
              85,
              105,
              79,
              105,
              74,
              110,
              90,
              88,
              74,
              108,
              98,
              110,
              82,
              108,
              81,
              71,
              70,
              106,
              98,
              87,
              85,
              117,
              89,
              50,
              57,
              116,
              73,
              105,
              119,
              105,
              90,
              50,
              108,
              50,
              90,
              87,
              53,
              102,
              98,
              109,
              70,
              116,
              90,
              83,
              73,
              54,
              73,
              107,
              100,
              108,
              99,
              109,
              86,
              117,
              100,
              71,
              85,
              105,
              76,
              67,
              74,
              109,
              89,
              87,
              49,
              112,
              98,
              72,
              108,
              102,
              98,
              109,
              70,
              116,
              90,
              83,
              73,
              54,
              73,
              107,
              70,
              68,
              84,
              85,
              85,
              105,
              76,
              67,
              74,
              108,
              98,
              87,
              70,
              112,
              98,
              67,
              73,
              54,
              73,
              109,
              100,
              108,
              99,
              109,
              86,
              117,
              100,
              71,
              86,
              65,
              89,
              87,
              78,
              116,
              90,
              83,
              53,
              106,
              98,
              50,
              48,
              105,
              102,
              81,
              46,
              68,
              119,
              77,
              81,
              114,
              110,
              122,
              89,
              71,
              79,
              109,
              121,
              74,
              88,
              48,
              65,
              78,
              100,
              57,
              73,
              67,
              102,
              90,
              49,
              74,
              108,
              98,
              90,
              87,
              72,
              55,
              87,
              79,
              89,
              112,
              45,
              72,
              108,
              74,
              112,
              68,
              49,
              77,
              48,
              121,
              110,
              90,
              75,
              49,
              120,
              55,
              51,
              52,
              54,
              78,
              82,
              98,
              114,
              86,
              112,
              77,
              77,
              49,
              85,
              118,
              45,
              76,
              87,
              109,
              83,
              54,
              99,
              108,
              103,
              78,
              56,
              65,
              82,
              68,
              79,
              107,
              95,
              108,
              79,
              100,
              55,
              99,
              106,
              87,
              105,
              78,
              110,
              48,
              48,
              71,
              121,
              117,
              77,
              118,
              95,
              120,
              103,
              111,
              70,
              86,
              109,
              111,
              80,
              81,
              78,
              57,
              68,
              65,
              55,
              114,
              88,
              67,
              111,
              76,
              121,
              89,
              83,
              89,
              52,
              83,
              119,
              121,
              84,
              73,
              55,
              75,
              89,
              66,
              98,
              76,
              104,
              71,
              85,
              103,
              85,
              104,
              103,
              76,
              98,
              88,
              90,
              57,
              66,
              110,
              95,
              83,
              82,
              52,
              117,
              45,
              95,
              108,
              112,
              48,
              112,
              104,
              48,
              65,
              77,
              56,
              118,
              101,
              109,
              105,
              65,
              66,
              71,
              120,
              95,
              54,
              95,
              81,
              84,
              54,
              116,
              49,
              119,
              84,
              112,
              112,
              100,
              72,
              90,
              73,
              81,
              52,
              90,
              87,
              81,
              101,
              80,
              57,
              111,
              79,
              74,
              114,
              70,
              118,
              122,
              48,
              70,
              81,
              76,
              87,
              120,
              69,
              65,
              98,
              85,
              49,
              108,
              117,
              51,
              71,
              103,
              108,
              50,
              74,
              45,
              80,
              85,
              100,
              98,
              118,
              72,
              99,
              77,
              119,
              65,
              119,
              102,
              101,
              97,
              74,
              95,
              54,
              87,
              110,
              112,
              111,
              83,
              70,
              45,
              117,
              51,
              57,
              114,
              90,
              90,
              79,
              86,
              83,
              113,
              49,
              87,
              56,
              86,
              51,
              87,
              80,
              83,
              107,
              88,
              116,
              113,
              110,
              102,
              82,
              97,
              76,
              79,
              82,
              106,
              108,
              67,
              102,
              112,
              49,
              83,
              75,
              82,
              82,
              54,
              107,
              99,
              77,
              75,
              49,
              99,
              102,
              48,
              75,
              49,
              45,
              52,
              53,
              81,
              51,
              49,
              54,
              56,
              119,
              52,
              48,
              85,
              77,
              100,
              90,
              99,
              68,
              75,
              55,
              117,
              50,
              78,
              108,
              83,
              97,
              85,
              122,
              77,
              45,
              115,
              76,
              87,
              97,
              85,
              51,
              50,
              73,
              69,
              73,
              79,
              120,
              83,
              98,
              81,
              34,
              44,
              34,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              54,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              49,
              56,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              73,
              85,
              122,
              85,
              120,
              77,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              106,
              89,
              106,
              66,
              107,
              90,
              106,
              108,
              106,
              89,
              105,
              48,
              52,
              89,
              109,
              89,
              121,
              76,
              84,
              81,
              53,
              90,
              68,
              65,
              116,
              89,
              84,
              73,
              52,
              89,
              83,
              48,
              49,
              78,
              68,
              73,
              50,
              89,
              84,
              69,
              119,
              78,
              109,
              89,
              122,
              89,
              106,
              99,
              105,
              102,
              81,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              73,
              121,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              90,
              106,
              66,
              109,
              77,
              84,
              82,
              109,
              89,
              106,
              89,
              116,
              77,
              109,
              78,
              109,
              90,
              67,
              48,
              50,
              79,
              68,
              65,
              119,
              76,
              84,
              65,
              48,
              90,
              84,
              65,
              116,
              77,
              109,
              70,
              104,
              78,
              87,
              74,
              107,
              90,
              71,
              89,
              120,
              89,
              50,
              85,
              53,
              73,
              105,
              119,
              105,
              97,
              88,
              78,
              122,
              73,
              106,
              111,
              105,
              97,
              72,
              82,
              48,
              99,
              68,
              111,
              118,
              76,
              50,
              120,
              118,
              89,
              50,
              70,
              115,
              97,
              71,
              57,
              122,
              100,
              68,
              111,
              52,
              77,
              68,
              103,
              120,
              76,
              51,
              74,
              108,
              89,
              87,
              120,
              116,
              99,
              121,
              57,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              109,
              70,
              49,
              90,
              67,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              122,
              100,
              87,
              73,
              105,
              79,
              105,
              74,
              104,
              77,
              106,
              89,
              122,
              77,
              68,
              66,
              104,
              90,
              83,
              48,
              50,
              77,
              50,
              74,
              108,
              76,
              84,
              82,
              104,
              77,
              50,
              77,
              116,
              89,
              84,
              78,
              104,
              77,
              67,
              49,
              107,
              79,
              84,
              107,
              50,
              90,
              71,
              81,
              120,
              77,
              50,
              86,
              106,
              78,
              71,
              81,
              105,
              76,
              67,
              74,
              48,
              101,
              88,
              65,
              105,
              79,
              105,
              74,
              83,
              90,
              87,
              90,
              121,
              90,
              88,
              78,
              111,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              69,
              122,
              79,
              87,
              78,
              106,
              89,
              122,
              89,
              121,
              76,
              87,
              90,
              107,
              89,
              84,
              73,
              116,
              78,
              68,
              107,
              120,
              78,
              121,
              48,
              53,
              79,
              87,
              77,
              51,
              76,
              84,
              99,
              121,
              79,
              68,
              86,
              108,
              78,
              68,
              90,
              104,
              89,
              50,
              89,
              121,
              77,
              67,
              73,
              115,
              73,
              110,
              78,
              106,
              98,
              51,
              66,
              108,
              73,
              106,
              111,
              105,
              100,
              50,
              86,
              105,
              76,
              87,
              57,
              121,
              97,
              87,
              100,
              112,
              98,
              110,
              77,
              103,
              89,
              109,
              70,
              122,
              97,
              87,
              77,
              103,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              103,
              89,
              87,
              78,
              121,
              73,
              72,
              66,
              121,
              98,
              50,
              90,
              112,
              98,
              71,
              85,
              103,
              90,
              87,
              49,
              104,
              97,
              87,
              119,
              105,
              102,
              81,
              46,
              100,
              76,
              88,
              89,
              48,
              105,
              104,
              117,
              70,
              54,
              97,
              73,
              84,
              105,
              105,
              118,
              48,
              73,
              56,
              102,
              90,
              115,
              118,
              86,
              90,
              95,
              103,
              45,
              108,
              116,
              89,
              57,
              57,
              69,
              120,
              65,
              101,
              122,
              90,
              77,
              77,
              99,
              79,
              106,
              53,
              51,
              79,
              45,
              55,
              95,
              105,
              86,
              76,
              88,
              121,
              49,
              98,
              87,
              118,
              120,
              104,
              55,
              89,
              49,
              70,
              111,
              49,
              68,
              76,
              106,
              65,
              90,
              81,
              87,
              82,
              105,
              112,
              104,
              69,
              88,
              87,
              80,
              49,
              107,
              113,
              81,
              34,
              44,
              34,
              116,
              111,
              107,
              101,
              110,
              95,
              116,
              121,
              112,
              101,
              34,
              58,
              34,
              66,
              101,
              97,
              114,
              101,
              114,
              34,
              44,
              34,
              110,
              111,
              116,
              45,
              98,
              101,
              102,
              111,
              114,
              101,
              45,
              112,
              111,
              108,
              105,
              99,
              121,
              34,
              58,
              48,
              44,
              34,
              115,
              101,
              115,
              115,
              105,
              111,
              110,
              95,
              115,
              116,
              97,
              116,
              101,
              34,
              58,
              34,
              97,
              51,
              57,
              99,
              99,
              99,
              54,
              50,
              45,
              102,
              100,
              97,
              50,
              45,
              52,
              57,
              49,
              55,
              45,
              57,
              57,
              99,
              55,
              45,
              55,
              50,
              56,
              53,
              101,
              52,
              54,
              97,
              99,
              102,
              50,
              48,
              34,
              44,
              34,
              115,
              99,
              111,
              112,
              101,
              34,
              58,
              34,
              112,
              114,
              111,
              102,
              105,
              108,
              101,
              32,
              101,
              109,
              97,
              105,
              108,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 82,
          "responseSize": 2465
        },
        "id": "043a1159-d237-43cd-adce-4ccdb082317e",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false
          },
          {
            "assertion": "Resposta cont√©m access_token",
            "skipped": false
          },
          {
            "assertion": "Token possui tipo Bearer",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "4a48de0b-5dad-4081-9693-fcf0e75231c2",
          "length": 19,
          "cycles": 1,
          "position": 1,
          "iteration": 0,
          "httpRequestId": "1ce313de-8644-4466-9b81-a5e7cb9dac75"
        },
        "item": {
          "id": "955d92d8-ea1a-49ef-a82b-86767ecc2316",
          "name": "Auth - Get Operador Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "operador@acme.com"
                },
                {
                  "key": "password",
                  "value": "operador123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ec89b935-e15f-4da6-a042-936be908595b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('operador_token', json.access_token);",
                  "console.log('‚úÖ Token do OPERADOR salvo');"
                ],
                "_lastExecutionId": "84a764e3-08a9-480d-9628-e3b0112f2656"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "9694425e-1da9-42b2-8ff0-bdc9dd619295",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "118",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "operador@acme.com"
              },
              {
                "key": "password",
                "value": "operador123"
              }
            ]
          }
        },
        "response": {
          "id": "5cd9c078-ad70-494c-82ed-d9eaa9a24fe5",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "2473"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              97,
              99,
              99,
              101,
              115,
              115,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              83,
              85,
              122,
              73,
              49,
              78,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              69,
              82,
              48,
              57,
              119,
              84,
              86,
              108,
              122,
              85,
              49,
              57,
              117,
              100,
              109,
              74,
              76,
              89,
              48,
              111,
              52,
              100,
              70,
              104,
              71,
              77,
              48,
              53,
              113,
              89,
              107,
              86,
              112,
              86,
              50,
              70,
              71,
              81,
              50,
              53,
              107,
              81,
              49,
              112,
              110,
              84,
              107,
              49,
              73,
              98,
              88,
              90,
              80,
              100,
              51,
              74,
              110,
              73,
              110,
              48,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              69,
              119,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              98,
              50,
              53,
              121,
              100,
              72,
              74,
              118,
              79,
              106,
              77,
              120,
              89,
              87,
              82,
              109,
              78,
              68,
              103,
              51,
              76,
              87,
              85,
              53,
              78,
              87,
              89,
              116,
              77,
              122,
              65,
              51,
              77,
              105,
              49,
              106,
              78,
              84,
              100,
              108,
              76,
              84,
              73,
              51,
              89,
              122,
              73,
              51,
              78,
              106,
              66,
              109,
              79,
              87,
              85,
              119,
              78,
              105,
              73,
              115,
              73,
              109,
              108,
              122,
              99,
              121,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              104,
              100,
              87,
              81,
              105,
              79,
              105,
              74,
              104,
              89,
              50,
              78,
              118,
              100,
              87,
              53,
              48,
              73,
              105,
              119,
              105,
              99,
              51,
              86,
              105,
              73,
              106,
              111,
              105,
              89,
              122,
              107,
              122,
              89,
              106,
              89,
              122,
              77,
              68,
              107,
              116,
              90,
              68,
              69,
              52,
              90,
              67,
              48,
              48,
              77,
              50,
              86,
              107,
              76,
              87,
              74,
              105,
              78,
              122,
              81,
              116,
              89,
              87,
              73,
              49,
              78,
              84,
              103,
              120,
              77,
              106,
              73,
              120,
              89,
              84,
              81,
              121,
              73,
              105,
              119,
              105,
              100,
              72,
              108,
              119,
              73,
              106,
              111,
              105,
              81,
              109,
              86,
              104,
              99,
              109,
              86,
              121,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              89,
              48,
              78,
              71,
              73,
              121,
              77,
              84,
              73,
              122,
              76,
              87,
              69,
              51,
              90,
              84,
              107,
              116,
              90,
              87,
              90,
              109,
              79,
              67,
              49,
              107,
              77,
              87,
              74,
              106,
              76,
              87,
              73,
              53,
              79,
              71,
              90,
              104,
              89,
              122,
              73,
              48,
              90,
              106,
              108,
              105,
              90,
              67,
              73,
              115,
              73,
              109,
              70,
              106,
              99,
              105,
              73,
              54,
              73,
              106,
              69,
              105,
              76,
              67,
              74,
              121,
              90,
              87,
              70,
              115,
              98,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              79,
              110,
              115,
              105,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              105,
              79,
              108,
              115,
              105,
              90,
              71,
              86,
              109,
              89,
              88,
              86,
              115,
              100,
              67,
              49,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              49,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              109,
              57,
              109,
              90,
              109,
              120,
              112,
              98,
              109,
              86,
              102,
              89,
              87,
              78,
              106,
              90,
              88,
              78,
              122,
              73,
              105,
              119,
              105,
              84,
              49,
              66,
              70,
              85,
              107,
              70,
              69,
              84,
              49,
              73,
              105,
              76,
              67,
              74,
              49,
              98,
              87,
              70,
              102,
              89,
              88,
              86,
              48,
              97,
              71,
              57,
              121,
              97,
              88,
              112,
              104,
              100,
              71,
              108,
              118,
              98,
              105,
              74,
              100,
              102,
              83,
              119,
              105,
              99,
              109,
              86,
              122,
              98,
              51,
              86,
              121,
              89,
              50,
              86,
              102,
              89,
              87,
              78,
              106,
              90,
              88,
              78,
              122,
              73,
              106,
              112,
              55,
              73,
              109,
              70,
              106,
              89,
              50,
              57,
              49,
              98,
              110,
              81,
              105,
              79,
              110,
              115,
              105,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              105,
              79,
              108,
              115,
              105,
              98,
              87,
              70,
              117,
              89,
              87,
              100,
              108,
              76,
              87,
              70,
              106,
              89,
              50,
              57,
              49,
              98,
              110,
              81,
              105,
              76,
              67,
              74,
              116,
              89,
              87,
              53,
              104,
              90,
              50,
              85,
              116,
              89,
              87,
              78,
              106,
              98,
              51,
              86,
              117,
              100,
              67,
              49,
              115,
              97,
              87,
              53,
              114,
              99,
              121,
              73,
              115,
              73,
              110,
              90,
              112,
              90,
              88,
              99,
              116,
              99,
              72,
              74,
              118,
              90,
              109,
              108,
              115,
              90,
              83,
              74,
              100,
              102,
              88,
              48,
              115,
              73,
              110,
              78,
              106,
              98,
              51,
              66,
              108,
              73,
              106,
              111,
              105,
              99,
              72,
              74,
              118,
              90,
              109,
              108,
              115,
              90,
              83,
              66,
              108,
              98,
              87,
              70,
              112,
              98,
              67,
              73,
              115,
              73,
              110,
              82,
              108,
              98,
              109,
              70,
              117,
              100,
              70,
              57,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              69,
              119,
              90,
              87,
              86,
              105,
              89,
              122,
              107,
              53,
              76,
              84,
              108,
              106,
              77,
              71,
              73,
              116,
              78,
              71,
              86,
              109,
              79,
              67,
              49,
              105,
              89,
              106,
              90,
              107,
              76,
              84,
              90,
              105,
              89,
              106,
              108,
              105,
              90,
              68,
              77,
              52,
              77,
              71,
              69,
              120,
              77,
              83,
              73,
              115,
              73,
              109,
              86,
              116,
              89,
              87,
              108,
              115,
              88,
              51,
              90,
              108,
              99,
              109,
              108,
              109,
              97,
              87,
              86,
              107,
              73,
              106,
              112,
              48,
              99,
              110,
              86,
              108,
              76,
              67,
              74,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              107,
              90,
              87,
              90,
              104,
              100,
              87,
              120,
              48,
              76,
              88,
              74,
              118,
              98,
              71,
              86,
              122,
              76,
              87,
              112,
              108,
              100,
              72,
              78,
              114,
              97,
              83,
              49,
              122,
              89,
              87,
              70,
              122,
              73,
              105,
              119,
              105,
              98,
              50,
              90,
              109,
              98,
              71,
              108,
              117,
              90,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              76,
              67,
              74,
              80,
              85,
              69,
              86,
              83,
              81,
              85,
              82,
              80,
              85,
              105,
              73,
              115,
              73,
              110,
              86,
              116,
              89,
              86,
              57,
              104,
              100,
              88,
              82,
              111,
              98,
              51,
              74,
              112,
              101,
              109,
              70,
              48,
              97,
              87,
              57,
              117,
              73,
              108,
              48,
              115,
              73,
              109,
              53,
              104,
              98,
              87,
              85,
              105,
              79,
              105,
              74,
              80,
              99,
              71,
              86,
              121,
              89,
              87,
              82,
              118,
              99,
              105,
              66,
              66,
              81,
              48,
              49,
              70,
              73,
              105,
              119,
              105,
              90,
              50,
              120,
              118,
              89,
              109,
              70,
              115,
              88,
              51,
              74,
              118,
              98,
              71,
              86,
              122,
              73,
              106,
              112,
              98,
              73,
              110,
              82,
              108,
              98,
              109,
              70,
              117,
              100,
              67,
              49,
              104,
              89,
              50,
              49,
              108,
              73,
              108,
              48,
              115,
              73,
              109,
              100,
              121,
              98,
              51,
              86,
              119,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              48,
              90,
              87,
              53,
              104,
              98,
              110,
              81,
              116,
              89,
              87,
              78,
              116,
              90,
              83,
              74,
              100,
              76,
              67,
              74,
              119,
              99,
              109,
              86,
              109,
              90,
              88,
              74,
              121,
              90,
              87,
              82,
              102,
              100,
              88,
              78,
              108,
              99,
              109,
              53,
              104,
              98,
              87,
              85,
              105,
              79,
              105,
              74,
              118,
              99,
              71,
              86,
              121,
              89,
              87,
              82,
              118,
              99,
              107,
              66,
              104,
              89,
              50,
              49,
              108,
              76,
              109,
              78,
              118,
              98,
              83,
              73,
              115,
              73,
              109,
              100,
              112,
              100,
              109,
              86,
              117,
              88,
              50,
              53,
              104,
              98,
              87,
              85,
              105,
              79,
              105,
              74,
              80,
              99,
              71,
              86,
              121,
              89,
              87,
              82,
              118,
              99,
              105,
              73,
              115,
              73,
              109,
              90,
              104,
              98,
              87,
              108,
              115,
              101,
              86,
              57,
              117,
              89,
              87,
              49,
              108,
              73,
              106,
              111,
              105,
              81,
              85,
              78,
              78,
              82,
              83,
              73,
              115,
              73,
              109,
              86,
              116,
              89,
              87,
              108,
              115,
              73,
              106,
              111,
              105,
              98,
              51,
              66,
              108,
              99,
              109,
              70,
              107,
              98,
              51,
              74,
              65,
              89,
              87,
              78,
              116,
              90,
              83,
              53,
              106,
              98,
              50,
              48,
              105,
              102,
              81,
              46,
              81,
              76,
              98,
              111,
              51,
              84,
              113,
              81,
              67,
              69,
              103,
              88,
              110,
              113,
              73,
              85,
              119,
              115,
              87,
              108,
              116,
              74,
              99,
              51,
              121,
              82,
              69,
              97,
              117,
              82,
              121,
              90,
              68,
              84,
              95,
              111,
              57,
              97,
              75,
              106,
              87,
              65,
              52,
              78,
              54,
              68,
              84,
              90,
              84,
              88,
              105,
              65,
              103,
              45,
              84,
              80,
              102,
              119,
              52,
              87,
              101,
              98,
              122,
              107,
              50,
              109,
              117,
              75,
              54,
              108,
              53,
              57,
              55,
              86,
              109,
              98,
              73,
              80,
              110,
              117,
              98,
              72,
              119,
              110,
              48,
              50,
              116,
              50,
              103,
              84,
              109,
              75,
              107,
              100,
              45,
              50,
              67,
              66,
              99,
              75,
              69,
              119,
              71,
              100,
              90,
              84,
              69,
              114,
              89,
              48,
              68,
              104,
              49,
              50,
              104,
              76,
              100,
              45,
              88,
              49,
              122,
              121,
              74,
              54,
              70,
              67,
              53,
              89,
              111,
              116,
              66,
              119,
              81,
              82,
              116,
              54,
              120,
              51,
              72,
              57,
              50,
              105,
              100,
              82,
              103,
              90,
              89,
              69,
              85,
              105,
              48,
              121,
              51,
              110,
              50,
              101,
              98,
              116,
              79,
              107,
              88,
              104,
              69,
              89,
              77,
              85,
              111,
              97,
              113,
              109,
              71,
              48,
              111,
              118,
              119,
              118,
              75,
              69,
              65,
              118,
              48,
              113,
              98,
              101,
              88,
              86,
              57,
              48,
              101,
              82,
              120,
              100,
              52,
              67,
              83,
              114,
              50,
              77,
              78,
              49,
              57,
              122,
              116,
              82,
              50,
              81,
              106,
              87,
              103,
              110,
              70,
              76,
              88,
              90,
              55,
              70,
              103,
              114,
              49,
              45,
              48,
              98,
              65,
              116,
              115,
              78,
              113,
              104,
              99,
              107,
              71,
              54,
              88,
              115,
              102,
              115,
              55,
              110,
              106,
              72,
              108,
              108,
              113,
              65,
              51,
              98,
              105,
              68,
              73,
              68,
              68,
              101,
              105,
              87,
              85,
              67,
              66,
              90,
              121,
              75,
              69,
              103,
              118,
              48,
              66,
              122,
              68,
              111,
              99,
              76,
              100,
              48,
              102,
              90,
              51,
              45,
              110,
              70,
              68,
              51,
              77,
              115,
              57,
              73,
              71,
              82,
              121,
              79,
              99,
              82,
              104,
              74,
              110,
              85,
              48,
              53,
              106,
              111,
              54,
              83,
              52,
              86,
              118,
              120,
              108,
              49,
              97,
              66,
              71,
              102,
              89,
              90,
              108,
              72,
              54,
              45,
              85,
              98,
              67,
              48,
              89,
              85,
              77,
              51,
              84,
              87,
              84,
              70,
              108,
              66,
              90,
              105,
              70,
              83,
              87,
              89,
              117,
              107,
              50,
              77,
              85,
              103,
              34,
              44,
              34,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              54,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              49,
              56,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              73,
              85,
              122,
              85,
              120,
              77,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              106,
              89,
              106,
              66,
              107,
              90,
              106,
              108,
              106,
              89,
              105,
              48,
              52,
              89,
              109,
              89,
              121,
              76,
              84,
              81,
              53,
              90,
              68,
              65,
              116,
              89,
              84,
              73,
              52,
              89,
              83,
              48,
              49,
              78,
              68,
              73,
              50,
              89,
              84,
              69,
              119,
              78,
              109,
              89,
              122,
              89,
              106,
              99,
              105,
              102,
              81,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              73,
              121,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              77,
              68,
              89,
              122,
              89,
              122,
              86,
              106,
              89,
              50,
              77,
              116,
              78,
              106,
              66,
              109,
              90,
              67,
              48,
              119,
              78,
              109,
              81,
              51,
              76,
              87,
              86,
              105,
              78,
              122,
              103,
              116,
              77,
              106,
              66,
              109,
              89,
              106,
              86,
              104,
              77,
              50,
              82,
              104,
              90,
              106,
              69,
              120,
              73,
              105,
              119,
              105,
              97,
              88,
              78,
              122,
              73,
              106,
              111,
              105,
              97,
              72,
              82,
              48,
              99,
              68,
              111,
              118,
              76,
              50,
              120,
              118,
              89,
              50,
              70,
              115,
              97,
              71,
              57,
              122,
              100,
              68,
              111,
              52,
              77,
              68,
              103,
              120,
              76,
              51,
              74,
              108,
              89,
              87,
              120,
              116,
              99,
              121,
              57,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              109,
              70,
              49,
              90,
              67,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              122,
              100,
              87,
              73,
              105,
              79,
              105,
              74,
              106,
              79,
              84,
              78,
              105,
              78,
              106,
              77,
              119,
              79,
              83,
              49,
              107,
              77,
              84,
              104,
              107,
              76,
              84,
              81,
              122,
              90,
              87,
              81,
              116,
              89,
              109,
              73,
              51,
              78,
              67,
              49,
              104,
              89,
              106,
              85,
              49,
              79,
              68,
              69,
              121,
              77,
              106,
              70,
              104,
              78,
              68,
              73,
              105,
              76,
              67,
              74,
              48,
              101,
              88,
              65,
              105,
              79,
              105,
              74,
              83,
              90,
              87,
              90,
              121,
              90,
              88,
              78,
              111,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              89,
              48,
              78,
              71,
              73,
              121,
              77,
              84,
              73,
              122,
              76,
              87,
              69,
              51,
              90,
              84,
              107,
              116,
              90,
              87,
              90,
              109,
              79,
              67,
              49,
              107,
              77,
              87,
              74,
              106,
              76,
              87,
              73,
              53,
              79,
              71,
              90,
              104,
              89,
              122,
              73,
              48,
              90,
              106,
              108,
              105,
              90,
              67,
              73,
              115,
              73,
              110,
              78,
              106,
              98,
              51,
              66,
              108,
              73,
              106,
              111,
              105,
              100,
              50,
              86,
              105,
              76,
              87,
              57,
              121,
              97,
              87,
              100,
              112,
              98,
              110,
              77,
              103,
              89,
              109,
              70,
              122,
              97,
              87,
              77,
              103,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              103,
              89,
              87,
              78,
              121,
              73,
              72,
              66,
              121,
              98,
              50,
              90,
              112,
              98,
              71,
              85,
              103,
              90,
              87,
              49,
              104,
              97,
              87,
              119,
              105,
              102,
              81,
              46,
              114,
              115,
              100,
              115,
              98,
              117,
              77,
              101,
              68,
              71,
              45,
              113,
              122,
              119,
              53,
              114,
              98,
              57,
              72,
              109,
              56,
              120,
              83,
              120,
              101,
              73,
              114,
              108,
              103,
              104,
              88,
              105,
              54,
              88,
              87,
              120,
              80,
              69,
              112,
              115,
              120,
              85,
              104,
              75,
              116,
              74,
              89,
              110,
              83,
              53,
              83,
              80,
              72,
              70,
              56,
              56,
              97,
              121,
              49,
              53,
              74,
              86,
              112,
              115,
              103,
              89,
              101,
              54,
              100,
              105,
              121,
              104,
              113,
              79,
              119,
              84,
              77,
              72,
              118,
              116,
              121,
              104,
              108,
              105,
              84,
              65,
              34,
              44,
              34,
              116,
              111,
              107,
              101,
              110,
              95,
              116,
              121,
              112,
              101,
              34,
              58,
              34,
              66,
              101,
              97,
              114,
              101,
              114,
              34,
              44,
              34,
              110,
              111,
              116,
              45,
              98,
              101,
              102,
              111,
              114,
              101,
              45,
              112,
              111,
              108,
              105,
              99,
              121,
              34,
              58,
              48,
              44,
              34,
              115,
              101,
              115,
              115,
              105,
              111,
              110,
              95,
              115,
              116,
              97,
              116,
              101,
              34,
              58,
              34,
              102,
              52,
              52,
              98,
              50,
              49,
              50,
              51,
              45,
              97,
              55,
              101,
              57,
              45,
              101,
              102,
              102,
              56,
              45,
              100,
              49,
              98,
              99,
              45,
              98,
              57,
              56,
              102,
              97,
              99,
              50,
              52,
              102,
              57,
              98,
              100,
              34,
              44,
              34,
              115,
              99,
              111,
              112,
              101,
              34,
              58,
              34,
              112,
              114,
              111,
              102,
              105,
              108,
              101,
              32,
              101,
              109,
              97,
              105,
              108,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 35,
          "responseSize": 2473
        },
        "id": "955d92d8-ea1a-49ef-a82b-86767ecc2316",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "fe7fec93-c8ba-4740-a524-2942ea794627",
          "length": 19,
          "cycles": 1,
          "position": 2,
          "iteration": 0,
          "httpRequestId": "30736dce-617b-4db1-b284-251567c90548"
        },
        "item": {
          "id": "6a55bf83-4a2c-4e0e-b2fa-dadc7f9d3d72",
          "name": "Auth - Get Financeiro Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente@acme.com"
                },
                {
                  "key": "password",
                  "value": "gerente123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "667f77a0-c12b-457f-97a1-ac976c30b8ee",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('financeiro_token', json.access_token);",
                  "console.log('‚úÖ Token do FINANCEIRO salvo');"
                ],
                "_lastExecutionId": "bab9240f-b673-42ad-b8c9-44bccb896334"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "839d7f69-ab75-41cf-86cb-df85d54b6790",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "116",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "gerente@acme.com"
              },
              {
                "key": "password",
                "value": "gerente123"
              }
            ]
          }
        },
        "response": {
          "id": "a2d6085b-4cf0-4fcc-a10c-917290705933",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "2465"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              97,
              99,
              99,
              101,
              115,
              115,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              83,
              85,
              122,
              73,
              49,
              78,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              69,
              82,
              48,
              57,
              119,
              84,
              86,
              108,
              122,
              85,
              49,
              57,
              117,
              100,
              109,
              74,
              76,
              89,
              48,
              111,
              52,
              100,
              70,
              104,
              71,
              77,
              48,
              53,
              113,
              89,
              107,
              86,
              112,
              86,
              50,
              70,
              71,
              81,
              50,
              53,
              107,
              81,
              49,
              112,
              110,
              84,
              107,
              49,
              73,
              98,
              88,
              90,
              80,
              100,
              51,
              74,
              110,
              73,
              110,
              48,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              69,
              119,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              98,
              50,
              53,
              121,
              100,
              72,
              74,
              118,
              79,
              106,
              82,
              105,
              89,
              109,
              77,
              120,
              78,
              122,
              86,
              108,
              76,
              87,
              69,
              53,
              77,
              122,
              73,
              116,
              89,
              84,
              99,
              121,
              89,
              83,
              48,
              51,
              90,
              84,
              65,
              119,
              76,
              84,
              100,
              109,
              78,
              84,
              73,
              50,
              78,
              109,
              89,
              53,
              77,
              87,
              82,
              104,
              77,
              105,
              73,
              115,
              73,
              109,
              108,
              122,
              99,
              121,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              104,
              100,
              87,
              81,
              105,
              79,
              105,
              74,
              104,
              89,
              50,
              78,
              118,
              100,
              87,
              53,
              48,
              73,
              105,
              119,
              105,
              99,
              51,
              86,
              105,
              73,
              106,
              111,
              105,
              89,
              84,
              73,
              50,
              77,
              122,
              65,
              119,
              89,
              87,
              85,
              116,
              78,
              106,
              78,
              105,
              90,
              83,
              48,
              48,
              89,
              84,
              78,
              106,
              76,
              87,
              69,
              122,
              89,
              84,
              65,
              116,
              90,
              68,
              107,
              53,
              78,
              109,
              82,
              107,
              77,
              84,
              78,
              108,
              89,
              122,
              82,
              107,
              73,
              105,
              119,
              105,
              100,
              72,
              108,
              119,
              73,
              106,
              111,
              105,
              81,
              109,
              86,
              104,
              99,
              109,
              86,
              121,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              81,
              53,
              78,
              68,
              65,
              50,
              77,
              84,
              82,
              109,
              76,
              84,
              73,
              122,
              78,
              71,
              69,
              116,
              77,
              109,
              89,
              122,
              78,
              67,
              49,
              106,
              90,
              109,
              85,
              49,
              76,
              84,
              69,
              48,
              77,
              87,
              86,
              106,
              77,
              84,
              74,
              108,
              79,
              68,
              107,
              50,
              77,
              67,
              73,
              115,
              73,
              109,
              70,
              106,
              99,
              105,
              73,
              54,
              73,
              106,
              69,
              105,
              76,
              67,
              74,
              121,
              90,
              87,
              70,
              115,
              98,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              79,
              110,
              115,
              105,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              105,
              79,
              108,
              115,
              105,
              90,
              71,
              86,
              109,
              89,
              88,
              86,
              115,
              100,
              67,
              49,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              49,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              107,
              100,
              70,
              85,
              107,
              86,
              79,
              86,
              69,
              85,
              105,
              76,
              67,
              74,
              118,
              90,
              109,
              90,
              115,
              97,
              87,
              53,
              108,
              88,
              50,
              70,
              106,
              89,
              50,
              86,
              122,
              99,
              121,
              73,
              115,
              73,
              110,
              86,
              116,
              89,
              86,
              57,
              104,
              100,
              88,
              82,
              111,
              98,
              51,
              74,
              112,
              101,
              109,
              70,
              48,
              97,
              87,
              57,
              117,
              73,
              108,
              49,
              57,
              76,
              67,
              74,
              121,
              90,
              88,
              78,
              118,
              100,
              88,
              74,
              106,
              90,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              79,
              110,
              115,
              105,
              89,
              87,
              78,
              106,
              98,
              51,
              86,
              117,
              100,
              67,
              73,
              54,
              101,
              121,
              74,
              121,
              98,
              50,
              120,
              108,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              116,
              89,
              87,
              53,
              104,
              90,
              50,
              85,
              116,
              89,
              87,
              78,
              106,
              98,
              51,
              86,
              117,
              100,
              67,
              73,
              115,
              73,
              109,
              49,
              104,
              98,
              109,
              70,
              110,
              90,
              83,
              49,
              104,
              89,
              50,
              78,
              118,
              100,
              87,
              53,
              48,
              76,
              87,
              120,
              112,
              98,
              109,
              116,
              122,
              73,
              105,
              119,
              105,
              100,
              109,
              108,
              108,
              100,
              121,
              49,
              119,
              99,
              109,
              57,
              109,
              97,
              87,
              120,
              108,
              73,
              108,
              49,
              57,
              102,
              83,
              119,
              105,
              99,
              50,
              78,
              118,
              99,
              71,
              85,
              105,
              79,
              105,
              74,
              119,
              99,
              109,
              57,
              109,
              97,
              87,
              120,
              108,
              73,
              71,
              86,
              116,
              89,
              87,
              108,
              115,
              73,
              105,
              119,
              105,
              100,
              71,
              86,
              117,
              89,
              87,
              53,
              48,
              88,
              50,
              108,
              107,
              73,
              106,
              111,
              105,
              89,
              84,
              66,
              108,
              90,
              87,
              74,
              106,
              79,
              84,
              107,
              116,
              79,
              87,
              77,
              119,
              89,
              105,
              48,
              48,
              90,
              87,
              89,
              52,
              76,
              87,
              74,
              105,
              78,
              109,
              81,
              116,
              78,
              109,
              74,
              105,
              79,
              87,
              74,
              107,
              77,
              122,
              103,
              119,
              89,
              84,
              69,
              120,
              73,
              105,
              119,
              105,
              90,
              87,
              49,
              104,
              97,
              87,
              120,
              102,
              100,
              109,
              86,
              121,
              97,
              87,
              90,
              112,
              90,
              87,
              81,
              105,
              79,
              110,
              82,
              121,
              100,
              87,
              85,
              115,
              73,
              110,
              74,
              118,
              98,
              71,
              86,
              122,
              73,
              106,
              112,
              98,
              73,
              109,
              82,
              108,
              90,
              109,
              70,
              49,
              98,
              72,
              81,
              116,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              116,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              72,
              82,
              86,
              74,
              70,
              84,
              108,
              82,
              70,
              73,
              105,
              119,
              105,
              98,
              50,
              90,
              109,
              98,
              71,
              108,
              117,
              90,
              86,
              57,
              104,
              89,
              50,
              78,
              108,
              99,
              51,
              77,
              105,
              76,
              67,
              74,
              49,
              98,
              87,
              70,
              102,
              89,
              88,
              86,
              48,
              97,
              71,
              57,
              121,
              97,
              88,
              112,
              104,
              100,
              71,
              108,
              118,
              98,
              105,
              74,
              100,
              76,
              67,
              74,
              117,
              89,
              87,
              49,
              108,
              73,
              106,
              111,
              105,
              82,
              50,
              86,
              121,
              90,
              87,
              53,
              48,
              90,
              83,
              66,
              66,
              81,
              48,
              49,
              70,
              73,
              105,
              119,
              105,
              90,
              50,
              120,
              118,
              89,
              109,
              70,
              115,
              88,
              51,
              74,
              118,
              98,
              71,
              86,
              122,
              73,
              106,
              112,
              98,
              73,
              110,
              82,
              108,
              98,
              109,
              70,
              117,
              100,
              67,
              49,
              104,
              89,
              50,
              49,
              108,
              73,
              108,
              48,
              115,
              73,
              109,
              100,
              121,
              98,
              51,
              86,
              119,
              99,
              121,
              73,
              54,
              87,
              121,
              74,
              48,
              90,
              87,
              53,
              104,
              98,
              110,
              81,
              116,
              89,
              87,
              78,
              116,
              90,
              83,
              74,
              100,
              76,
              67,
              74,
              119,
              99,
              109,
              86,
              109,
              90,
              88,
              74,
              121,
              90,
              87,
              82,
              102,
              100,
              88,
              78,
              108,
              99,
              109,
              53,
              104,
              98,
              87,
              85,
              105,
              79,
              105,
              74,
              110,
              90,
              88,
              74,
              108,
              98,
              110,
              82,
              108,
              81,
              71,
              70,
              106,
              98,
              87,
              85,
              117,
              89,
              50,
              57,
              116,
              73,
              105,
              119,
              105,
              90,
              50,
              108,
              50,
              90,
              87,
              53,
              102,
              98,
              109,
              70,
              116,
              90,
              83,
              73,
              54,
              73,
              107,
              100,
              108,
              99,
              109,
              86,
              117,
              100,
              71,
              85,
              105,
              76,
              67,
              74,
              109,
              89,
              87,
              49,
              112,
              98,
              72,
              108,
              102,
              98,
              109,
              70,
              116,
              90,
              83,
              73,
              54,
              73,
              107,
              70,
              68,
              84,
              85,
              85,
              105,
              76,
              67,
              74,
              108,
              98,
              87,
              70,
              112,
              98,
              67,
              73,
              54,
              73,
              109,
              100,
              108,
              99,
              109,
              86,
              117,
              100,
              71,
              86,
              65,
              89,
              87,
              78,
              116,
              90,
              83,
              53,
              106,
              98,
              50,
              48,
              105,
              102,
              81,
              46,
              111,
              109,
              102,
              49,
              119,
              116,
              116,
              67,
              84,
              78,
              105,
              74,
              104,
              56,
              84,
              90,
              66,
              119,
              97,
              84,
              75,
              54,
              68,
              80,
              50,
              53,
              71,
              65,
              75,
              102,
              118,
              103,
              81,
              81,
              100,
              55,
              50,
              107,
              79,
              101,
              84,
              116,
              67,
              100,
              78,
              89,
              111,
              89,
              68,
              122,
              74,
              50,
              103,
              121,
              103,
              65,
              67,
              104,
              65,
              73,
              57,
              53,
              102,
              114,
              113,
              54,
              116,
              67,
              121,
              55,
              45,
              109,
              101,
              90,
              115,
              69,
              51,
              71,
              116,
              74,
              52,
              77,
              45,
              70,
              112,
              97,
              75,
              101,
              95,
              45,
              78,
              89,
              120,
              116,
              111,
              54,
              87,
              102,
              57,
              103,
              98,
              45,
              116,
              65,
              69,
              57,
              100,
              72,
              56,
              102,
              95,
              102,
              68,
              90,
              52,
              53,
              100,
              111,
              52,
              75,
              71,
              85,
              104,
              98,
              84,
              118,
              73,
              80,
              121,
              122,
              101,
              85,
              105,
              99,
              84,
              51,
              84,
              113,
              90,
              71,
              122,
              66,
              50,
              110,
              86,
              51,
              102,
              85,
              107,
              74,
              67,
              56,
              50,
              87,
              65,
              107,
              95,
              78,
              98,
              109,
              89,
              88,
              108,
              112,
              54,
              67,
              113,
              78,
              67,
              74,
              118,
              101,
              90,
              110,
              102,
              49,
              76,
              73,
              102,
              88,
              106,
              105,
              108,
              52,
              75,
              55,
              95,
              115,
              88,
              97,
              52,
              72,
              121,
              80,
              80,
              119,
              113,
              68,
              119,
              120,
              80,
              89,
              84,
              103,
              106,
              122,
              56,
              82,
              80,
              53,
              54,
              73,
              89,
              85,
              103,
              51,
              80,
              90,
              113,
              80,
              57,
              70,
              98,
              101,
              89,
              57,
              105,
              69,
              75,
              78,
              114,
              57,
              88,
              114,
              82,
              49,
              83,
              79,
              71,
              67,
              115,
              71,
              105,
              76,
              89,
              95,
              53,
              77,
              78,
              49,
              101,
              122,
              78,
              72,
              110,
              101,
              102,
              81,
              122,
              84,
              118,
              119,
              116,
              87,
              66,
              115,
              77,
              120,
              103,
              90,
              72,
              117,
              55,
              112,
              80,
              71,
              75,
              100,
              119,
              66,
              99,
              71,
              95,
              116,
              54,
              119,
              53,
              109,
              57,
              70,
              86,
              115,
              75,
              110,
              115,
              119,
              67,
              101,
              56,
              73,
              122,
              99,
              49,
              74,
              105,
              65,
              112,
              101,
              108,
              45,
              78,
              113,
              70,
              52,
              111,
              106,
              121,
              74,
              117,
              97,
              73,
              55,
              80,
              75,
              87,
              88,
              112,
              89,
              65,
              107,
              101,
              84,
              117,
              69,
              114,
              82,
              110,
              73,
              75,
              67,
              68,
              81,
              34,
              44,
              34,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              54,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              101,
              120,
              112,
              105,
              114,
              101,
              115,
              95,
              105,
              110,
              34,
              58,
              49,
              56,
              48,
              48,
              44,
              34,
              114,
              101,
              102,
              114,
              101,
              115,
              104,
              95,
              116,
              111,
              107,
              101,
              110,
              34,
              58,
              34,
              101,
              121,
              74,
              104,
              98,
              71,
              99,
              105,
              79,
              105,
              74,
              73,
              85,
              122,
              85,
              120,
              77,
              105,
              73,
              115,
              73,
              110,
              82,
              53,
              99,
              67,
              73,
              103,
              79,
              105,
              65,
              105,
              83,
              108,
              100,
              85,
              73,
              105,
              119,
              105,
              97,
              50,
              108,
              107,
              73,
              105,
              65,
              54,
              73,
              67,
              74,
              106,
              89,
              106,
              66,
              107,
              90,
              106,
              108,
              106,
              89,
              105,
              48,
              52,
              89,
              109,
              89,
              121,
              76,
              84,
              81,
              53,
              90,
              68,
              65,
              116,
              89,
              84,
              73,
              52,
              89,
              83,
              48,
              49,
              78,
              68,
              73,
              50,
              89,
              84,
              69,
              119,
              78,
              109,
              89,
              122,
              89,
              106,
              99,
              105,
              102,
              81,
              46,
              101,
              121,
              74,
              108,
              101,
              72,
              65,
              105,
              79,
              106,
              69,
              51,
              78,
              106,
              73,
              122,
              77,
              122,
              73,
              121,
              78,
              68,
              81,
              115,
              73,
              109,
              108,
              104,
              100,
              67,
              73,
              54,
              77,
              84,
              99,
              50,
              77,
              106,
              77,
              122,
              77,
              68,
              81,
              48,
              78,
              67,
              119,
              105,
              97,
              110,
              82,
              112,
              73,
              106,
              111,
              105,
              79,
              68,
              78,
              108,
              77,
              84,
              65,
              52,
              90,
              84,
              85,
              116,
              90,
              106,
              103,
              52,
              89,
              105,
              49,
              109,
              90,
              109,
              78,
              108,
              76,
              84,
              69,
              49,
              78,
              84,
              65,
              116,
              90,
              87,
              73,
              48,
              89,
              122,
              89,
              48,
              78,
              106,
              89,
              50,
              90,
              68,
              85,
              51,
              73,
              105,
              119,
              105,
              97,
              88,
              78,
              122,
              73,
              106,
              111,
              105,
              97,
              72,
              82,
              48,
              99,
              68,
              111,
              118,
              76,
              50,
              120,
              118,
              89,
              50,
              70,
              115,
              97,
              71,
              57,
              122,
              100,
              68,
              111,
              52,
              77,
              68,
              103,
              120,
              76,
              51,
              74,
              108,
              89,
              87,
              120,
              116,
              99,
              121,
              57,
              113,
              90,
              88,
              82,
              122,
              97,
              50,
              107,
              116,
              99,
              50,
              70,
              104,
              99,
              121,
              73,
              115,
              73,
              109,
              70,
              49,
              90,
              67,
              73,
              54,
              73,
              109,
              104,
              48,
              100,
              72,
              65,
              54,
              76,
              121,
              57,
              115,
              98,
              50,
              78,
              104,
              98,
              71,
              104,
              118,
              99,
              51,
              81,
              54,
              79,
              68,
              65,
              52,
              77,
              83,
              57,
              121,
              90,
              87,
              70,
              115,
              98,
              88,
              77,
              118,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              88,
              78,
              104,
              89,
              88,
              77,
              105,
              76,
              67,
              74,
              122,
              100,
              87,
              73,
              105,
              79,
              105,
              74,
              104,
              77,
              106,
              89,
              122,
              77,
              68,
              66,
              104,
              90,
              83,
              48,
              50,
              77,
              50,
              74,
              108,
              76,
              84,
              82,
              104,
              77,
              50,
              77,
              116,
              89,
              84,
              78,
              104,
              77,
              67,
              49,
              107,
              79,
              84,
              107,
              50,
              90,
              71,
              81,
              120,
              77,
              50,
              86,
              106,
              78,
              71,
              81,
              105,
              76,
              67,
              74,
              48,
              101,
              88,
              65,
              105,
              79,
              105,
              74,
              83,
              90,
              87,
              90,
              121,
              90,
              88,
              78,
              111,
              73,
              105,
              119,
              105,
              89,
              88,
              112,
              119,
              73,
              106,
              111,
              105,
              97,
              109,
              86,
              48,
              99,
              50,
              116,
              112,
              76,
              87,
              70,
              119,
              97,
              83,
              73,
              115,
              73,
              110,
              78,
              112,
              90,
              67,
              73,
              54,
              73,
              109,
              81,
              53,
              78,
              68,
              65,
              50,
              77,
              84,
              82,
              109,
              76,
              84,
              73,
              122,
              78,
              71,
              69,
              116,
              77,
              109,
              89,
              122,
              78,
              67,
              49,
              106,
              90,
              109,
              85,
              49,
              76,
              84,
              69,
              48,
              77,
              87,
              86,
              106,
              77,
              84,
              74,
              108,
              79,
              68,
              107,
              50,
              77,
              67,
              73,
              115,
              73,
              110,
              78,
              106,
              98,
              51,
              66,
              108,
              73,
              106,
              111,
              105,
              100,
              50,
              86,
              105,
              76,
              87,
              57,
              121,
              97,
              87,
              100,
              112,
              98,
              110,
              77,
              103,
              89,
              109,
              70,
              122,
              97,
              87,
              77,
              103,
              99,
              109,
              57,
              115,
              90,
              88,
              77,
              103,
              89,
              87,
              78,
              121,
              73,
              72,
              66,
              121,
              98,
              50,
              90,
              112,
              98,
              71,
              85,
              103,
              90,
              87,
              49,
              104,
              97,
              87,
              119,
              105,
              102,
              81,
              46,
              72,
              112,
              119,
              81,
              57,
              78,
              107,
              116,
              100,
              49,
              114,
              70,
              83,
              105,
              67,
              95,
              67,
              82,
              107,
              80,
              119,
              73,
              52,
              57,
              90,
              90,
              119,
              66,
              99,
              74,
              78,
              83,
              55,
              71,
              67,
              111,
              82,
              83,
              113,
              116,
              49,
              101,
              78,
              82,
              88,
              87,
              103,
              106,
              48,
              111,
              66,
              105,
              76,
              113,
              105,
              52,
              99,
              75,
              88,
              55,
              115,
              105,
              110,
              105,
              65,
              103,
              75,
              118,
              107,
              111,
              101,
              107,
              51,
              48,
              69,
              70,
              99,
              71,
              100,
              104,
              116,
              115,
              109,
              107,
              72,
              119,
              34,
              44,
              34,
              116,
              111,
              107,
              101,
              110,
              95,
              116,
              121,
              112,
              101,
              34,
              58,
              34,
              66,
              101,
              97,
              114,
              101,
              114,
              34,
              44,
              34,
              110,
              111,
              116,
              45,
              98,
              101,
              102,
              111,
              114,
              101,
              45,
              112,
              111,
              108,
              105,
              99,
              121,
              34,
              58,
              48,
              44,
              34,
              115,
              101,
              115,
              115,
              105,
              111,
              110,
              95,
              115,
              116,
              97,
              116,
              101,
              34,
              58,
              34,
              100,
              57,
              52,
              48,
              54,
              49,
              52,
              102,
              45,
              50,
              51,
              52,
              97,
              45,
              50,
              102,
              51,
              52,
              45,
              99,
              102,
              101,
              53,
              45,
              49,
              52,
              49,
              101,
              99,
              49,
              50,
              101,
              56,
              57,
              54,
              48,
              34,
              44,
              34,
              115,
              99,
              111,
              112,
              101,
              34,
              58,
              34,
              112,
              114,
              111,
              102,
              105,
              108,
              101,
              32,
              101,
              109,
              97,
              105,
              108,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 34,
          "responseSize": 2465
        },
        "id": "6a55bf83-4a2c-4e0e-b2fa-dadc7f9d3d72",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7"
        },
        "item": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "consolidar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjMxYWRmNDg3LWU5NWYtMzA3Mi1jNTdlLTI3YzI3NjBmOWUwNiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzkzYjYzMDktZDE4ZC00M2VkLWJiNzQtYWI1NTgxMjIxYTQyIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImY0NGIyMTIzLWE3ZTktZWZmOC1kMWJjLWI5OGZhYzI0ZjliZCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIm9mZmxpbmVfYWNjZXNzIiwiT1BFUkFET1IiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInRlbmFudF9pZCI6ImEwZWViYzk5LTljMGItNGVmOC1iYjZkLTZiYjliZDM4MGExMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLWpldHNraS1zYWFzIiwib2ZmbGluZV9hY2Nlc3MiLCJPUEVSQURPUiIsInVtYV9hdXRob3JpemF0aW9uIl0sIm5hbWUiOiJPcGVyYWRvciBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvcGVyYWRvckBhY21lLmNvbSIsImdpdmVuX25hbWUiOiJPcGVyYWRvciIsImZhbWlseV9uYW1lIjoiQUNNRSIsImVtYWlsIjoib3BlcmFkb3JAYWNtZS5jb20ifQ.QLbo3TqQCEgXnqIUwsWltJc3yREauRyZDT_o9aKjWA4N6DTZTXiAg-TPfw4Webzk2muK6l597VmbIPnubHwn02t2gTmKkd-2CBcKEwGdZTErY0Dh12hLd-X1zyJ6FC5YotBwQRt6x3H92idRgZYEUi0y3n2ebtOkXhEYMUoaqmG0ovwvKEAv0qbeXV90eRxd4CSr2MN19ztR2QjWgnFLXZ7Fgr1-0bAtsNqhckG6Xsfs7njHllqA3biDIDDeiWUCBZyKEgv0BzDocLd0fZ3-nFD3Ms9IGRyOcRhJnU05jo6S4Vvxl1aBGfYZlH6-UbC0YUM3TWTFlBZiFSWYuk2MUg"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "d0e95433-d92e-4255-a36f-a5687f1b0163",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "93",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"dtReferencia\": \"2025-11-05\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
          }
        },
        "response": {
          "id": "f8bb017c-9f3e-430d-a480-21c13d605404",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "2aaaf66c-d413-4611-9a49-18bf607e625a"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              48,
              51,
              54,
              54,
              56,
              55,
              54,
              52,
              56,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              99,
              111,
              110,
              115,
              111,
              108,
              105,
              100,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              99,
              111,
              110,
              115,
              111,
              108,
              105,
              100,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 568,
          "responseSize": 204
        },
        "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 403",
              "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:4)"
            }
          },
          {
            "assertion": "Resposta √© JSON v√°lido",
            "skipped": false
          },
          {
            "assertion": "Possui ID do fechamento",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Possui ID do fechamento",
              "message": "expected { ‚Ä¶(5) } to have property 'id'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:3:4)"
            }
          },
          {
            "assertion": "Status inicial √© \"aberto\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Status inicial √© \"aberto\"",
              "message": "expected 403 to deeply equal 'aberto'",
              "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:4:4)"
            }
          },
          {
            "assertion": "N√£o est√° bloqueado inicialmente",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "N√£o est√° bloqueado inicialmente",
              "message": "expected undefined to be false",
              "stack": "AssertionError: expected undefined to be false\n   at Object.eval sandbox-script.js:5:4)"
            }
          },
          {
            "assertion": "Data de refer√™ncia corresponde ao enviado",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 5,
              "test": "Data de refer√™ncia corresponde ao enviado",
              "message": "expected undefined to deeply equal '2025-11-05'",
              "stack": "AssertionError: expected undefined to deeply equal '2025-11-05'\n   at Object.eval sandbox-script.js:6:4)"
            }
          },
          {
            "assertion": "Totais financeiros s√£o n√∫meros v√°lidos",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 6,
              "test": "Totais financeiros s√£o n√∫meros v√°lidos",
              "message": "expected undefined to be a number",
              "stack": "AssertionError: expected undefined to be a number\n   at Object.eval sandbox-script.js:7:4)"
            }
          },
          {
            "assertion": "Possui breakdown por forma de pagamento",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 7,
              "test": "Possui breakdown por forma de pagamento",
              "message": "expected { ‚Ä¶(5) } to have property 'totalDinheiro'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalDinheiro'\n   at Object.eval sandbox-script.js:8:4)"
            }
          },
          {
            "assertion": "Total faturado = soma das formas de pagamento",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 8,
              "test": "Total faturado = soma das formas de pagamento",
              "message": "expected undefined to be a number",
              "stack": "AssertionError: expected undefined to be a number\n   at Object.eval sandbox-script.js:9:4)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "ad135c42-f682-459c-bfa8-50d62da50df2",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "352b0eae-468a-4ec7-8096-0c5b186b8d22"
        },
        "item": {
          "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjMxYWRmNDg3LWU5NWYtMzA3Mi1jNTdlLTI3YzI3NjBmOWUwNiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzkzYjYzMDktZDE4ZC00M2VkLWJiNzQtYWI1NTgxMjIxYTQyIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImY0NGIyMTIzLWE3ZTktZWZmOC1kMWJjLWI5OGZhYzI0ZjliZCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIm9mZmxpbmVfYWNjZXNzIiwiT1BFUkFET1IiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInRlbmFudF9pZCI6ImEwZWViYzk5LTljMGItNGVmOC1iYjZkLTZiYjliZDM4MGExMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLWpldHNraS1zYWFzIiwib2ZmbGluZV9hY2Nlc3MiLCJPUEVSQURPUiIsInVtYV9hdXRob3JpemF0aW9uIl0sIm5hbWUiOiJPcGVyYWRvciBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvcGVyYWRvckBhY21lLmNvbSIsImdpdmVuX25hbWUiOiJPcGVyYWRvciIsImZhbWlseV9uYW1lIjoiQUNNRSIsImVtYWlsIjoib3BlcmFkb3JAYWNtZS5jb20ifQ.QLbo3TqQCEgXnqIUwsWltJc3yREauRyZDT_o9aKjWA4N6DTZTXiAg-TPfw4Webzk2muK6l597VmbIPnubHwn02t2gTmKkd-2CBcKEwGdZTErY0Dh12hLd-X1zyJ6FC5YotBwQRt6x3H92idRgZYEUi0y3n2ebtOkXhEYMUoaqmG0ovwvKEAv0qbeXV90eRxd4CSr2MN19ztR2QjWgnFLXZ7Fgr1-0bAtsNqhckG6Xsfs7njHllqA3biDIDDeiWUCBZyKEgv0BzDocLd0fZ3-nFD3Ms9IGRyOcRhJnU05jo6S4Vvxl1aBGfYZlH6-UbC0YUM3TWTFlBZiFSWYuk2MUg"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "662e9201-2200-44f6-9c36-886691bdbcdf",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "67eb507c-3710-42e8-9cc6-c2f03e9403c6",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "fd0ae924-c812-43b8-b2ac-0d24b17e5ed4"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              49,
              49,
              56,
              52,
              55,
              52,
              57,
              51,
              56,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              108,
              105,
              115,
              116,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 41,
          "responseSize": 192
        },
        "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:5)"
            }
          },
          {
            "assertion": "ID corresponde ao criado",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "ID corresponde ao criado",
              "message": "expected undefined to deeply equal null",
              "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:2:5)"
            }
          },
          {
            "assertion": "Possui operador respons√°vel",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Possui operador respons√°vel",
              "message": "expected { ‚Ä¶(5) } to have property 'operadorId'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'operadorId'\n   at Object.eval sandbox-script.js:3:5)"
            }
          },
          {
            "assertion": "Timestamps de auditoria presentes",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Timestamps de auditoria presentes",
              "message": "expected { ‚Ä¶(5) } to have property 'createdAt'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'createdAt'\n   at Object.eval sandbox-script.js:4:5)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "2012d740-41fe-4a79-8477-2a83ba714d97",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "e9108208-1c4e-417b-8fa4-c0b3e8b52d22"
        },
        "item": {
          "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjMxYWRmNDg3LWU5NWYtMzA3Mi1jNTdlLTI3YzI3NjBmOWUwNiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzkzYjYzMDktZDE4ZC00M2VkLWJiNzQtYWI1NTgxMjIxYTQyIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImY0NGIyMTIzLWE3ZTktZWZmOC1kMWJjLWI5OGZhYzI0ZjliZCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIm9mZmxpbmVfYWNjZXNzIiwiT1BFUkFET1IiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInRlbmFudF9pZCI6ImEwZWViYzk5LTljMGItNGVmOC1iYjZkLTZiYjliZDM4MGExMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLWpldHNraS1zYWFzIiwib2ZmbGluZV9hY2Nlc3MiLCJPUEVSQURPUiIsInVtYV9hdXRob3JpemF0aW9uIl0sIm5hbWUiOiJPcGVyYWRvciBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvcGVyYWRvckBhY21lLmNvbSIsImdpdmVuX25hbWUiOiJPcGVyYWRvciIsImZhbWlseV9uYW1lIjoiQUNNRSIsImVtYWlsIjoib3BlcmFkb3JAYWNtZS5jb20ifQ.QLbo3TqQCEgXnqIUwsWltJc3yREauRyZDT_o9aKjWA4N6DTZTXiAg-TPfw4Webzk2muK6l597VmbIPnubHwn02t2gTmKkd-2CBcKEwGdZTErY0Dh12hLd-X1zyJ6FC5YotBwQRt6x3H92idRgZYEUi0y3n2ebtOkXhEYMUoaqmG0ovwvKEAv0qbeXV90eRxd4CSr2MN19ztR2QjWgnFLXZ7Fgr1-0bAtsNqhckG6Xsfs7njHllqA3biDIDDeiWUCBZyKEgv0BzDocLd0fZ3-nFD3Ms9IGRyOcRhJnU05jo6S4Vvxl1aBGfYZlH6-UbC0YUM3TWTFlBZiFSWYuk2MUg"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "c8225403-38ae-4da1-9fe4-1f00082255b0",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "bc8bf004-f7f2-433c-b4f5-1e3f9156c8bd",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "b98b55c0-b88f-4158-b708-d07e28e95a31"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              49,
              54,
              55,
              52,
              57,
              51,
              49,
              51,
              51,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              102,
              101,
              99,
              104,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              47,
              102,
              101,
              99,
              104,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 17,
          "responseSize": 201
        },
        "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:6)"
            }
          },
          {
            "assertion": "Status mudou para \"fechado\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Status mudou para \"fechado\"",
              "message": "expected 403 to deeply equal 'fechado'",
              "stack": "AssertionError: expected 403 to deeply equal 'fechado'\n   at Object.eval sandbox-script.js:2:6)"
            }
          },
          {
            "assertion": "Agora est√° bloqueado (RN06)",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Agora est√° bloqueado (RN06)",
              "message": "expected undefined to be true",
              "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:3:6)"
            }
          },
          {
            "assertion": "Possui data de fechamento",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Possui data de fechamento",
              "message": "expected { ‚Ä¶(5) } to have property 'dtFechamento'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'dtFechamento'\n   at Object.eval sandbox-script.js:4:6)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "97240eb1-a88d-4b5c-918a-e4e0c6a39646",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "65b66902-a048-46c8-8919-a52687fa5741"
        },
        "item": {
          "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null",
              "reabrir"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "6339cc1d-2928-43ba-b267-77d10bcb1650",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "8cfaeb4b-242d-4472-b95b-904bebaff4da",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "0c6aa70b-b288-45f3-94d7-a6df19327f3c"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              50,
              50,
              50,
              50,
              50,
              57,
              52,
              50,
              54,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              99,
              114,
              101,
              97,
              116,
              101,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              47,
              114,
              101,
              97,
              98,
              114,
              105,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 29,
          "responseSize": 202
        },
        "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:7)"
            }
          },
          {
            "assertion": "Status voltou para \"aberto\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Status voltou para \"aberto\"",
              "message": "expected 403 to deeply equal 'aberto'",
              "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:2:7)"
            }
          },
          {
            "assertion": "Bloqueio foi removido",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Bloqueio foi removido",
              "message": "expected undefined to be false",
              "stack": "AssertionError: expected undefined to be false\n   at Object.eval sandbox-script.js:3:7)"
            }
          },
          {
            "assertion": "Data de fechamento foi limpa",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Data de fechamento foi limpa",
              "message": "expected undefined to be null",
              "stack": "AssertionError: expected undefined to be null\n   at Object.eval sandbox-script.js:4:7)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "fbac2e82-1af6-4297-a6b1-563dda849bf7",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "632de613-73c6-4fe4-9da2-c31d160e93fa"
        },
        "item": {
          "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjMxYWRmNDg3LWU5NWYtMzA3Mi1jNTdlLTI3YzI3NjBmOWUwNiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzkzYjYzMDktZDE4ZC00M2VkLWJiNzQtYWI1NTgxMjIxYTQyIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImY0NGIyMTIzLWE3ZTktZWZmOC1kMWJjLWI5OGZhYzI0ZjliZCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIm9mZmxpbmVfYWNjZXNzIiwiT1BFUkFET1IiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInRlbmFudF9pZCI6ImEwZWViYzk5LTljMGItNGVmOC1iYjZkLTZiYjliZDM4MGExMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLWpldHNraS1zYWFzIiwib2ZmbGluZV9hY2Nlc3MiLCJPUEVSQURPUiIsInVtYV9hdXRob3JpemF0aW9uIl0sIm5hbWUiOiJPcGVyYWRvciBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvcGVyYWRvckBhY21lLmNvbSIsImdpdmVuX25hbWUiOiJPcGVyYWRvciIsImZhbWlseV9uYW1lIjoiQUNNRSIsImVtYWlsIjoib3BlcmFkb3JAYWNtZS5jb20ifQ.QLbo3TqQCEgXnqIUwsWltJc3yREauRyZDT_o9aKjWA4N6DTZTXiAg-TPfw4Webzk2muK6l597VmbIPnubHwn02t2gTmKkd-2CBcKEwGdZTErY0Dh12hLd-X1zyJ6FC5YotBwQRt6x3H92idRgZYEUi0y3n2ebtOkXhEYMUoaqmG0ovwvKEAv0qbeXV90eRxd4CSr2MN19ztR2QjWgnFLXZ7Fgr1-0bAtsNqhckG6Xsfs7njHllqA3biDIDDeiWUCBZyKEgv0BzDocLd0fZ3-nFD3Ms9IGRyOcRhJnU05jo6S4Vvxl1aBGfYZlH6-UbC0YUM3TWTFlBZiFSWYuk2MUg"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "b36cc142-4daf-4b34-9d2a-c23859309925",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "73cfd4d3-79fb-48bb-b311-9f690d50cd98",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "d798e06a-6386-455c-bf4d-cb79969f3974"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              50,
              54,
              51,
              53,
              55,
              55,
              48,
              50,
              49,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              102,
              101,
              99,
              104,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              47,
              102,
              101,
              99,
              104,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 16,
          "responseSize": 201
        },
        "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:8)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "name": "AssertionError",
              "message": "expected 403 to deeply equal 'fechado'",
              "showDiff": true,
              "actual": 403,
              "expected": "fechado",
              "operator": "strictEqual",
              "stack": "Error: expected 403 to deeply equal 'fechado'\n    at Object.eval (eval at exec (evalmachine.<anonymous>:66:1819788), <anonymous>:9:27)\n    at u.exec (evalmachine.<anonymous>:66:1819823)\n    at t.exports (evalmachine.<anonymous>:66:5848)\n    at Object.<anonymous> (evalmachine.<anonymous>:66:8247)\n    at evalmachine.<anonymous>:15:26\n    at Array.forEach (<anonymous>)\n    at Object.emit (evalmachine.<anonymous>:14:59)\n    at evalmachine.<anonymous>:59:24\n    at evalmachine.<anonymous>:5:21\n    at evalmachine.<anonymous>:6:18",
              "checksum": "14a2fec899e45831cd15677bfb57fe31",
              "id": "4a12d4fa-df2d-4467-a26b-4a884a4ce1c7",
              "timestamp": 1762330445277,
              "stacktrace": [
                {
                  "fileName": "<anonymous>",
                  "lineNumber": 9,
                  "functionName": "Object.eval (eval at exec (evalmachine.<anonymous>:66:1819788),",
                  "typeName": "Object",
                  "methodName": "eval (eval at exec (evalmachine.<anonymous>:66:1819788),",
                  "columnNumber": 27,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 66,
                  "functionName": "u.exec",
                  "typeName": "u",
                  "methodName": "exec",
                  "columnNumber": 1819823,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 66,
                  "functionName": "t.exports",
                  "typeName": "t",
                  "methodName": "exports",
                  "columnNumber": 5848,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 66,
                  "functionName": "",
                  "typeName": "Object",
                  "methodName": null,
                  "columnNumber": 8247,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 15,
                  "functionName": null,
                  "typeName": null,
                  "methodName": null,
                  "columnNumber": 26,
                  "native": false
                },
                {
                  "fileName": null,
                  "lineNumber": null,
                  "functionName": "Array.forEach",
                  "typeName": "Array",
                  "methodName": "forEach",
                  "columnNumber": null,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 14,
                  "functionName": "Object.emit",
                  "typeName": "Object",
                  "methodName": "emit",
                  "columnNumber": 59,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 59,
                  "functionName": null,
                  "typeName": null,
                  "methodName": null,
                  "columnNumber": 24,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 5,
                  "functionName": null,
                  "typeName": null,
                  "methodName": null,
                  "columnNumber": 21,
                  "native": false
                },
                {
                  "fileName": "evalmachine.<anonymous>",
                  "lineNumber": 6,
                  "functionName": null,
                  "typeName": null,
                  "methodName": null,
                  "columnNumber": 18,
                  "native": false
                }
              ]
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "7da95e92-75f6-4e10-b090-6c52c03034c2",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "3669723e-4f2d-4703-9d7e-8e8e950ea73c"
        },
        "item": {
          "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "af8a1410-8643-4e87-a18d-b6dcee6be101",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "5a915cc3-dc54-46aa-86b7-22581420b88c",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "a9614ca3-dbb7-4892-ac5c-59909a076588"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              51,
              48,
              52,
              50,
              54,
              56,
              56,
              49,
              55,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              47,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 16,
          "responseSize": 203
        },
        "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:9)"
            }
          },
          {
            "assertion": "Status final √© \"aprovado\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Status final √© \"aprovado\"",
              "message": "expected 403 to deeply equal 'aprovado'",
              "stack": "AssertionError: expected 403 to deeply equal 'aprovado'\n   at Object.eval sandbox-script.js:2:9)"
            }
          },
          {
            "assertion": "Permanece bloqueado (imut√°vel RN06)",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Permanece bloqueado (imut√°vel RN06)",
              "message": "expected undefined to be true",
              "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:3:9)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "e90273f4-aabe-4897-ad9a-891daaf2f924",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "f004f434-0352-4445-915c-1b058c517a78"
        },
        "item": {
          "id": "1090e477-250f-4a06-b728-129231fcca7c",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "null",
              "reabrir"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "fdb4bf66-2f54-4772-8b69-5b74c6da1810",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "7a005751-a277-40bb-944d-60e8de0909b0",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "296b26f8-0620-4559-8715-853e436eb1a0"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              51,
              52,
              53,
              54,
              56,
              49,
              54,
              49,
              50,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              99,
              114,
              101,
              97,
              116,
              101,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              100,
              105,
              97,
              47,
              110,
              117,
              108,
              108,
              47,
              114,
              101,
              97,
              98,
              114,
              105,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 15,
          "responseSize": 202
        },
        "id": "1090e477-250f-4a06-b728-129231fcca7c",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 400 Bad Request",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 400 Bad Request",
              "message": "expected response to have status code 400 but got 403",
              "stack": "AssertionError: expected response to have status code 400 but got 403\n   at Object.eval sandbox-script.js:1:10)"
            }
          },
          {
            "assertion": "Mensagem de erro apropriada",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Mensagem de erro apropriada",
              "message": "expected 'Acesso negado para a√ß√£o \\'fechamento:‚Ä¶' to include 'aprovado'",
              "stack": "AssertionError: expected 'Acesso negado para a√ß√£o \\'fechamento:‚Ä¶' to include 'aprovado'\n   at Object.eval sandbox-script.js:2:10)"
            }
          },
          {
            "assertion": "Tipo de erro √© BusinessException",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Tipo de erro √© BusinessException",
              "message": "expected 'Forbidden' to include 'Business'",
              "stack": "AssertionError: expected 'Forbidden' to include 'Business'\n   at Object.eval sandbox-script.js:3:10)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31"
        },
        "item": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "politicas-comissao"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "9834a60c-5815-433c-9e6d-6a6d47c21c16",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "211",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"33333333-3333-3333-3333-333333333333\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
          }
        },
        "response": {
          "id": "0a18c8c8-837e-4908-8e82-625683f38a2a",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "2618b4cd-2a0b-4696-9cb9-0e5efb490690"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              51,
              56,
              54,
              56,
              51,
              51,
              52,
              48,
              55,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              112,
              111,
              108,
              105,
              116,
              105,
              99,
              97,
              115,
              45,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              99,
              114,
              101,
              97,
              116,
              101,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              112,
              111,
              108,
              105,
              116,
              105,
              99,
              97,
              115,
              45,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 15,
          "responseSize": 201
        },
        "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 403",
              "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:11)"
            }
          },
          {
            "assertion": "Possui ID da pol√≠tica",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Possui ID da pol√≠tica",
              "message": "expected { ‚Ä¶(5) } to have property 'id'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:2:11)"
            }
          },
          {
            "assertion": "N√≠vel √© MODELO (hierarquia RN04)",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "N√≠vel √© MODELO (hierarquia RN04)",
              "message": "expected undefined to deeply equal 'MODELO'",
              "stack": "AssertionError: expected undefined to deeply equal 'MODELO'\n   at Object.eval sandbox-script.js:3:11)"
            }
          },
          {
            "assertion": "Tipo √© PERCENTUAL",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Tipo √© PERCENTUAL",
              "message": "expected undefined to deeply equal 'PERCENTUAL'",
              "stack": "AssertionError: expected undefined to deeply equal 'PERCENTUAL'\n   at Object.eval sandbox-script.js:4:11)"
            }
          },
          {
            "assertion": "Percentual configurado corretamente",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "Percentual configurado corretamente",
              "message": "expected undefined to deeply equal 12",
              "stack": "AssertionError: expected undefined to deeply equal 12\n   at Object.eval sandbox-script.js:5:11)"
            }
          },
          {
            "assertion": "Pol√≠tica est√° ativa",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 5,
              "test": "Pol√≠tica est√° ativa",
              "message": "expected undefined to be true",
              "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:6:11)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "cf2c6e69-f293-4a26-8918-0eac6c9dbe16",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "5d052f81-5727-4bae-94b3-e3c06e41a6b4"
        },
        "item": {
          "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "politicas-comissao"
            ],
            "host": [
              "localhost"
            ],
            "query": [
              {
                "key": "ativo",
                "value": "true"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "9b3c12b3-e350-4f63-9131-a68584966aa8",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "adafccfd-297f-4ac6-aa00-1cd6cb8cfb4d",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "284a9342-38c1-423d-a13c-18f97ea82726"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              52,
              50,
              57,
              54,
              48,
              51,
              56,
              48,
              50,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              112,
              111,
              108,
              105,
              116,
              105,
              99,
              97,
              115,
              45,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              108,
              105,
              115,
              116,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              112,
              111,
              108,
              105,
              116,
              105,
              99,
              97,
              115,
              45,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 15,
          "responseSize": 199
        },
        "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:12)"
            }
          },
          {
            "assertion": "Resposta √© array",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Resposta √© array",
              "message": "expected { ‚Ä¶(5) } to be an array",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:12)"
            }
          },
          {
            "assertion": "Cont√©m a pol√≠tica rec√©m-criada",
            "skipped": false,
            "error": {
              "name": "TypeError",
              "index": 2,
              "test": "Cont√©m a pol√≠tica rec√©m-criada",
              "message": "json.find is not a function",
              "stack": "TypeError: json.find is not a function\n   at Object.eval sandbox-script.js:3:12)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "84c87120-1961-4a96-8381-119652b2a988",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "4d96ff8c-3ace-4f88-83b3-8e0cf6d3c1e4"
        },
        "item": {
          "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "pendentes"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "36270c89-8208-47a0-a12a-7b89bda03159",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "df2c4bb2-449c-4462-b716-a1a73a0e2f52",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "c75c9d08-6e52-48e1-a312-932f8ad6ad07"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              52,
              55,
              49,
              52,
              56,
              53,
              57,
              57,
              55,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              108,
              105,
              115,
              116,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              99,
              111,
              109,
              105,
              115,
              115,
              111,
              101,
              115,
              47,
              112,
              101,
              110,
              100,
              101,
              110,
              116,
              101,
              115,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 18,
          "responseSize": 190
        },
        "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:13)"
            }
          },
          {
            "assertion": "Resposta √© array de comiss√µes",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Resposta √© array de comiss√µes",
              "message": "expected { ‚Ä¶(5) } to be an array",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:13)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "d4391c7f-a3dc-4028-aa74-4513de2ef7e3",
          "length": 19,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "f3aa375e-e4d2-433c-846a-da2c7286a747"
        },
        "item": {
          "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
          "name": "2.4 Aprovar Comiss√£o (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "{{comissao_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                "type": "text/javascript",
                "exec": [
                  "const comissaoId = pm.environment.get('comissao_id');",
                  "",
                  "if (!comissaoId) {",
                  "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                  "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para APROVADA', function() {",
                  "    pm.expect(json.status).to.eql('APROVADA');",
                  "});",
                  "",
                  "pm.test('Valores permanecem inalterados', function() {",
                  "    pm.expect(json).to.have.property('valorComissao');",
                  "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                  "});",
                  "",
                  "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                ],
                "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "%7B%7Bcomissao_id%7D%7D",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "01f7e172-5458-49ca-8750-459c44c18b09",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "60",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
          }
        },
        "response": {
          "id": "91145496-f5cb-4574-995d-5115c32cc7b7",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "36cf6b47-ddb3-4043-9ff2-ff0b5adc1702"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              53,
              49,
              49,
              56,
              53,
              49,
              48,
              57,
              50,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              99,
              111,
              109,
              105,
              115,
              115,
              111,
              101,
              115,
              47,
              37,
              55,
              66,
              37,
              55,
              66,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              95,
              105,
              100,
              37,
              55,
              68,
              37,
              55,
              68,
              47,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 16,
          "responseSize": 215
        },
        "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Sem comiss√µes dispon√≠veis",
            "skipped": true
          }
        ]
      },
      {
        "cursor": {
          "ref": "d48387b3-249f-4749-9188-e4a834c2e48c",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "b849d67e-0350-4902-a605-ee22fc4fe741"
        },
        "item": {
          "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "aguardando-pagamento"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjRiYmMxNzVlLWE5MzItYTcyYS03ZTAwLTdmNTI2NmY5MWRhMiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImQ5NDA2MTRmLTIzNGEtMmYzNC1jZmU1LTE0MWVjMTJlODk2MCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.omf1wttCTNiJh8TZBwaTK6DP25GAKfvgQQd72kOeTtCdNYoYDzJ2gygAChAI95frq6tCy7-meZsE3GtJ4M-FpaKe_-NYxto6Wf9gb-tAE9dH8f_fDZ45do4KGUhbTvIPyzeUicT3TqZGzB2nV3fUkJC82WAk_NbmYXlp6CqNCJveZnf1LIfXjil4K7_sXa4HyPPwqDwxPYTgjz8RP56IYUg3PZqP9FbeY9iEKNr9XrR1SOGCsGiLY_5MN1ezNHnefQzTvwtWBsMxgZHu7pPGKdwBcG_t6w5m9FVsKnswCe8Izc1JiApel-NqF4ojyJuaI7PKWXpYAkeTuErRnIKCDQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "1645988b-361f-4903-bffb-2088eb91c9a3",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "5d849011-d1d1-4b91-aa1e-c3538b2663e0",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "e12bf382-a3cf-4377-b16a-b1fd70d16812"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              53,
              53,
              50,
              48,
              57,
              54,
              56,
              56,
              55,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              108,
              105,
              115,
              116,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              99,
              111,
              109,
              105,
              115,
              115,
              111,
              101,
              115,
              47,
              97,
              103,
              117,
              97,
              114,
              100,
              97,
              110,
              100,
              111,
              45,
              112,
              97,
              103,
              97,
              109,
              101,
              110,
              116,
              111,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 15,
          "responseSize": 201
        },
        "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:15)"
            }
          },
          {
            "assertion": "Resposta √© array",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Resposta √© array",
              "message": "expected { ‚Ä¶(5) } to be an array",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:15)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "0d8e5c31-5d12-4b35-98f3-fc3b3e5d4574",
          "length": 19,
          "cycles": 1,
          "position": 15,
          "iteration": 0,
          "httpRequestId": "252b3b25-f6df-449a-93d9-5cada2fc2959"
        },
        "item": {
          "id": "5f116071-06b9-4553-babb-471cbf605103",
          "name": "2.6 Pagar Comiss√£o (Financeiro)",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "{{comissao_id}}",
                "pagar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                "type": "text/javascript",
                "exec": [
                  "const comissaoId = pm.environment.get('comissao_id');",
                  "",
                  "if (!comissaoId) {",
                  "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                  "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© PAGA', function() {",
                  "    pm.expect(json.status).to.eql('PAGA');",
                  "});",
                  "",
                  "pm.test('Possui data de pagamento', function() {",
                  "    pm.expect(json).to.have.property('dataPagamento');",
                  "    pm.expect(json.dataPagamento).to.not.be.null;",
                  "});",
                  "",
                  "pm.test('M√©todo de pagamento registrado', function() {",
                  "    pm.expect(json).to.have.property('metodoPagamento');",
                  "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                  "});",
                  "",
                  "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                ],
                "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "%7B%7Bcomissao_id%7D%7D",
              "pagar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOjRiYmMxNzVlLWE5MzItYTcyYS03ZTAwLTdmNTI2NmY5MWRhMiIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImQ5NDA2MTRmLTIzNGEtMmYzNC1jZmU1LTE0MWVjMTJlODk2MCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.omf1wttCTNiJh8TZBwaTK6DP25GAKfvgQQd72kOeTtCdNYoYDzJ2gygAChAI95frq6tCy7-meZsE3GtJ4M-FpaKe_-NYxto6Wf9gb-tAE9dH8f_fDZ45do4KGUhbTvIPyzeUicT3TqZGzB2nV3fUkJC82WAk_NbmYXlp6CqNCJveZnf1LIfXjil4K7_sXa4HyPPwqDwxPYTgjz8RP56IYUg3PZqP9FbeY9iEKNr9XrR1SOGCsGiLY_5MN1ezNHnefQzTvwtWBsMxgZHu7pPGKdwBcG_t6w5m9FVsKnswCe8Izc1JiApel-NqF4ojyJuaI7PKWXpYAkeTuErRnIKCDQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "a322998a-ec38-4086-9ef7-9ddbd1851d53",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "196",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"dataPagamento\": \"2025-11-05T08:14:05.577Z\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
          }
        },
        "response": {
          "id": "f0847565-9c17-414e-a368-709e50022942",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "1f41f455-c117-43e3-a19d-6bc0659e2804"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              53,
              57,
              51,
              57,
              53,
              57,
              56,
              56,
              50,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              58,
              99,
              114,
              101,
              97,
              116,
              101,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              99,
              111,
              109,
              105,
              115,
              115,
              111,
              101,
              115,
              47,
              37,
              55,
              66,
              37,
              55,
              66,
              99,
              111,
              109,
              105,
              115,
              115,
              97,
              111,
              95,
              105,
              100,
              37,
              55,
              68,
              37,
              55,
              68,
              47,
              112,
              97,
              103,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 16,
          "responseSize": 212
        },
        "id": "5f116071-06b9-4553-babb-471cbf605103",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Sem comiss√µes dispon√≠veis",
            "skipped": true
          }
        ]
      },
      {
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913"
        },
        "item": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "consolidar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "46d19313-bdfe-4d36-a570-861c75110762",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "80",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"mes\": 11,\n  \"ano\": 2025,\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
          }
        },
        "response": {
          "id": "84233436-4f37-4eca-9835-d2be9467af1d",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "13bc65fd-4ae2-455f-b3a2-35c6e667c13b"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              54,
              51,
              57,
              48,
              57,
              57,
              51,
              55,
              55,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              99,
              111,
              110,
              115,
              111,
              108,
              105,
              100,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              109,
              101,
              115,
              47,
              99,
              111,
              110,
              115,
              111,
              108,
              105,
              100,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 17,
          "responseSize": 204
        },
        "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 403",
              "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:17)"
            }
          },
          {
            "assertion": "Possui ID do fechamento mensal",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Possui ID do fechamento mensal",
              "message": "expected { ‚Ä¶(5) } to have property 'id'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:2:17)"
            }
          },
          {
            "assertion": "M√™s e ano corretos",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "M√™s e ano corretos",
              "message": "expected undefined to deeply equal 11",
              "stack": "AssertionError: expected undefined to deeply equal 11\n   at Object.eval sandbox-script.js:3:17)"
            }
          },
          {
            "assertion": "Status inicial √© \"aberto\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "Status inicial √© \"aberto\"",
              "message": "expected 403 to deeply equal 'aberto'",
              "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:4:17)"
            }
          },
          {
            "assertion": "Possui totais consolidados",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "Possui totais consolidados",
              "message": "expected { ‚Ä¶(5) } to have property 'totalReceita'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalReceita'\n   at Object.eval sandbox-script.js:5:17)"
            }
          },
          {
            "assertion": "Possui breakdown de comiss√µes",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 5,
              "test": "Possui breakdown de comiss√µes",
              "message": "expected { ‚Ä¶(5) } to have property 'totalComissoesPendentes'",
              "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalComissoesPendentes'\n   at Object.eval sandbox-script.js:6:17)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "dbe18b5b-bbe1-4bc2-81ca-003dc8815eb3",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "8e2dc23f-5577-4a0b-9b61-61b0cf7bc2d1"
        },
        "item": {
          "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "b19152e6-6334-437c-82ed-812952bad509",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "null",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "b610e786-6f65-48b5-b5af-45c728de166a",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "10dd866e-35be-4461-8111-6315af7c5fa8",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "5f86d401-96ee-49d7-92d3-d1ade84c1c84"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              54,
              55,
              56,
              53,
              57,
              55,
              50,
              55,
              50,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              102,
              101,
              99,
              104,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              109,
              101,
              115,
              47,
              110,
              117,
              108,
              108,
              47,
              102,
              101,
              99,
              104,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 13,
          "responseSize": 201
        },
        "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:18)"
            }
          },
          {
            "assertion": "Status mudou para \"fechado\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Status mudou para \"fechado\"",
              "message": "expected 403 to deeply equal 'fechado'",
              "stack": "AssertionError: expected 403 to deeply equal 'fechado'\n   at Object.eval sandbox-script.js:2:18)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "77875ef6-d930-4fb9-8aec-e3e1748d83b9",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "0c263982-ca69-4c76-a3b4-14c3106455a6"
        },
        "item": {
          "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "null",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJER09wTVlzU19udmJLY0o4dFhGM05qYkVpV2FGQ25kQ1pnTk1IbXZPd3JnIn0.eyJleHAiOjE3NjIzMzEwNDQsImlhdCI6MTc2MjMzMDQ0NCwianRpIjoib25ydHJvOmFhY2FhNzc4LTU1ZGItYTExYy1lZDY2LTNjYjFlZjg3NWFkOSIsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9yZWFsbXMvamV0c2tpLXNhYXMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYTI2MzAwYWUtNjNiZS00YTNjLWEzYTAtZDk5NmRkMTNlYzRkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiamV0c2tpLWFwaSIsInNpZCI6ImEzOWNjYzYyLWZkYTItNDkxNy05OWM3LTcyODVlNDZhY2YyMCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1qZXRza2ktc2FhcyIsIkdFUkVOVEUiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwidGVuYW50X2lkIjoiYTBlZWJjOTktOWMwYi00ZWY4LWJiNmQtNmJiOWJkMzgwYTExIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInJvbGVzIjpbImRlZmF1bHQtcm9sZXMtamV0c2tpLXNhYXMiLCJHRVJFTlRFIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdLCJuYW1lIjoiR2VyZW50ZSBBQ01FIiwiZ2xvYmFsX3JvbGVzIjpbInRlbmFudC1hY21lIl0sImdyb3VwcyI6WyJ0ZW5hbnQtYWNtZSJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJnZXJlbnRlQGFjbWUuY29tIiwiZ2l2ZW5fbmFtZSI6IkdlcmVudGUiLCJmYW1pbHlfbmFtZSI6IkFDTUUiLCJlbWFpbCI6ImdlcmVudGVAYWNtZS5jb20ifQ.DwMQrnzYGOmyJX0ANd9ICfZ1JlbZWH7WOYp-HlJpD1M0ynZK1x7346NRbrVpMM1Uv-LWmS6clgN8ARDOk_lOd7cjWiNn00GyuMv_xgoFVmoPQN9DA7rXCoLyYSY4SwyTI7KYBbLhGUgUhgLbXZ9Bn_SR4u-_lp0ph0AM8vemiABGx_6_QT6t1wTppdHZIQ4ZWQeP9oOJrFvz0FQLWxEAbU1lu3Ggl2J-PUdbvHcMwAwfeaJ_6WnpoSF-u39rZZOVSq1W8V3WPSkXtqnfRaLORjlCfp1SKRR6kcMK1cf0K1-45Q3168w40UMdZcDK7u2NlSaUzM-sLWaU32IEIOxSbQ"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "7227f58b-552a-4a75-b9ee-1c1e84e7ffa0",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "224679a0-a906-4c80-8575-09804685c3e5",
          "status": "Forbidden",
          "code": 403,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "X-Trace-Id",
              "value": "177ac992-1602-446d-950a-e9f63f8eb0ed"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Date",
              "value": "Wed, 05 Nov 2025 08:14:05 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              116,
              105,
              109,
              101,
              115,
              116,
              97,
              109,
              112,
              34,
              58,
              34,
              50,
              48,
              50,
              53,
              45,
              49,
              49,
              45,
              48,
              53,
              84,
              48,
              56,
              58,
              49,
              52,
              58,
              48,
              53,
              46,
              55,
              49,
              53,
              50,
              53,
              48,
              55,
              54,
              56,
              90,
              34,
              44,
              34,
              115,
              116,
              97,
              116,
              117,
              115,
              34,
              58,
              52,
              48,
              51,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              70,
              111,
              114,
              98,
              105,
              100,
              100,
              101,
              110,
              34,
              44,
              34,
              109,
              101,
              115,
              115,
              97,
              103,
              101,
              34,
              58,
              34,
              65,
              99,
              101,
              115,
              115,
              111,
              32,
              110,
              101,
              103,
              97,
              100,
              111,
              32,
              112,
              97,
              114,
              97,
              32,
              97,
              195,
              167,
              195,
              163,
              111,
              32,
              39,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              58,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              39,
              58,
              32,
              116,
              101,
              110,
              97,
              110,
              116,
              95,
              118,
              97,
              108,
              105,
              100,
              61,
              102,
              97,
              108,
              115,
              101,
              34,
              44,
              34,
              112,
              97,
              116,
              104,
              34,
              58,
              34,
              47,
              97,
              112,
              105,
              47,
              118,
              49,
              47,
              102,
              101,
              99,
              104,
              97,
              109,
              101,
              110,
              116,
              111,
              47,
              109,
              101,
              115,
              47,
              110,
              117,
              108,
              108,
              47,
              97,
              112,
              114,
              111,
              118,
              97,
              114,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 13,
          "responseSize": 203
        },
        "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 403",
              "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:19)"
            }
          },
          {
            "assertion": "Status final √© \"aprovado\"",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Status final √© \"aprovado\"",
              "message": "expected 403 to deeply equal 'aprovado'",
              "stack": "AssertionError: expected 403 to deeply equal 'aprovado'\n   at Object.eval sandbox-script.js:2:19)"
            }
          }
        ]
      }
    ],
    "transfers": {
      "responseTotal": 10634
    },
    "failures": [
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 403",
          "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:4)",
          "checksum": "851583f0cd2aaf25c60cde74ed8c3016",
          "id": "dea676d9-bded-4eaf-b645-d9ae6ce0a165",
          "timestamp": 1762330445059,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Possui ID do fechamento",
          "message": "expected { ‚Ä¶(5) } to have property 'id'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:3:4)",
          "checksum": "a081bac00afd8d88e0052ff0fb04ee7c",
          "id": "f57c35f8-261b-4691-8c7a-e574c9673275",
          "timestamp": 1762330445063,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Status inicial √© \"aberto\"",
          "message": "expected 403 to deeply equal 'aberto'",
          "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:4:4)",
          "checksum": "a265ebf55640dd7a6c83b14e538c3d09",
          "id": "fed963a4-172b-45ab-9ff3-47675aec45ab",
          "timestamp": 1762330445064,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "N√£o est√° bloqueado inicialmente",
          "message": "expected undefined to be false",
          "stack": "AssertionError: expected undefined to be false\n   at Object.eval sandbox-script.js:5:4)",
          "checksum": "25594c4b00b6e83f05ef36ffd1458999",
          "id": "708352eb-3a4e-4bdd-b089-c262d6025c76",
          "timestamp": 1762330445064,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 5,
          "test": "Data de refer√™ncia corresponde ao enviado",
          "message": "expected undefined to deeply equal '2025-11-05'",
          "stack": "AssertionError: expected undefined to deeply equal '2025-11-05'\n   at Object.eval sandbox-script.js:6:4)",
          "checksum": "70cb87248a4e72a9411ad50c4bba53ca",
          "id": "76da5181-a877-46cc-b5e5-5a4151dc400c",
          "timestamp": 1762330445065,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 6,
          "test": "Totais financeiros s√£o n√∫meros v√°lidos",
          "message": "expected undefined to be a number",
          "stack": "AssertionError: expected undefined to be a number\n   at Object.eval sandbox-script.js:7:4)",
          "checksum": "f4c0180f6f6cca960c63ed1aa67606f9",
          "id": "bee9cf28-951b-4b63-aaea-4e03d748454f",
          "timestamp": 1762330445065,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 7,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:6 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 7,
          "test": "Possui breakdown por forma de pagamento",
          "message": "expected { ‚Ä¶(5) } to have property 'totalDinheiro'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalDinheiro'\n   at Object.eval sandbox-script.js:8:4)",
          "checksum": "23a966e2e07ccf0b317cbd25a2f2da37",
          "id": "abea341a-1260-429d-a680-5dd4ee4812e9",
          "timestamp": 1762330445066,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 8,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:7 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 8,
          "test": "Total faturado = soma das formas de pagamento",
          "message": "expected undefined to be a number",
          "stack": "AssertionError: expected undefined to be a number\n   at Object.eval sandbox-script.js:9:4)",
          "checksum": "63f5595a40e9545a5f1cac05df7ee161",
          "id": "fe83c7e0-65d5-42fc-8fc1-e7302547a235",
          "timestamp": 1762330445067,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 9,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:8 in test-script",
        "source": {
          "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "5b58a257-9149-426f-aedb-313633a45acd",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b43a6f83-9260-4113-985e-fe285ff48668",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "d4d96ddd-56dc-44bf-8e37-a1653dd78ef7",
          "scriptId": "5b58a257-9149-426f-aedb-313633a45acd",
          "execution": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:5)",
          "checksum": "052aebc33bd9f589e83e26eb95ca0b1c",
          "id": "e1dd1bf8-0671-4ada-aad3-12d4830b3a7b",
          "timestamp": 1762330445137,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 5,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ad135c42-f682-459c-bfa8-50d62da50df2",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "352b0eae-468a-4ec7-8096-0c5b186b8d22",
          "scriptId": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
          "execution": "c4936f80-487c-4c43-a564-2f2583826290"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "ID corresponde ao criado",
          "message": "expected undefined to deeply equal null",
          "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:2:5)",
          "checksum": "f0271f67828732efb4f450b114d53a74",
          "id": "be50d07b-67a5-426c-b062-bd45e0652d47",
          "timestamp": 1762330445138,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 5,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ad135c42-f682-459c-bfa8-50d62da50df2",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "352b0eae-468a-4ec7-8096-0c5b186b8d22",
          "scriptId": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
          "execution": "c4936f80-487c-4c43-a564-2f2583826290"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Possui operador respons√°vel",
          "message": "expected { ‚Ä¶(5) } to have property 'operadorId'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'operadorId'\n   at Object.eval sandbox-script.js:3:5)",
          "checksum": "c89ebe553461dd4890e80256f2c42528",
          "id": "bef22e20-65d8-4ba0-910c-b24596c5bcde",
          "timestamp": 1762330445139,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 5,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ad135c42-f682-459c-bfa8-50d62da50df2",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "352b0eae-468a-4ec7-8096-0c5b186b8d22",
          "scriptId": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
          "execution": "c4936f80-487c-4c43-a564-2f2583826290"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Timestamps de auditoria presentes",
          "message": "expected { ‚Ä¶(5) } to have property 'createdAt'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'createdAt'\n   at Object.eval sandbox-script.js:4:5)",
          "checksum": "ee0b219b1e4324016cc5b56745cfa8a0",
          "id": "55bc6f52-e35a-4197-a0c8-2cc035e975f9",
          "timestamp": 1762330445139,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 5,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ad135c42-f682-459c-bfa8-50d62da50df2",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "352b0eae-468a-4ec7-8096-0c5b186b8d22",
          "scriptId": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
          "execution": "c4936f80-487c-4c43-a564-2f2583826290"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:6)",
          "checksum": "2a1d7f5168a589759fa9cf800d54648e",
          "id": "f8a82ffc-232a-4209-bff8-9400f0c19742",
          "timestamp": 1762330445180,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 6,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2012d740-41fe-4a79-8477-2a83ba714d97",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "e9108208-1c4e-417b-8fa4-c0b3e8b52d22",
          "scriptId": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
          "execution": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Status mudou para \"fechado\"",
          "message": "expected 403 to deeply equal 'fechado'",
          "stack": "AssertionError: expected 403 to deeply equal 'fechado'\n   at Object.eval sandbox-script.js:2:6)",
          "checksum": "ad5e51c14174eaf486e0a129b883242d",
          "id": "66c7ec52-fd84-48f7-b7d3-f2075fbc9090",
          "timestamp": 1762330445181,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 6,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2012d740-41fe-4a79-8477-2a83ba714d97",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "e9108208-1c4e-417b-8fa4-c0b3e8b52d22",
          "scriptId": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
          "execution": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Agora est√° bloqueado (RN06)",
          "message": "expected undefined to be true",
          "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:3:6)",
          "checksum": "d5f8f2f44edf266907d4c8cbb2bb934f",
          "id": "74617550-d33e-4a11-95be-71382caffdaf",
          "timestamp": 1762330445181,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 6,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2012d740-41fe-4a79-8477-2a83ba714d97",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "e9108208-1c4e-417b-8fa4-c0b3e8b52d22",
          "scriptId": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
          "execution": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Possui data de fechamento",
          "message": "expected { ‚Ä¶(5) } to have property 'dtFechamento'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'dtFechamento'\n   at Object.eval sandbox-script.js:4:6)",
          "checksum": "0d6dc84c398e0640b7693f454cfe0dfd",
          "id": "5e3f972f-91ea-4151-a754-6563cb013f3e",
          "timestamp": 1762330445182,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 6,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2012d740-41fe-4a79-8477-2a83ba714d97",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "e9108208-1c4e-417b-8fa4-c0b3e8b52d22",
          "scriptId": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
          "execution": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:7)",
          "checksum": "ad85bbd726b9195c8e7d0f4fd53c49cf",
          "id": "c51ee4d7-7ec0-4931-a9aa-001648e5e90f",
          "timestamp": 1762330445234,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 7,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "97240eb1-a88d-4b5c-918a-e4e0c6a39646",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "65b66902-a048-46c8-8919-a52687fa5741",
          "scriptId": "88a46520-c248-4654-95fd-f7c0aa9e5900",
          "execution": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Status voltou para \"aberto\"",
          "message": "expected 403 to deeply equal 'aberto'",
          "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:2:7)",
          "checksum": "448d8235c63295a07d66d04d5237e631",
          "id": "e150ccf3-e8ca-4889-abeb-64f558cd1497",
          "timestamp": 1762330445235,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 7,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "97240eb1-a88d-4b5c-918a-e4e0c6a39646",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "65b66902-a048-46c8-8919-a52687fa5741",
          "scriptId": "88a46520-c248-4654-95fd-f7c0aa9e5900",
          "execution": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Bloqueio foi removido",
          "message": "expected undefined to be false",
          "stack": "AssertionError: expected undefined to be false\n   at Object.eval sandbox-script.js:3:7)",
          "checksum": "d4236433857e402291ad4964b25f60f4",
          "id": "a7bc09cf-567d-4db5-9110-424e7762d8b6",
          "timestamp": 1762330445235,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 7,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "97240eb1-a88d-4b5c-918a-e4e0c6a39646",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "65b66902-a048-46c8-8919-a52687fa5741",
          "scriptId": "88a46520-c248-4654-95fd-f7c0aa9e5900",
          "execution": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Data de fechamento foi limpa",
          "message": "expected undefined to be null",
          "stack": "AssertionError: expected undefined to be null\n   at Object.eval sandbox-script.js:4:7)",
          "checksum": "c0adda19bbc98133d560c6aae2844dfc",
          "id": "a0439bcd-0c03-4875-9f0e-b18567f5feff",
          "timestamp": 1762330445235,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 7,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "97240eb1-a88d-4b5c-918a-e4e0c6a39646",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "65b66902-a048-46c8-8919-a52687fa5741",
          "scriptId": "88a46520-c248-4654-95fd-f7c0aa9e5900",
          "execution": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:8)",
          "checksum": "33df209a700bdcd233c92b502c857e6c",
          "id": "860de0cf-2f87-4b45-a57a-57b52774013b",
          "timestamp": 1762330445275,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 8,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fbac2e82-1af6-4297-a6b1-563dda849bf7",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "632de613-73c6-4fe4-9da2-c31d160e93fa",
          "scriptId": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
          "execution": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "message": "expected 403 to deeply equal 'fechado'",
          "showDiff": true,
          "actual": 403,
          "expected": "fechado",
          "operator": "strictEqual",
          "stack": "Error: expected 403 to deeply equal 'fechado'\n    at Object.eval (eval at exec (evalmachine.<anonymous>:66:1819788), <anonymous>:9:27)\n    at u.exec (evalmachine.<anonymous>:66:1819823)\n    at t.exports (evalmachine.<anonymous>:66:5848)\n    at Object.<anonymous> (evalmachine.<anonymous>:66:8247)\n    at evalmachine.<anonymous>:15:26\n    at Array.forEach (<anonymous>)\n    at Object.emit (evalmachine.<anonymous>:14:59)\n    at evalmachine.<anonymous>:59:24\n    at evalmachine.<anonymous>:5:21\n    at evalmachine.<anonymous>:6:18",
          "checksum": "14a2fec899e45831cd15677bfb57fe31",
          "id": "4a12d4fa-df2d-4467-a26b-4a884a4ce1c7",
          "timestamp": 1762330445277,
          "stacktrace": [
            {
              "fileName": "<anonymous>",
              "lineNumber": 9,
              "functionName": "Object.eval (eval at exec (evalmachine.<anonymous>:66:1819788),",
              "typeName": "Object",
              "methodName": "eval (eval at exec (evalmachine.<anonymous>:66:1819788),",
              "columnNumber": 27,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 66,
              "functionName": "u.exec",
              "typeName": "u",
              "methodName": "exec",
              "columnNumber": 1819823,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 66,
              "functionName": "t.exports",
              "typeName": "t",
              "methodName": "exports",
              "columnNumber": 5848,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 66,
              "functionName": "",
              "typeName": "Object",
              "methodName": null,
              "columnNumber": 8247,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 15,
              "functionName": null,
              "typeName": null,
              "methodName": null,
              "columnNumber": 26,
              "native": false
            },
            {
              "fileName": null,
              "lineNumber": null,
              "functionName": "Array.forEach",
              "typeName": "Array",
              "methodName": "forEach",
              "columnNumber": null,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 14,
              "functionName": "Object.emit",
              "typeName": "Object",
              "methodName": "emit",
              "columnNumber": 59,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 59,
              "functionName": null,
              "typeName": null,
              "methodName": null,
              "columnNumber": 24,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 5,
              "functionName": null,
              "typeName": null,
              "methodName": null,
              "columnNumber": 21,
              "native": false
            },
            {
              "fileName": "evalmachine.<anonymous>",
              "lineNumber": 6,
              "functionName": null,
              "typeName": null,
              "methodName": null,
              "columnNumber": 18,
              "native": false
            }
          ]
        },
        "at": "test-script:7:27",
        "source": {
          "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fbac2e82-1af6-4297-a6b1-563dda849bf7",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "632de613-73c6-4fe4-9da2-c31d160e93fa",
          "scriptId": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:9)",
          "checksum": "7910b9e889bc5d74b69a5043a81dbf28",
          "id": "4fa88572-fe39-4d43-9d58-c8af6cf245ef",
          "timestamp": 1762330445316,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 9,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "7da95e92-75f6-4e10-b090-6c52c03034c2",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "3669723e-4f2d-4703-9d7e-8e8e950ea73c",
          "scriptId": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
          "execution": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Status final √© \"aprovado\"",
          "message": "expected 403 to deeply equal 'aprovado'",
          "stack": "AssertionError: expected 403 to deeply equal 'aprovado'\n   at Object.eval sandbox-script.js:2:9)",
          "checksum": "51387376d34fef45706affe776d7cde0",
          "id": "9d4c0be6-6fca-4df6-9d55-dfbf9d4c0417",
          "timestamp": 1762330445317,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 9,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "7da95e92-75f6-4e10-b090-6c52c03034c2",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "3669723e-4f2d-4703-9d7e-8e8e950ea73c",
          "scriptId": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
          "execution": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Permanece bloqueado (imut√°vel RN06)",
          "message": "expected undefined to be true",
          "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:3:9)",
          "checksum": "156cd2bf25f313ff8c78cbaec1ad0877",
          "id": "989b04d5-553c-480c-8fd1-ed5efd435ceb",
          "timestamp": 1762330445317,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 9,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "7da95e92-75f6-4e10-b090-6c52c03034c2",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "3669723e-4f2d-4703-9d7e-8e8e950ea73c",
          "scriptId": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
          "execution": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 400 Bad Request",
          "message": "expected response to have status code 400 but got 403",
          "stack": "AssertionError: expected response to have status code 400 but got 403\n   at Object.eval sandbox-script.js:1:10)",
          "checksum": "6e4dad2cf091c97500e42dc4874a90f7",
          "id": "e13241fa-e285-4c10-b051-f66811609881",
          "timestamp": 1762330445357,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 10,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "1090e477-250f-4a06-b728-129231fcca7c",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e90273f4-aabe-4897-ad9a-891daaf2f924",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "f004f434-0352-4445-915c-1b058c517a78",
          "scriptId": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
          "execution": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Mensagem de erro apropriada",
          "message": "expected 'Acesso negado para a√ß√£o \\'fechamento:‚Ä¶' to include 'aprovado'",
          "stack": "AssertionError: expected 'Acesso negado para a√ß√£o \\'fechamento:‚Ä¶' to include 'aprovado'\n   at Object.eval sandbox-script.js:2:10)",
          "checksum": "948838a82451f34ae80c4e5ad2d6ff2e",
          "id": "dbe21a78-ea86-4983-a672-cec5c64d827c",
          "timestamp": 1762330445359,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 10,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "1090e477-250f-4a06-b728-129231fcca7c",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e90273f4-aabe-4897-ad9a-891daaf2f924",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "f004f434-0352-4445-915c-1b058c517a78",
          "scriptId": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
          "execution": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Tipo de erro √© BusinessException",
          "message": "expected 'Forbidden' to include 'Business'",
          "stack": "AssertionError: expected 'Forbidden' to include 'Business'\n   at Object.eval sandbox-script.js:3:10)",
          "checksum": "ff82d0ac7f5b11b14c501390a81d3a81",
          "id": "0cdf73cb-1269-4df5-9651-4e603fbf1d08",
          "timestamp": 1762330445359,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 10,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "1090e477-250f-4a06-b728-129231fcca7c",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
              }
            }
          ]
        },
        "parent": {
          "id": "99f1b629-fa6a-4595-9ec2-1b1fe932ddf6",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "ce3e8508-c4d4-447f-8d32-74d426636177",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "5b58a257-9149-426f-aedb-313633a45acd",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "6e1d48d1-cf86-4361-9bc3-b3d99f0d021b"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "6e6f6d72-a44a-496e-b64a-da9d7921d33a",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "96b0ebae-a504-4649-b761-a03195db4809"
                  }
                }
              ]
            },
            {
              "id": "09c2354c-3f55-4b3b-8f47-84b4af7f6df6",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a0a4b633-27ae-4e48-88ba-23e5c232056c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "c4936f80-487c-4c43-a564-2f2583826290"
                  }
                }
              ]
            },
            {
              "id": "872c0ea9-90b5-44b6-881d-1030da0b5ab2",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "c749a4a8-ad23-4a16-b1a2-e589c299084f",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "88e70ee7-60bf-4b81-adab-d8e1af6ca6f6"
                  }
                }
              ]
            },
            {
              "id": "413bdbd9-4b71-4fd5-b27d-e8ba4aa52458",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "88a46520-c248-4654-95fd-f7c0aa9e5900",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "8757ebc3-d510-4a86-bea9-4bbb420a7324"
                  }
                }
              ]
            },
            {
              "id": "41d19017-930e-4f29-bbd9-e66b14b0d859",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "4b2b08d0-b787-4f9f-805b-75d95f3b63ba",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "6713622b-9b85-4cde-ad29-7b5afcfd6dd9"
                  }
                }
              ]
            },
            {
              "id": "20a56762-716f-4f3c-a33a-f8fea537adfe",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9158e6c2-a2cb-41a2-af7c-1a5c20ac49b3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "fbc0786b-0092-4cad-80b2-309b93c4c3df"
                  }
                }
              ]
            },
            {
              "id": "1090e477-250f-4a06-b728-129231fcca7c",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e90273f4-aabe-4897-ad9a-891daaf2f924",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "f004f434-0352-4445-915c-1b058c517a78",
          "scriptId": "d19bf2a4-afd3-4a86-a02e-a2a182edc102",
          "execution": "6fc5ad89-d36e-4f11-9ecd-0c70df69a2ef"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 403",
          "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:11)",
          "checksum": "377aa5d56cafb2bae60d5d496e462067",
          "id": "4f7af614-34f5-4e37-b60e-92bdf51e86b9",
          "timestamp": 1762330445399,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Possui ID da pol√≠tica",
          "message": "expected { ‚Ä¶(5) } to have property 'id'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:2:11)",
          "checksum": "89a57460c3ff5f5a6fe561c3be45e058",
          "id": "1a035fc5-4cfc-4b2d-87ae-b44e617d1049",
          "timestamp": 1762330445400,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "N√≠vel √© MODELO (hierarquia RN04)",
          "message": "expected undefined to deeply equal 'MODELO'",
          "stack": "AssertionError: expected undefined to deeply equal 'MODELO'\n   at Object.eval sandbox-script.js:3:11)",
          "checksum": "226ac1b17539a987647fb6531cfe1c38",
          "id": "5c7eacee-2631-43e7-8336-d405068966c8",
          "timestamp": 1762330445401,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Tipo √© PERCENTUAL",
          "message": "expected undefined to deeply equal 'PERCENTUAL'",
          "stack": "AssertionError: expected undefined to deeply equal 'PERCENTUAL'\n   at Object.eval sandbox-script.js:4:11)",
          "checksum": "47360dbe49ea885fa40d882cecbfc509",
          "id": "cebddcc7-6a2e-4943-bc23-78549db397db",
          "timestamp": 1762330445401,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "Percentual configurado corretamente",
          "message": "expected undefined to deeply equal 12",
          "stack": "AssertionError: expected undefined to deeply equal 12\n   at Object.eval sandbox-script.js:5:11)",
          "checksum": "d160c1915e7e2496f935aae25a024760",
          "id": "1c09283d-f43c-4381-ae24-4495f4910f33",
          "timestamp": 1762330445401,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 5,
          "test": "Pol√≠tica est√° ativa",
          "message": "expected undefined to be true",
          "stack": "AssertionError: expected undefined to be true\n   at Object.eval sandbox-script.js:6:11)",
          "checksum": "a7ffe1e21d41cb65cf33b0fd3f6f91f7",
          "id": "ef15d861-59d5-4b20-b733-3b3ab130a00c",
          "timestamp": 1762330445402,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "ae7c9594-337b-4759-85d2-06211d2e8a5b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "70a9b5e4-f4fa-44a8-99bb-c0d4b9cd8f31",
          "scriptId": "8b62a299-3fd6-4981-af58-1144766606f8",
          "execution": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:12)",
          "checksum": "2594953423b3e7f9f261640e6e470c8e",
          "id": "e27c5488-9c6f-4cf5-915e-3a035dd6ea6d",
          "timestamp": 1762330445441,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 12,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "cf2c6e69-f293-4a26-8918-0eac6c9dbe16",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "5d052f81-5727-4bae-94b3-e3c06e41a6b4",
          "scriptId": "1d8ecab6-3724-4189-9bc3-478188462d76",
          "execution": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Resposta √© array",
          "message": "expected { ‚Ä¶(5) } to be an array",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:12)",
          "checksum": "2f08d665eceebe763758b2c3c310051d",
          "id": "d73ea173-67f1-4c62-a895-36632a4ae9a2",
          "timestamp": 1762330445442,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 12,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "cf2c6e69-f293-4a26-8918-0eac6c9dbe16",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "5d052f81-5727-4bae-94b3-e3c06e41a6b4",
          "scriptId": "1d8ecab6-3724-4189-9bc3-478188462d76",
          "execution": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
        }
      },
      {
        "error": {
          "name": "TypeError",
          "index": 2,
          "test": "Cont√©m a pol√≠tica rec√©m-criada",
          "message": "json.find is not a function",
          "stack": "TypeError: json.find is not a function\n   at Object.eval sandbox-script.js:3:12)",
          "checksum": "b5bd35decd1180df31013d841383101b",
          "id": "73373d00-ffb9-4317-9f2f-607db3e5d558",
          "timestamp": 1762330445443,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 12,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "cf2c6e69-f293-4a26-8918-0eac6c9dbe16",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "5d052f81-5727-4bae-94b3-e3c06e41a6b4",
          "scriptId": "1d8ecab6-3724-4189-9bc3-478188462d76",
          "execution": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:13)",
          "checksum": "53c33f18a956614aac801a07b8292a1d",
          "id": "32133861-e660-491f-aa75-68a31744b0b2",
          "timestamp": 1762330445483,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 13,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "84c87120-1961-4a96-8381-119652b2a988",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "4d96ff8c-3ace-4f88-83b3-8e0cf6d3c1e4",
          "scriptId": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
          "execution": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Resposta √© array de comiss√µes",
          "message": "expected { ‚Ä¶(5) } to be an array",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:13)",
          "checksum": "ea9bca9eeee6832dbc95920bcd2267fd",
          "id": "c68cabdc-ccaa-4c57-9009-99e439010d53",
          "timestamp": 1762330445483,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 13,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "84c87120-1961-4a96-8381-119652b2a988",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "4d96ff8c-3ace-4f88-83b3-8e0cf6d3c1e4",
          "scriptId": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
          "execution": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:15)",
          "checksum": "f81d9e7d6a39c6fa9aeabcd5c1a122c2",
          "id": "8b169c97-477a-43ef-82ee-a78fe95b9aa5",
          "timestamp": 1762330445564,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "d48387b3-249f-4749-9188-e4a834c2e48c",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "b849d67e-0350-4902-a605-ee22fc4fe741",
          "scriptId": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
          "execution": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Resposta √© array",
          "message": "expected { ‚Ä¶(5) } to be an array",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to be an array\n   at Object.eval sandbox-script.js:2:15)",
          "checksum": "af1c69652976653e3974b6132eff7b48",
          "id": "8d2656c5-1f5e-450d-ad4f-f613679af39c",
          "timestamp": 1762330445565,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
              }
            }
          ]
        },
        "parent": {
          "id": "099835f1-ae85-4e97-863c-fbc8163a10fd",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "536469fb-2465-40d1-bf88-f9a55ea5b741",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8b62a299-3fd6-4981-af58-1144766606f8",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "0e1c5004-e95a-4cf2-a11f-affc8da40cf1"
                  }
                }
              ]
            },
            {
              "id": "3900f972-ebfe-4e4b-8968-530eb61dbd39",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "1d8ecab6-3724-4189-9bc3-478188462d76",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "c1ae4b94-a8f1-421d-b5f0-1afb4a62ba80"
                  }
                }
              ]
            },
            {
              "id": "259b1f1b-72b0-4098-8d54-90e2e6ba233e",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "90fe6c43-ce36-4b39-b25f-0a979b41fff3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "ce3ca2c9-216b-4a33-aa82-5e17b3e8a9db"
                  }
                }
              ]
            },
            {
              "id": "a1662ad9-18a6-4c8b-811f-95b0749de40e",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d296b93-57e7-4ffb-83aa-9f2d3f90b260",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "12e4ed7d-4be3-4192-95c5-0e15f8f9dede"
                  }
                }
              ]
            },
            {
              "id": "796bab6c-4693-4cab-b23c-622d7e159b05",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
                  }
                }
              ]
            },
            {
              "id": "5f116071-06b9-4553-babb-471cbf605103",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "61c1210e-e83b-4988-8d1f-ec703e18ad45",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "43aef534-b0bc-4146-81f0-6079b994d285"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "d48387b3-249f-4749-9188-e4a834c2e48c",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "b849d67e-0350-4902-a605-ee22fc4fe741",
          "scriptId": "9d62dda3-da6c-41ee-8f0a-6b5d66afe77c",
          "execution": "ced465fe-44d1-4bc2-9c4a-5771eeb2607b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 403",
          "stack": "AssertionError: expected response to have status code 201 but got 403\n   at Object.eval sandbox-script.js:1:17)",
          "checksum": "324b152df17f7749a8d2258f0ae1fdd9",
          "id": "92adbea7-6fde-480f-aff7-2098a654fd69",
          "timestamp": 1762330445651,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Possui ID do fechamento mensal",
          "message": "expected { ‚Ä¶(5) } to have property 'id'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'id'\n   at Object.eval sandbox-script.js:2:17)",
          "checksum": "e61e1a1c77cc3e9e052c85657e0fb6f6",
          "id": "d98c1a9a-b4cc-4f90-8690-97913b887eea",
          "timestamp": 1762330445651,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "M√™s e ano corretos",
          "message": "expected undefined to deeply equal 11",
          "stack": "AssertionError: expected undefined to deeply equal 11\n   at Object.eval sandbox-script.js:3:17)",
          "checksum": "b8ea1dc14ef3c30c29d389168b09ba44",
          "id": "283d9c73-a524-423a-8158-a5f18e3e205b",
          "timestamp": 1762330445652,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "Status inicial √© \"aberto\"",
          "message": "expected 403 to deeply equal 'aberto'",
          "stack": "AssertionError: expected 403 to deeply equal 'aberto'\n   at Object.eval sandbox-script.js:4:17)",
          "checksum": "7a4643555c5924df67fef47404a48328",
          "id": "4da4e7cd-c700-4c7f-b6d9-898c3b18d20b",
          "timestamp": 1762330445653,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "Possui totais consolidados",
          "message": "expected { ‚Ä¶(5) } to have property 'totalReceita'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalReceita'\n   at Object.eval sandbox-script.js:5:17)",
          "checksum": "017f9faffb7e3b9f7686f844221ade00",
          "id": "d88d1d1e-4818-487b-b24d-92f6605c5752",
          "timestamp": 1762330445653,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 5,
          "test": "Possui breakdown de comiss√µes",
          "message": "expected { ‚Ä¶(5) } to have property 'totalComissoesPendentes'",
          "stack": "AssertionError: expected { ‚Ä¶(5) } to have property 'totalComissoesPendentes'\n   at Object.eval sandbox-script.js:6:17)",
          "checksum": "55655a012eb2f3aa02a92a7c3d42377e",
          "id": "25007e41-c86c-4c1f-93c2-f9a2fc035a36",
          "timestamp": 1762330445654,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "fe3b54de-7ef4-4a12-ae03-3c69493cab56",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "5f0b1b9d-c566-4da5-ac62-a8cdf3ab7913",
          "scriptId": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
          "execution": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:18)",
          "checksum": "ae293c3a9fd0473f7d3b524dcf7d66da",
          "id": "aebce633-7545-4171-8cf0-70021ecc1d51",
          "timestamp": 1762330445689,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 18,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "b19152e6-6334-437c-82ed-812952bad509",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "dbe18b5b-bbe1-4bc2-81ca-003dc8815eb3",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "8e2dc23f-5577-4a0b-9b61-61b0cf7bc2d1",
          "scriptId": "b19152e6-6334-437c-82ed-812952bad509",
          "execution": "0397193b-10a0-44bd-b00e-44d63513f2d4"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Status mudou para \"fechado\"",
          "message": "expected 403 to deeply equal 'fechado'",
          "stack": "AssertionError: expected 403 to deeply equal 'fechado'\n   at Object.eval sandbox-script.js:2:18)",
          "checksum": "432696b808705fb9b5b08c6db19e6b5d",
          "id": "a722f01d-bfaf-46b7-afc4-86c2ab9550c1",
          "timestamp": 1762330445690,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 18,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "b19152e6-6334-437c-82ed-812952bad509",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "dbe18b5b-bbe1-4bc2-81ca-003dc8815eb3",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "8e2dc23f-5577-4a0b-9b61-61b0cf7bc2d1",
          "scriptId": "b19152e6-6334-437c-82ed-812952bad509",
          "execution": "0397193b-10a0-44bd-b00e-44d63513f2d4"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 403",
          "stack": "AssertionError: expected response to have status code 200 but got 403\n   at Object.eval sandbox-script.js:1:19)",
          "checksum": "8eed18df293360ed1ae3f0272177820f",
          "id": "613cfc1b-0a5e-43dd-bdec-4c3efdd81634",
          "timestamp": 1762330445726,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 19,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "77875ef6-d930-4fb9-8aec-e3e1748d83b9",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "0c263982-ca69-4c76-a3b4-14c3106455a6",
          "scriptId": "8e65f0bb-973c-4508-8be0-c0a76e402047",
          "execution": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Status final √© \"aprovado\"",
          "message": "expected 403 to deeply equal 'aprovado'",
          "stack": "AssertionError: expected 403 to deeply equal 'aprovado'\n   at Object.eval sandbox-script.js:2:19)",
          "checksum": "37fdde5871ddfc9025c9bfca1221e7b0",
          "id": "7226c940-747c-460b-8d0a-39873e01435d",
          "timestamp": 1762330445727,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 19,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
              }
            }
          ]
        },
        "parent": {
          "id": "6335246c-3e9a-494e-a814-d88238c2b727",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "1b94f2d1-62dd-43f5-b1c5-e59438632a52",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "a26a8f3a-d49c-42b4-a4e2-0dae61ac8790",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "4b6065b9-dab3-41f3-aa7f-c6b77bc1096e"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "3cae7634-4bd2-4f39-94a0-630ba4624b4e",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "2ceb3704-f4e1-4e3f-9200-a25e9588bfc2"
                  }
                }
              ]
            },
            {
              "id": "4176a04d-0c74-4de9-a5d7-ce5d53ef9c79",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "b19152e6-6334-437c-82ed-812952bad509",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "0397193b-10a0-44bd-b00e-44d63513f2d4"
                  }
                }
              ]
            },
            {
              "id": "20b53aa8-d936-4c02-bbd1-a462213c774a",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "8e65f0bb-973c-4508-8be0-c0a76e402047",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "77875ef6-d930-4fb9-8aec-e3e1748d83b9",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "0c263982-ca69-4c76-a3b4-14c3106455a6",
          "scriptId": "8e65f0bb-973c-4508-8be0-c0a76e402047",
          "execution": "d2b6eb1e-dd5d-49f4-8097-40181ff5b6c4"
        }
      }
    ],
    "error": null
  }
}