{
  "collection": {
    "_": {
      "postman_id": "sprint3-jornadas-com-testes"
    },
    "item": [
      {
        "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
        "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
        "description": {
          "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
            "name": "Auth - Get Gerente Token",
            "request": {
              "description": {
                "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "gerente.teste@example.com"
                  },
                  {
                    "key": "password",
                    "value": "senha123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "pm.test('Resposta cont√©m access_token', function() {",
                    "    const json = pm.response.json();",
                    "    pm.expect(json).to.have.property('access_token');",
                    "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Token possui tipo Bearer', function() {",
                    "    const json = pm.response.json();",
                    "    pm.expect(json.token_type).to.eql('Bearer');",
                    "});",
                    "",
                    "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                    "const json = pm.response.json();",
                    "pm.environment.set('gerente_token', json.access_token);",
                    "pm.environment.set('token_expires_in', json.expires_in);",
                    "",
                    "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                  ],
                  "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                }
              }
            ]
          },
          {
            "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
            "name": "Auth - Get Operador Token",
            "request": {
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "operador.teste@example.com"
                  },
                  {
                    "key": "password",
                    "value": "senha123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "d70ed46e-301e-4617-8286-6a241201e985",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.environment.set('operador_token', json.access_token);",
                    "console.log('‚úÖ Token do OPERADOR salvo');"
                  ],
                  "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                }
              }
            ]
          },
          {
            "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
            "name": "Auth - Get Financeiro Token",
            "request": {
              "url": {
                "path": [
                  "realms",
                  "jetski-saas",
                  "protocol",
                  "openid-connect",
                  "token"
                ],
                "host": [
                  "{{keycloakUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "method": "POST",
              "body": {
                "mode": "urlencoded",
                "urlencoded": [
                  {
                    "key": "grant_type",
                    "value": "password"
                  },
                  {
                    "key": "client_id",
                    "value": "jetski-api"
                  },
                  {
                    "key": "client_secret",
                    "value": "jetski-secret"
                  },
                  {
                    "key": "username",
                    "value": "financeiro.teste@example.com"
                  },
                  {
                    "key": "password",
                    "value": "senha123"
                  }
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.environment.set('financeiro_token', json.access_token);",
                    "console.log('‚úÖ Token do FINANCEIRO salvo');"
                  ],
                  "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "a5563779-234d-4cce-b073-cd41b634497b",
        "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
        "description": {
          "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
            "name": "1.1 Consolidar Fechamento Di√°rio",
            "request": {
              "description": {
                "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "consolidar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "pm.test('Resposta √© JSON v√°lido', function() {",
                    "    pm.response.to.be.json;",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID do fechamento', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Status inicial √© \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                    "    pm.expect(json.bloqueado).to.be.false;",
                    "});",
                    "",
                    "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                    "    const dtReferencia = pm.variables.get('dt_referencia');",
                    "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                    "});",
                    "",
                    "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                    "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                    "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                    "});",
                    "",
                    "pm.test('Possui breakdown por forma de pagamento', function() {",
                    "    pm.expect(json).to.have.property('totalDinheiro');",
                    "    pm.expect(json).to.have.property('totalCartao');",
                    "    pm.expect(json).to.have.property('totalPix');",
                    "});",
                    "",
                    "pm.test('Total faturado = soma das formas de pagamento', function() {",
                    "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                    "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                    "});",
                    "",
                    "// Salvar ID para pr√≥ximas requisi√ß√µes",
                    "pm.environment.set('fechamento_diario_id', json.id);",
                    "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                  ],
                  "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                  "type": "text/javascript",
                  "exec": [
                    "// Definir data de refer√™ncia (hoje)",
                    "const hoje = new Date().toISOString().split('T')[0];",
                    "pm.variables.set('dt_referencia', hoje);",
                    "console.log('üìÖ Data de refer√™ncia:', hoje);"
                  ],
                  "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                }
              }
            ]
          },
          {
            "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
            "name": "1.2 Consultar Fechamento Criado",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('ID corresponde ao criado', function() {",
                    "    const id = pm.environment.get('fechamento_diario_id');",
                    "    pm.expect(json.id).to.eql(id);",
                    "});",
                    "",
                    "pm.test('Possui operador respons√°vel', function() {",
                    "    pm.expect(json).to.have.property('operadorId');",
                    "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                    "});",
                    "",
                    "pm.test('Timestamps de auditoria presentes', function() {",
                    "    pm.expect(json).to.have.property('createdAt');",
                    "    pm.expect(json).to.have.property('updatedAt');",
                    "});"
                  ],
                  "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                }
              }
            ]
          },
          {
            "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
            "name": "1.3 Fechar o Dia (Lock)",
            "request": {
              "description": {
                "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "fc6366da-088c-40ce-8add-40899817947e",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para \"fechado\"', function() {",
                    "    pm.expect(json.status).to.eql('fechado');",
                    "});",
                    "",
                    "pm.test('Agora est√° bloqueado (RN06)', function() {",
                    "    pm.expect(json.bloqueado).to.be.true;",
                    "});",
                    "",
                    "pm.test('Possui data de fechamento', function() {",
                    "    pm.expect(json).to.have.property('dtFechamento');",
                    "    pm.expect(json.dtFechamento).to.not.be.null;",
                    "});",
                    "",
                    "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                  ],
                  "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                }
              }
            ]
          },
          {
            "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
            "name": "1.4 Tentar Reabrir (Gerente)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "reabrir"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status voltou para \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('Bloqueio foi removido', function() {",
                    "    pm.expect(json.bloqueado).to.be.false;",
                    "});",
                    "",
                    "pm.test('Data de fechamento foi limpa', function() {",
                    "    pm.expect(json.dtFechamento).to.be.null;",
                    "});",
                    "",
                    "console.log('üîì Fechamento reaberto pelo GERENTE');"
                  ],
                  "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                }
              }
            ]
          },
          {
            "id": "5a622226-01b8-4706-8ce7-48887adf217c",
            "name": "1.5 Fechar Novamente",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{operador_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "pm.expect(json.status).to.eql('fechado');"
                  ],
                  "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                }
              }
            ]
          },
          {
            "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
            "name": "1.6 Aprovar Fechamento (Gerente)",
            "request": {
              "description": {
                "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© \"aprovado\"', function() {",
                    "    pm.expect(json.status).to.eql('aprovado');",
                    "});",
                    "",
                    "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                    "    pm.expect(json.bloqueado).to.be.true;",
                    "});",
                    "",
                    "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                  ],
                  "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                }
              }
            ]
          },
          {
            "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
            "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
            "request": {
              "description": {
                "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "dia",
                  "{{fechamento_diario_id}}",
                  "reabrir"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 400 Bad Request', function() {",
                    "    pm.response.to.have.status(400);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Mensagem de erro apropriada', function() {",
                    "    pm.expect(json.message).to.include('aprovado');",
                    "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                    "});",
                    "",
                    "pm.test('Tipo de erro √© BusinessException', function() {",
                    "    pm.expect(json.error).to.include('Business');",
                    "});",
                    "",
                    "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                  ],
                  "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "62871ecf-c39b-4659-9013-4c5c05997859",
        "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
        "description": {
          "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
            "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "politicas-comissao"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID da pol√≠tica', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "});",
                    "",
                    "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                    "    pm.expect(json.nivel).to.eql('MODELO');",
                    "});",
                    "",
                    "pm.test('Tipo √© PERCENTUAL', function() {",
                    "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                    "});",
                    "",
                    "pm.test('Percentual configurado corretamente', function() {",
                    "    pm.expect(json.percentual).to.eql(12.0);",
                    "});",
                    "",
                    "pm.test('Pol√≠tica est√° ativa', function() {",
                    "    pm.expect(json.ativo).to.be.true;",
                    "});",
                    "",
                    "pm.environment.set('politica_comissao_id', json.id);",
                    "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                  ],
                  "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                }
              }
            ]
          },
          {
            "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
            "name": "2.2 Listar Pol√≠ticas Ativas",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "politicas-comissao"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [
                  {
                    "key": "ativo",
                    "value": "true"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                    "    const politicaId = pm.environment.get('politica_comissao_id');",
                    "    const found = json.find(p => p.id === politicaId);",
                    "    pm.expect(found).to.not.be.undefined;",
                    "});"
                  ],
                  "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                }
              }
            ]
          },
          {
            "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
            "name": "2.3 Consultar Comiss√µes Pendentes",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "pendentes"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array de comiss√µes', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "if (json.length > 0) {",
                    "    const comissao = json[0];",
                    "    ",
                    "    pm.test('Comiss√£o possui estrutura correta', function() {",
                    "        pm.expect(comissao).to.have.property('id');",
                    "        pm.expect(comissao).to.have.property('vendedorId');",
                    "        pm.expect(comissao).to.have.property('locacaoId');",
                    "        pm.expect(comissao).to.have.property('valorBase');",
                    "        pm.expect(comissao).to.have.property('valorComissao');",
                    "        pm.expect(comissao).to.have.property('taxaAplicada');",
                    "        pm.expect(comissao).to.have.property('status');",
                    "    });",
                    "    ",
                    "    pm.test('Status √© PENDENTE', function() {",
                    "        pm.expect(comissao.status).to.eql('PENDENTE');",
                    "    });",
                    "    ",
                    "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                    "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                    "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                    "    });",
                    "    ",
                    "    // Salvar para aprova√ß√£o",
                    "    pm.environment.set('comissao_id', comissao.id);",
                    "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                    "}"
                  ],
                  "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                }
              }
            ]
          },
          {
            "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
            "name": "2.4 Aprovar Comiss√£o (Gerente)",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "{{comissao_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                  "type": "text/javascript",
                  "exec": [
                    "const comissaoId = pm.environment.get('comissao_id');",
                    "",
                    "if (!comissaoId) {",
                    "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                    "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                    "    return;",
                    "}",
                    "",
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para APROVADA', function() {",
                    "    pm.expect(json.status).to.eql('APROVADA');",
                    "});",
                    "",
                    "pm.test('Valores permanecem inalterados', function() {",
                    "    pm.expect(json).to.have.property('valorComissao');",
                    "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                    "});",
                    "",
                    "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                  ],
                  "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                }
              }
            ]
          },
          {
            "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
            "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
            "request": {
              "description": {
                "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "aguardando-pagamento"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{financeiro_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "GET"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Resposta √© array', function() {",
                    "    pm.expect(json).to.be.an('array');",
                    "});",
                    "",
                    "if (json.length > 0) {",
                    "    pm.test('Todas t√™m status APROVADA', function() {",
                    "        json.forEach(c => {",
                    "            pm.expect(c.status).to.eql('APROVADA');",
                    "        });",
                    "    });",
                    "}"
                  ],
                  "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                }
              }
            ]
          },
          {
            "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
            "name": "2.6 Pagar Comiss√£o (Financeiro)",
            "request": {
              "description": {
                "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "comissoes",
                  "{{comissao_id}}",
                  "pagar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{financeiro_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                  "type": "text/javascript",
                  "exec": [
                    "const comissaoId = pm.environment.get('comissao_id');",
                    "",
                    "if (!comissaoId) {",
                    "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                    "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                    "    return;",
                    "}",
                    "",
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© PAGA', function() {",
                    "    pm.expect(json.status).to.eql('PAGA');",
                    "});",
                    "",
                    "pm.test('Possui data de pagamento', function() {",
                    "    pm.expect(json).to.have.property('dataPagamento');",
                    "    pm.expect(json.dataPagamento).to.not.be.null;",
                    "});",
                    "",
                    "pm.test('M√©todo de pagamento registrado', function() {",
                    "    pm.expect(json).to.have.property('metodoPagamento');",
                    "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                    "});",
                    "",
                    "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                  ],
                  "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
        "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
        "description": {
          "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
          "type": "text/plain"
        },
        "item": [
          {
            "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
            "name": "3.1 Consolidar M√™s",
            "request": {
              "description": {
                "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "consolidar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "method": "POST",
              "body": {
                "mode": "raw",
                "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 201 Created', function() {",
                    "    pm.response.to.have.status(201);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Possui ID do fechamento mensal', function() {",
                    "    pm.expect(json).to.have.property('id');",
                    "});",
                    "",
                    "pm.test('M√™s e ano corretos', function() {",
                    "    const mes = pm.variables.get('mes_referencia');",
                    "    const ano = pm.variables.get('ano_referencia');",
                    "    pm.expect(json.mes).to.eql(parseInt(mes));",
                    "    pm.expect(json.ano).to.eql(parseInt(ano));",
                    "});",
                    "",
                    "pm.test('Status inicial √© \"aberto\"', function() {",
                    "    pm.expect(json.status).to.eql('aberto');",
                    "});",
                    "",
                    "pm.test('Possui totais consolidados', function() {",
                    "    pm.expect(json).to.have.property('totalReceita');",
                    "    pm.expect(json).to.have.property('totalDespesas');",
                    "    pm.expect(json).to.have.property('diasOperacao');",
                    "});",
                    "",
                    "pm.test('Possui breakdown de comiss√µes', function() {",
                    "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                    "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                    "    pm.expect(json).to.have.property('totalComissoesPagas');",
                    "});",
                    "",
                    "pm.environment.set('fechamento_mensal_id', json.id);",
                    "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                  ],
                  "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                  "type": "text/javascript",
                  "exec": [
                    "// Definir m√™s/ano (m√™s atual)",
                    "const hoje = new Date();",
                    "const mes = (hoje.getMonth() + 1).toString();",
                    "const ano = hoje.getFullYear().toString();",
                    "pm.variables.set('mes_referencia', mes);",
                    "pm.variables.set('ano_referencia', ano);",
                    "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                  ],
                  "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                }
              }
            ]
          },
          {
            "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
            "name": "3.2 Fechar M√™s",
            "request": {
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "{{fechamento_mensal_id}}",
                  "fechar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status mudou para \"fechado\"', function() {",
                    "    pm.expect(json.status).to.eql('fechado');",
                    "});"
                  ],
                  "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                }
              }
            ]
          },
          {
            "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
            "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
            "request": {
              "description": {
                "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                "type": "text/plain"
              },
              "url": {
                "path": [
                  "v1",
                  "fechamento",
                  "mes",
                  "{{fechamento_mensal_id}}",
                  "aprovar"
                ],
                "host": [
                  "{{baseUrl}}"
                ],
                "query": [],
                "variable": []
              },
              "header": [
                {
                  "key": "Authorization",
                  "value": "Bearer {{gerente_token}}"
                },
                {
                  "key": "X-Tenant-Id",
                  "value": "{{tenantId}}"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                  "type": "text/javascript",
                  "exec": [
                    "pm.test('Status 200 OK', function() {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "const json = pm.response.json();",
                    "",
                    "pm.test('Status final √© \"aprovado\"', function() {",
                    "    pm.expect(json.status).to.eql('aprovado');",
                    "});",
                    "",
                    "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                  ],
                  "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                }
              }
            ]
          }
        ],
        "event": []
      }
    ],
    "event": [
      {
        "listen": "prerequest",
        "script": {
          "id": "46d26d15-15e5-44c6-8a95-d4cbb3bd42ea",
          "type": "text/javascript",
          "exec": [
            "// Script global de pr√©-requisi√ß√£o",
            "console.log('üöÄ Executando requisi√ß√£o:', pm.info.requestName);",
            "",
            "// Validar se token est√° presente (exceto para auth)",
            "if (!pm.info.requestName.includes('Auth')) {",
            "    const token = pm.environment.get('gerente_token') || ",
            "                  pm.environment.get('operador_token') || ",
            "                  pm.environment.get('financeiro_token');",
            "    ",
            "    if (!token) {",
            "        console.warn('‚ö†Ô∏è Nenhum token encontrado - execute Setup primeiro');",
            "    }",
            "}"
          ],
          "_lastExecutionId": "604deee3-6248-4024-ac63-e3f1d2743a8d"
        }
      },
      {
        "listen": "test",
        "script": {
          "id": "5bad5d2e-5ff1-400b-9328-73176fd2c018",
          "type": "text/javascript",
          "exec": [
            "// Script global de testes",
            "pm.test('Response time √© aceit√°vel', function() {",
            "    pm.expect(pm.response.responseTime).to.be.below(5000);",
            "});",
            "",
            "pm.test('N√£o possui erros 5xx', function() {",
            "    pm.expect(pm.response.code).to.be.below(500);",
            "});"
          ],
          "_lastExecutionId": "c5df4720-9cf4-4b8f-ad4e-1e04d134193e"
        }
      }
    ],
    "variable": [
      {
        "type": "string",
        "value": "http://localhost:8090/api",
        "key": "baseUrl"
      },
      {
        "type": "string",
        "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",
        "key": "tenantId"
      },
      {
        "type": "string",
        "value": "http://localhost:8081",
        "key": "keycloakUrl"
      },
      {
        "type": "string",
        "value": "33333333-3333-3333-3333-333333333333",
        "key": "modelo_id"
      },
      {
        "type": "string",
        "value": "44444444-4444-4444-4444-444444444444",
        "key": "jetski_id"
      }
    ],
    "info": {
      "_postman_id": "sprint3-jornadas-com-testes",
      "name": "Jetski Sprint 3 - Jornadas Completas com Testes",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
      "description": {
        "content": "Collection completa com jornadas de Combust√≠vel (RN03), Comiss√µes (RN04) e Fechamento (RN06) com testes automatizados.\n\n**M√≥dulos Cobertos:**\n- ‚õΩ Combust√≠vel (RN03): pol√≠ticas, abastecimento\n- üí∞ Comiss√µes (RN04): c√°lculo hier√°rquico, aprova√ß√£o, pagamento\n- üìä Fechamento (RN06): di√°rio e mensal com bloqueio\n\n**Features:**\n- ‚úÖ Testes automatizados em cada requisi√ß√£o\n- ‚úÖ Vari√°veis din√¢micas (IDs salvos automaticamente)\n- ‚úÖ Valida√ß√£o de status codes, estrutura JSON, valores\n- ‚úÖ Scripts de pr√©-requisi√ß√£o para setup\n- ‚úÖ Cleanup autom√°tico entre jornadas\n\n**Como Usar:**\n1. Importe o environment `Local.postman_environment.json`\n2. Execute a pasta \"0Ô∏è‚É£ Setup\" para autenticar\n3. Execute as jornadas sequencialmente ou use Collection Runner\n4. Veja os resultados dos testes na aba \"Test Results\"\n\n**Vers√£o:** 0.8.0 (Sprint 3)\n**Total de Testes:** ~80 assertions automatizados",
        "type": "text/plain"
      }
    }
  },
  "environment": {
    "_": {
      "postman_variable_scope": "environment",
      "postman_exported_at": "2025-10-18T00:00:00.000Z",
      "postman_exported_using": "Postman/10.0.0"
    },
    "id": "local-env",
    "name": "Local",
    "values": [
      {
        "type": "any",
        "value": "http://localhost:8090/api",
        "key": "api_url"
      },
      {
        "type": "any",
        "value": "http://localhost:8081",
        "key": "keycloak_url"
      },
      {
        "type": "any",
        "value": "jetski-saas",
        "key": "keycloak_realm"
      },
      {
        "type": "any",
        "value": "jetski-api",
        "key": "client_id"
      },
      {
        "type": "any",
        "value": "jetski-secret",
        "key": "client_secret"
      },
      {
        "description": {
          "content": "Username for ADMIN_TENANT persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin@acme.com",
        "key": "admin_username"
      },
      {
        "description": {
          "content": "Password for ADMIN_TENANT persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin123",
        "key": "admin_password"
      },
      {
        "description": {
          "content": "Username for GERENTE persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "gerente@acme.com",
        "key": "gerente_username"
      },
      {
        "description": {
          "content": "Password for GERENTE persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "gerente123",
        "key": "gerente_password"
      },
      {
        "description": {
          "content": "Username for OPERADOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "operador@acme.com",
        "key": "operador_username"
      },
      {
        "description": {
          "content": "Password for OPERADOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "operador123",
        "key": "operador_password"
      },
      {
        "description": {
          "content": "Username for VENDEDOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "vendedor@acme.com",
        "key": "vendedor_username"
      },
      {
        "description": {
          "content": "Password for VENDEDOR persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "vendedor123",
        "key": "vendedor_password"
      },
      {
        "description": {
          "content": "Username for MECANICO persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "mecanico@acme.com",
        "key": "mecanico_username"
      },
      {
        "description": {
          "content": "Password for MECANICO persona",
          "type": "text/plain"
        },
        "type": "any",
        "value": "mecanico123",
        "key": "mecanico_password"
      },
      {
        "description": {
          "content": "Legacy - use admin_username instead",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin@acme.com",
        "key": "username"
      },
      {
        "description": {
          "content": "Legacy - use admin_password instead",
          "type": "text/plain"
        },
        "type": "any",
        "value": "admin123",
        "key": "password"
      },
      {
        "description": {
          "content": "Alias for api_url (used by Jornadas collection)",
          "type": "text/plain"
        },
        "type": "any",
        "value": "http://localhost:8090/api",
        "key": "base_url"
      },
      {
        "description": {
          "content": "Default tenant ID - ser√° atualizado automaticamente ao listar tenants",
          "type": "text/plain"
        },
        "type": "any",
        "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11",
        "key": "tenant_id"
      },
      {
        "description": {
          "content": "JWT access token - preenchido automaticamente pelo request 'Get Access Token'",
          "type": "text/plain"
        },
        "type": "any",
        "value": "",
        "key": "access_token"
      },
      {
        "description": {
          "content": "JWT refresh token - preenchido automaticamente",
          "type": "text/plain"
        },
        "type": "any",
        "value": "",
        "key": "refresh_token"
      },
      {
        "description": {
          "content": "Token expiration time in seconds",
          "type": "text/plain"
        },
        "type": "any",
        "value": null,
        "key": "token_expires_in"
      },
      {
        "type": "any",
        "value": null,
        "key": "gerente_token"
      },
      {
        "type": "any",
        "value": null,
        "key": "operador_token"
      },
      {
        "type": "any",
        "value": null,
        "key": "financeiro_token"
      }
    ]
  },
  "globals": {
    "id": "b86216a1-3974-4c90-8184-a93df2cf6959",
    "values": []
  },
  "run": {
    "stats": {
      "iterations": {
        "total": 1,
        "pending": 0,
        "failed": 0
      },
      "items": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "scripts": {
        "total": 59,
        "pending": 0,
        "failed": 14
      },
      "prerequests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "requests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "tests": {
        "total": 19,
        "pending": 0,
        "failed": 0
      },
      "assertions": {
        "total": 60,
        "pending": 0,
        "failed": 20
      },
      "testScripts": {
        "total": 38,
        "pending": 0,
        "failed": 14
      },
      "prerequestScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      }
    },
    "timings": {
      "responseAverage": 14.157894736842104,
      "responseMin": 3,
      "responseMax": 99,
      "responseSd": 24.8199053348522,
      "dnsAverage": 0,
      "dnsMin": 0,
      "dnsMax": 0,
      "dnsSd": 0,
      "firstByteAverage": 0,
      "firstByteMin": 0,
      "firstByteMax": 0,
      "firstByteSd": 0,
      "started": 1761992114045,
      "completed": 1761992114906
    },
    "executions": [
      {
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 19,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "1203b70a-522e-48e9-b659-83e14c6a7389",
          "httpRequestId": "78b8eac0-7e39-4a59-9cc6-43cfeaaaad1d"
        },
        "item": {
          "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
          "name": "Auth - Get Gerente Token",
          "request": {
            "description": {
              "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Resposta cont√©m access_token', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('access_token');",
                  "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Token possui tipo Bearer', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                  "const json = pm.response.json();",
                  "pm.environment.set('gerente_token', json.access_token);",
                  "pm.environment.set('token_expires_in', json.expires_in);",
                  "",
                  "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                ],
                "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "fa0fcadb-9914-4ade-ad97-97e5a2f79af3",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "123",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "gerente.teste@example.com"
              },
              {
                "key": "password",
                "value": "senha123"
              }
            ]
          }
        },
        "response": {
          "id": "f1c7b7cc-2561-47f6-bd83-98d838f4f81f",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "72"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              105,
              110,
              118,
              97,
              108,
              105,
              100,
              95,
              103,
              114,
              97,
              110,
              116,
              34,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              95,
              100,
              101,
              115,
              99,
              114,
              105,
              112,
              116,
              105,
              111,
              110,
              34,
              58,
              34,
              73,
              110,
              118,
              97,
              108,
              105,
              100,
              32,
              117,
              115,
              101,
              114,
              32,
              99,
              114,
              101,
              100,
              101,
              110,
              116,
              105,
              97,
              108,
              115,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 99,
          "responseSize": 72
        },
        "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:1)"
            }
          },
          {
            "assertion": "Resposta cont√©m access_token",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Resposta cont√©m access_token",
              "message": "expected { error: 'invalid_grant', ‚Ä¶(1) } to have property 'access_token'",
              "stack": "AssertionError: expected { error: 'invalid_grant', ‚Ä¶(1) } to have property 'access_token'\n   at Object.eval sandbox-script.js:2:1)"
            }
          },
          {
            "assertion": "Token possui tipo Bearer",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "Token possui tipo Bearer",
              "message": "expected undefined to deeply equal 'Bearer'",
              "stack": "AssertionError: expected undefined to deeply equal 'Bearer'\n   at Object.eval sandbox-script.js:3:1)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "b77a4323-9b70-47c1-89e3-98154476aec7",
          "length": 19,
          "cycles": 1,
          "position": 1,
          "iteration": 0,
          "httpRequestId": "0052eb0e-d171-4b9c-9e3a-e0d6b9a61e3d"
        },
        "item": {
          "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
          "name": "Auth - Get Operador Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "operador.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d70ed46e-301e-4617-8286-6a241201e985",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('operador_token', json.access_token);",
                  "console.log('‚úÖ Token do OPERADOR salvo');"
                ],
                "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "123a19c7-e54f-46dd-8a59-919840466ae4",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "124",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "operador.teste@example.com"
              },
              {
                "key": "password",
                "value": "senha123"
              }
            ]
          }
        },
        "response": {
          "id": "b08849f0-7c54-4640-9115-c99c39fc8e03",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "72"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              105,
              110,
              118,
              97,
              108,
              105,
              100,
              95,
              103,
              114,
              97,
              110,
              116,
              34,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              95,
              100,
              101,
              115,
              99,
              114,
              105,
              112,
              116,
              105,
              111,
              110,
              34,
              58,
              34,
              73,
              110,
              118,
              97,
              108,
              105,
              100,
              32,
              117,
              115,
              101,
              114,
              32,
              99,
              114,
              101,
              100,
              101,
              110,
              116,
              105,
              97,
              108,
              115,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 60,
          "responseSize": 72
        },
        "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:2)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "a5036501-4640-4636-80b1-6098a8de4053",
          "length": 19,
          "cycles": 1,
          "position": 2,
          "iteration": 0,
          "httpRequestId": "0104aac0-3314-4b5a-b7dd-884a5965ac16"
        },
        "item": {
          "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
          "name": "Auth - Get Financeiro Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "financeiro.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('financeiro_token', json.access_token);",
                  "console.log('‚úÖ Token do FINANCEIRO salvo');"
                ],
                "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8081",
            "path": [
              "realms",
              "jetski-saas",
              "protocol",
              "openid-connect",
              "token"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "876eae5c-3f20-4012-978f-5c8c4a156d32",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8081",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "126",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "urlencoded",
            "urlencoded": [
              {
                "key": "grant_type",
                "value": "password"
              },
              {
                "key": "client_id",
                "value": "jetski-api"
              },
              {
                "key": "client_secret",
                "value": "jetski-secret"
              },
              {
                "key": "username",
                "value": "financeiro.teste@example.com"
              },
              {
                "key": "password",
                "value": "senha123"
              }
            ]
          }
        },
        "response": {
          "id": "c0be95b3-a7e2-4785-9492-025c7b2b74bc",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Cache-Control",
              "value": "no-store"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "content-length",
              "value": "72"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "Referrer-Policy",
              "value": "no-referrer"
            },
            {
              "key": "Strict-Transport-Security",
              "value": "max-age=31536000; includeSubDomains"
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-Frame-Options",
              "value": "SAMEORIGIN"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              123,
              34,
              101,
              114,
              114,
              111,
              114,
              34,
              58,
              34,
              105,
              110,
              118,
              97,
              108,
              105,
              100,
              95,
              103,
              114,
              97,
              110,
              116,
              34,
              44,
              34,
              101,
              114,
              114,
              111,
              114,
              95,
              100,
              101,
              115,
              99,
              114,
              105,
              112,
              116,
              105,
              111,
              110,
              34,
              58,
              34,
              73,
              110,
              118,
              97,
              108,
              105,
              100,
              32,
              117,
              115,
              101,
              114,
              32,
              99,
              114,
              101,
              100,
              101,
              110,
              116,
              105,
              97,
              108,
              115,
              34,
              125
            ]
          },
          "cookie": [],
          "responseTime": 42,
          "responseSize": 72
        },
        "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:3)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "b05b5065-8686-4514-8a41-9483a80b85e5",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "a4e64f8a-c732-4c5e-b882-46f6d452dc1f"
        },
        "item": {
          "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "consolidar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "ba590d79-21c5-4b70-bab3-78f144893af4",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "93",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"dtReferencia\": \"2025-11-01\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
          }
        },
        "response": {
          "id": "a3e8681a-60de-4863-947f-167bf5df2701",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 5,
          "responseSize": 0
        },
        "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 401",
              "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:4)"
            }
          },
          {
            "assertion": "Resposta √© JSON v√°lido",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "Resposta √© JSON v√°lido",
              "message": "expected response body to be a valid json but got error No data, empty input at 1:1",
              "stack": "AssertionError: expected response body to be a valid json but got error No data, empty input at 1:1\n   at Object.eval sandbox-script.js:2:4)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "9562c947-f95d-4e8c-bd8c-7da60ad1c2d6",
              "timestamp": 1761992114419,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "4faed872-3859-4db4-92b1-a2b7eccbd8cf",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "b810213c-a8fc-413e-92e1-f5c2ee3e18fd"
        },
        "item": {
          "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "ee41aa3c-82f0-44fa-b036-f347f896a735",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "09a7231e-9b93-4bdd-b3c8-655a50f202a8",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 4,
          "responseSize": 0
        },
        "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:5)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "4e6d1a01-9a6a-4235-ab60-0b74ceb3a1cf",
              "timestamp": 1761992114448,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "f4b9fc1a-b756-400b-a951-9c75adb60119",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "d558960a-28a2-44bf-91c6-c140de5c934f"
        },
        "item": {
          "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "fc6366da-088c-40ce-8add-40899817947e",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "1f7e0836-4ac0-415a-b210-442d422a13ed",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "f6214476-f2a0-41f0-84d7-82b54ff2f432",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:6)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "7b02aed4-38ee-47c8-917c-f35993d32996",
              "timestamp": 1761992114477,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "bbe50522-ed09-4657-8593-f06dcea1cc7a",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "13b3fc44-044d-4b49-af21-453a85dd0344"
        },
        "item": {
          "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D",
              "reabrir"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "de002c33-e3d4-47b1-b775-4d6136e87dc6",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "6a742a48-55ba-4a48-b685-d8ade04854b2",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:7)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "6c09da67-5334-447a-8060-a8f2c3099f69",
              "timestamp": 1761992114507,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "adfda7fd-f63c-4bcb-91d0-3aacda43f5fa",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "2ac0a0a8-dd73-4e55-a192-ca86f222dc0e"
        },
        "item": {
          "id": "5a622226-01b8-4706-8ce7-48887adf217c",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "63297926-f5a0-4ffa-aa90-10c4ed15b380",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "8bdbd0d8-cd61-442a-910c-0777683fde61",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "5a622226-01b8-4706-8ce7-48887adf217c",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:8)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "fcc4f1d4-b6ac-45a5-b3a6-ac4b7fa07495",
              "timestamp": 1761992114532,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "162bcbe4-6873-4354-8c02-1ba001a6f268",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "27e9e321-2d46-4841-bc9b-57254e88d1ac"
        },
        "item": {
          "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "84c89c9f-42c0-4b7b-9698-649ac0614987",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "259214d2-b7fe-41ec-996b-944c25e4f2b6",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 11,
          "responseSize": 0
        },
        "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:9)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "76dad6f3-c585-42cc-89b2-7ef99d3f4651",
              "timestamp": 1761992114576,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "41f95fb4-7acc-4640-bbd7-ddd451f39ca5",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "369641c9-aed1-4384-96bc-3c2fde3d4f95"
        },
        "item": {
          "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "dia",
              "%7B%7Bfechamento_diario_id%7D%7D",
              "reabrir"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "6dd81cea-9a67-425f-99f0-3f4faa6e32c5",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "ed5bf9de-92b0-4edf-b479-e03120257fa9",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 4,
          "responseSize": 0
        },
        "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 400 Bad Request",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 400 Bad Request",
              "message": "expected response to have status code 400 but got 401",
              "stack": "AssertionError: expected response to have status code 400 but got 401\n   at Object.eval sandbox-script.js:1:10)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "251b594b-ceed-4c44-b531-9dd4e5a7bf8a",
              "timestamp": 1761992114604,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "8d7ddeb9-369f-4239-9eac-a69fb7f0253b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "3897ad11-fd41-4b0a-a267-284ad2815efd"
        },
        "item": {
          "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "politicas-comissao"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "315b923e-a8aa-4598-ab75-7101b82aa8d4",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "211",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"33333333-3333-3333-3333-333333333333\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
          }
        },
        "response": {
          "id": "a0850393-fa7f-43e9-b312-08b5a39c3225",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 401",
              "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:11)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "ac065b74-ac18-451a-a0a6-caca934ce951",
              "timestamp": 1761992114636,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "9f551150-3d21-46b9-8273-155b43d2b1ae",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "2285eb07-4919-4ac5-b8f6-96c499053651"
        },
        "item": {
          "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "politicas-comissao"
            ],
            "host": [
              "localhost"
            ],
            "query": [
              {
                "key": "ativo",
                "value": "true"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "a28f77cd-f928-4324-9290-78d97b554d7b",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "ae7be96a-54bb-4feb-9c37-6d7855a75b27",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 4,
          "responseSize": 0
        },
        "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:12)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "85bbde30-c24f-4e3a-8be8-f4e3ff945bc4",
              "timestamp": 1761992114663,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "e0e2f299-23b8-41fb-a5e1-e33566f29892",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "7c2c383b-2ab2-4eab-b082-3b0249fdc2ad"
        },
        "item": {
          "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "pendentes"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "85489f5a-c576-4e1d-90a9-513c37deb884",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "ef5f06d6-76c8-4072-8088-10edd5c553b5",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:13)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "a14ce4bc-2251-45df-ada6-ba244c3f85db",
              "timestamp": 1761992114689,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "b9720fb7-f6a4-4ef1-aee3-fc9171f18604",
          "length": 19,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "b74bafb4-70d3-482e-ba05-faf0643a2cfd"
        },
        "item": {
          "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
          "name": "2.4 Aprovar Comiss√£o (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "{{comissao_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                "type": "text/javascript",
                "exec": [
                  "const comissaoId = pm.environment.get('comissao_id');",
                  "",
                  "if (!comissaoId) {",
                  "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                  "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para APROVADA', function() {",
                  "    pm.expect(json.status).to.eql('APROVADA');",
                  "});",
                  "",
                  "pm.test('Valores permanecem inalterados', function() {",
                  "    pm.expect(json).to.have.property('valorComissao');",
                  "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                  "});",
                  "",
                  "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                ],
                "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "%7B%7Bcomissao_id%7D%7D",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "c4b75aef-b339-4b1e-88ca-519132e59c6f",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "60",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
          }
        },
        "response": {
          "id": "cbc8e36f-d8cb-40d4-bed4-41cd9fc29268",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 4,
          "responseSize": 0
        },
        "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Sem comiss√µes dispon√≠veis",
            "skipped": true
          }
        ]
      },
      {
        "cursor": {
          "ref": "0f3d3008-8075-4736-93ad-e38f46c20cbd",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "91c48b27-c652-4095-8a43-e2f9b929032a"
        },
        "item": {
          "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "aguardando-pagamento"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "dc46a576-ef83-4b67-b12e-61d180e7d4a3",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            }
          ],
          "method": "GET"
        },
        "response": {
          "id": "94337eb0-1be2-477e-9ed2-91a72f7f9abb",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 5,
          "responseSize": 0
        },
        "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:15)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "61b3ea54-1313-41ae-949f-e54f8ee63789",
              "timestamp": 1761992114755,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "00ba79d9-1013-4de4-8494-6d4d2ef44833",
          "length": 19,
          "cycles": 1,
          "position": 15,
          "iteration": 0,
          "httpRequestId": "77f6c1d8-786f-438e-9ee5-9371d3d5f192"
        },
        "item": {
          "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
          "name": "2.6 Pagar Comiss√£o (Financeiro)",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "{{comissao_id}}",
                "pagar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                "type": "text/javascript",
                "exec": [
                  "const comissaoId = pm.environment.get('comissao_id');",
                  "",
                  "if (!comissaoId) {",
                  "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                  "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© PAGA', function() {",
                  "    pm.expect(json.status).to.eql('PAGA');",
                  "});",
                  "",
                  "pm.test('Possui data de pagamento', function() {",
                  "    pm.expect(json).to.have.property('dataPagamento');",
                  "    pm.expect(json.dataPagamento).to.not.be.null;",
                  "});",
                  "",
                  "pm.test('M√©todo de pagamento registrado', function() {",
                  "    pm.expect(json).to.have.property('metodoPagamento');",
                  "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                  "});",
                  "",
                  "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                ],
                "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "comissoes",
              "%7B%7Bcomissao_id%7D%7D",
              "pagar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "32829b9c-3a01-4142-ae91-ff06c196119e",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "196",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"dataPagamento\": \"2025-11-01T10:15:14.769Z\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
          }
        },
        "response": {
          "id": "54dc457a-8132-4578-b681-823ac9f0a7c0",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 5,
          "responseSize": 0
        },
        "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Sem comiss√µes dispon√≠veis",
            "skipped": true
          }
        ]
      },
      {
        "cursor": {
          "ref": "e75b4040-4836-4fa1-951d-c499e6b3bcc9",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "ad76b252-963f-47c9-8a14-e42168763df1"
        },
        "item": {
          "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "consolidar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "Content-Type",
              "value": "application/json"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "3c04b736-56cc-40bc-be9c-ac1225be6df2",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "80",
              "system": true
            }
          ],
          "method": "POST",
          "body": {
            "mode": "raw",
            "raw": "{\n  \"mes\": 11,\n  \"ano\": 2025,\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
          }
        },
        "response": {
          "id": "a691422a-0e1a-41ac-b61b-f48ee78257d4",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 201 Created",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 201 Created",
              "message": "expected response to have status code 201 but got 401",
              "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:17)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "9b62c731-b9d9-424b-b877-72aa3768f8b2",
              "timestamp": 1761992114819,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "2c66a7ee-d7eb-49c4-92be-f51a58cb2525",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "16c218db-cfa1-46a8-9e4b-85b7709d352f"
        },
        "item": {
          "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "%7B%7Bfechamento_mensal_id%7D%7D",
              "fechar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "04bef21b-8bad-404d-8505-2cfdf5a28730",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "46a07776-a481-4c2e-8bc3-3e5370ca5ec0",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 5,
          "responseSize": 0
        },
        "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:18)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "b42ab5eb-d884-46ea-a5a4-56e69a283023",
              "timestamp": 1761992114878,
              "stacktrace": []
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "7ad095e1-70c6-4abe-a1ac-4232a5acf7f8",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "c7c896e8-5308-4cfb-9f71-4e668e06a544"
        },
        "item": {
          "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
              }
            }
          ]
        },
        "request": {
          "description": {
            "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
            "type": "text/plain"
          },
          "url": {
            "protocol": "http",
            "port": "8090",
            "path": [
              "api",
              "v1",
              "fechamento",
              "mes",
              "%7B%7Bfechamento_mensal_id%7D%7D",
              "aprovar"
            ],
            "host": [
              "localhost"
            ],
            "query": [],
            "variable": []
          },
          "header": [
            {
              "key": "Authorization",
              "value": "Bearer null"
            },
            {
              "key": "X-Tenant-Id",
              "value": "a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "8e3758c7-fb75-45a8-a836-db38c4076b10",
              "system": true
            },
            {
              "key": "Host",
              "value": "localhost:8090",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "dd711e60-fd13-4ee2-8bae-1b2c54b60f9d",
          "status": "Unauthorized",
          "code": 401,
          "header": [
            {
              "key": "Vary",
              "value": "Origin"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Method"
            },
            {
              "key": "Vary",
              "value": "Access-Control-Request-Headers"
            },
            {
              "key": "WWW-Authenticate",
              "value": "Bearer error=\"invalid_token\", error_description=\"An error occurred while attempting to decode the Jwt: Malformed token\", error_uri=\"https://tools.ietf.org/html/rfc6750#section-3.1\""
            },
            {
              "key": "X-Content-Type-Options",
              "value": "nosniff"
            },
            {
              "key": "X-XSS-Protection",
              "value": "0"
            },
            {
              "key": "Cache-Control",
              "value": "no-cache, no-store, max-age=0, must-revalidate"
            },
            {
              "key": "Pragma",
              "value": "no-cache"
            },
            {
              "key": "Expires",
              "value": "0"
            },
            {
              "key": "X-Frame-Options",
              "value": "DENY"
            },
            {
              "key": "Content-Length",
              "value": "0"
            },
            {
              "key": "Date",
              "value": "Sat, 01 Nov 2025 10:15:14 GMT"
            },
            {
              "key": "Keep-Alive",
              "value": "timeout=60"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": []
          },
          "cookie": [],
          "responseTime": 3,
          "responseSize": 0
        },
        "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
        "assertions": [
          {
            "assertion": "Response time √© aceit√°vel",
            "skipped": false
          },
          {
            "assertion": "N√£o possui erros 5xx",
            "skipped": false
          },
          {
            "assertion": "Status 200 OK",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "Status 200 OK",
              "message": "expected response to have status code 200 but got 401",
              "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:19)"
            }
          }
        ],
        "testScript": [
          {
            "error": {
              "type": "Error",
              "name": "JSONError",
              "message": "No data, empty input at 1:1\n\n^",
              "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
              "id": "bcfed144-ef87-413e-82e5-7a161efbe3a7",
              "timestamp": 1761992114903,
              "stacktrace": []
            }
          }
        ]
      }
    ],
    "transfers": {
      "responseTotal": 216
    },
    "failures": [
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:1)",
          "checksum": "3eb2a451d8d8a10c8b69466d6b4bd968",
          "id": "143e48e8-5c68-4344-a312-41139545c1d7",
          "timestamp": 1761992114194,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 1,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
          "name": "Auth - Get Gerente Token",
          "request": {
            "description": {
              "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Resposta cont√©m access_token', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('access_token');",
                  "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Token possui tipo Bearer', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                  "const json = pm.response.json();",
                  "pm.environment.set('gerente_token', json.access_token);",
                  "pm.environment.set('token_expires_in', json.expires_in);",
                  "",
                  "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                ],
                "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
              }
            }
          ]
        },
        "parent": {
          "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
          "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
          "description": {
            "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
              "name": "Auth - Get Gerente Token",
              "request": {
                "description": {
                  "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/x-www-form-urlencoded"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "gerente.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "pm.test('Resposta cont√©m access_token', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json).to.have.property('access_token');",
                      "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Token possui tipo Bearer', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json.token_type).to.eql('Bearer');",
                      "});",
                      "",
                      "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                      "const json = pm.response.json();",
                      "pm.environment.set('gerente_token', json.access_token);",
                      "pm.environment.set('token_expires_in', json.expires_in);",
                      "",
                      "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                    ],
                    "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                  }
                }
              ]
            },
            {
              "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
              "name": "Auth - Get Operador Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "operador.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d70ed46e-301e-4617-8286-6a241201e985",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('operador_token', json.access_token);",
                      "console.log('‚úÖ Token do OPERADOR salvo');"
                    ],
                    "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                  }
                }
              ]
            },
            {
              "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
              "name": "Auth - Get Financeiro Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "financeiro.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('financeiro_token', json.access_token);",
                      "console.log('‚úÖ Token do FINANCEIRO salvo');"
                    ],
                    "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 19,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "1203b70a-522e-48e9-b659-83e14c6a7389",
          "httpRequestId": "78b8eac0-7e39-4a59-9cc6-43cfeaaaad1d",
          "scriptId": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
          "execution": "c1d81298-684d-4947-a01f-5b9908148901"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Resposta cont√©m access_token",
          "message": "expected { error: 'invalid_grant', ‚Ä¶(1) } to have property 'access_token'",
          "stack": "AssertionError: expected { error: 'invalid_grant', ‚Ä¶(1) } to have property 'access_token'\n   at Object.eval sandbox-script.js:2:1)",
          "checksum": "18a205c49bec2a4e00d2a9d6bbfcd01c",
          "id": "bdb55d9a-274d-45e1-9f65-4a10e0feed3a",
          "timestamp": 1761992114197,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 1,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
          "name": "Auth - Get Gerente Token",
          "request": {
            "description": {
              "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Resposta cont√©m access_token', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('access_token');",
                  "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Token possui tipo Bearer', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                  "const json = pm.response.json();",
                  "pm.environment.set('gerente_token', json.access_token);",
                  "pm.environment.set('token_expires_in', json.expires_in);",
                  "",
                  "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                ],
                "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
              }
            }
          ]
        },
        "parent": {
          "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
          "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
          "description": {
            "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
              "name": "Auth - Get Gerente Token",
              "request": {
                "description": {
                  "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/x-www-form-urlencoded"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "gerente.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "pm.test('Resposta cont√©m access_token', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json).to.have.property('access_token');",
                      "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Token possui tipo Bearer', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json.token_type).to.eql('Bearer');",
                      "});",
                      "",
                      "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                      "const json = pm.response.json();",
                      "pm.environment.set('gerente_token', json.access_token);",
                      "pm.environment.set('token_expires_in', json.expires_in);",
                      "",
                      "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                    ],
                    "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                  }
                }
              ]
            },
            {
              "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
              "name": "Auth - Get Operador Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "operador.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d70ed46e-301e-4617-8286-6a241201e985",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('operador_token', json.access_token);",
                      "console.log('‚úÖ Token do OPERADOR salvo');"
                    ],
                    "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                  }
                }
              ]
            },
            {
              "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
              "name": "Auth - Get Financeiro Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "financeiro.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('financeiro_token', json.access_token);",
                      "console.log('‚úÖ Token do FINANCEIRO salvo');"
                    ],
                    "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 19,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "1203b70a-522e-48e9-b659-83e14c6a7389",
          "httpRequestId": "78b8eac0-7e39-4a59-9cc6-43cfeaaaad1d",
          "scriptId": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
          "execution": "c1d81298-684d-4947-a01f-5b9908148901"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "Token possui tipo Bearer",
          "message": "expected undefined to deeply equal 'Bearer'",
          "stack": "AssertionError: expected undefined to deeply equal 'Bearer'\n   at Object.eval sandbox-script.js:3:1)",
          "checksum": "784c5cfae5871dcfee7e1cc5434c6da3",
          "id": "d67ce21d-af01-49bf-8897-e0a767edcec8",
          "timestamp": 1761992114198,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 1,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
          "name": "Auth - Get Gerente Token",
          "request": {
            "description": {
              "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "gerente.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Resposta cont√©m access_token', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('access_token');",
                  "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Token possui tipo Bearer', function() {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json.token_type).to.eql('Bearer');",
                  "});",
                  "",
                  "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                  "const json = pm.response.json();",
                  "pm.environment.set('gerente_token', json.access_token);",
                  "pm.environment.set('token_expires_in', json.expires_in);",
                  "",
                  "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                ],
                "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
              }
            }
          ]
        },
        "parent": {
          "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
          "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
          "description": {
            "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
              "name": "Auth - Get Gerente Token",
              "request": {
                "description": {
                  "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/x-www-form-urlencoded"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "gerente.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "pm.test('Resposta cont√©m access_token', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json).to.have.property('access_token');",
                      "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Token possui tipo Bearer', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json.token_type).to.eql('Bearer');",
                      "});",
                      "",
                      "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                      "const json = pm.response.json();",
                      "pm.environment.set('gerente_token', json.access_token);",
                      "pm.environment.set('token_expires_in', json.expires_in);",
                      "",
                      "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                    ],
                    "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                  }
                }
              ]
            },
            {
              "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
              "name": "Auth - Get Operador Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "operador.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d70ed46e-301e-4617-8286-6a241201e985",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('operador_token', json.access_token);",
                      "console.log('‚úÖ Token do OPERADOR salvo');"
                    ],
                    "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                  }
                }
              ]
            },
            {
              "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
              "name": "Auth - Get Financeiro Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "financeiro.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('financeiro_token', json.access_token);",
                      "console.log('‚úÖ Token do FINANCEIRO salvo');"
                    ],
                    "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 19,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "1203b70a-522e-48e9-b659-83e14c6a7389",
          "httpRequestId": "78b8eac0-7e39-4a59-9cc6-43cfeaaaad1d",
          "scriptId": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
          "execution": "c1d81298-684d-4947-a01f-5b9908148901"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:2)",
          "checksum": "536d6d161ee26cfbfe5ae5eafaa3563a",
          "id": "c20acfff-4215-499d-879e-938f41a83255",
          "timestamp": 1761992114293,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 2,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
          "name": "Auth - Get Operador Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "operador.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "d70ed46e-301e-4617-8286-6a241201e985",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('operador_token', json.access_token);",
                  "console.log('‚úÖ Token do OPERADOR salvo');"
                ],
                "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
              }
            }
          ]
        },
        "parent": {
          "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
          "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
          "description": {
            "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
              "name": "Auth - Get Gerente Token",
              "request": {
                "description": {
                  "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/x-www-form-urlencoded"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "gerente.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "pm.test('Resposta cont√©m access_token', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json).to.have.property('access_token');",
                      "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Token possui tipo Bearer', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json.token_type).to.eql('Bearer');",
                      "});",
                      "",
                      "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                      "const json = pm.response.json();",
                      "pm.environment.set('gerente_token', json.access_token);",
                      "pm.environment.set('token_expires_in', json.expires_in);",
                      "",
                      "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                    ],
                    "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                  }
                }
              ]
            },
            {
              "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
              "name": "Auth - Get Operador Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "operador.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d70ed46e-301e-4617-8286-6a241201e985",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('operador_token', json.access_token);",
                      "console.log('‚úÖ Token do OPERADOR salvo');"
                    ],
                    "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                  }
                }
              ]
            },
            {
              "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
              "name": "Auth - Get Financeiro Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "financeiro.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('financeiro_token', json.access_token);",
                      "console.log('‚úÖ Token do FINANCEIRO salvo');"
                    ],
                    "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b77a4323-9b70-47c1-89e3-98154476aec7",
          "length": 19,
          "cycles": 1,
          "position": 1,
          "iteration": 0,
          "httpRequestId": "0052eb0e-d171-4b9c-9e3a-e0d6b9a61e3d",
          "scriptId": "d70ed46e-301e-4617-8286-6a241201e985",
          "execution": "05a533d0-3bae-46df-a73f-1ec79316d67c"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:3)",
          "checksum": "d1199bddb13c374e12ded56637b84885",
          "id": "bc3b0efa-bcff-4949-952e-4689ec0d5fe6",
          "timestamp": 1761992114368,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 3,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
          "name": "Auth - Get Financeiro Token",
          "request": {
            "url": {
              "path": [
                "realms",
                "jetski-saas",
                "protocol",
                "openid-connect",
                "token"
              ],
              "host": [
                "{{keycloakUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "method": "POST",
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "password"
                },
                {
                  "key": "client_id",
                  "value": "jetski-api"
                },
                {
                  "key": "client_secret",
                  "value": "jetski-secret"
                },
                {
                  "key": "username",
                  "value": "financeiro.teste@example.com"
                },
                {
                  "key": "password",
                  "value": "senha123"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.environment.set('financeiro_token', json.access_token);",
                  "console.log('‚úÖ Token do FINANCEIRO salvo');"
                ],
                "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
              }
            }
          ]
        },
        "parent": {
          "id": "2948d7b6-e6cc-43bf-8ca9-5998483c629d",
          "name": "0Ô∏è‚É£ Setup - Autentica√ß√£o",
          "description": {
            "content": "Autentica todas as personas necess√°rias via Keycloak.\n\n**Tokens Obtidos:**\n- GERENTE: aprova√ß√µes, pol√≠ticas\n- OPERADOR: opera√ß√µes di√°rias\n- FINANCEIRO: pagamentos",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "db2e1021-2883-41d9-a496-efa2ceb1e01f",
              "name": "Auth - Get Gerente Token",
              "request": {
                "description": {
                  "content": "Autentica persona GERENTE via Keycloak OAuth2 Password Flow.\n\n**Persona:** üë®‚Äçüíº GERENTE\n**Roles:** GERENTE, ADMIN_TENANT\n**Permiss√µes:** Aprovar fechamentos, comiss√µes, gerenciar pol√≠ticas",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/x-www-form-urlencoded"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "gerente.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e06eedfc-e1b2-4088-a080-9d753d9edacf",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "pm.test('Resposta cont√©m access_token', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json).to.have.property('access_token');",
                      "    pm.expect(json.access_token).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Token possui tipo Bearer', function() {",
                      "    const json = pm.response.json();",
                      "    pm.expect(json.token_type).to.eql('Bearer');",
                      "});",
                      "",
                      "// Salvar token para uso nas pr√≥ximas requisi√ß√µes",
                      "const json = pm.response.json();",
                      "pm.environment.set('gerente_token', json.access_token);",
                      "pm.environment.set('token_expires_in', json.expires_in);",
                      "",
                      "console.log('‚úÖ Token do GERENTE salvo com sucesso');"
                    ],
                    "_lastExecutionId": "c1d81298-684d-4947-a01f-5b9908148901"
                  }
                }
              ]
            },
            {
              "id": "745adefa-7a00-4cd8-96a6-ab139ef72ee5",
              "name": "Auth - Get Operador Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "operador.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "d70ed46e-301e-4617-8286-6a241201e985",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('operador_token', json.access_token);",
                      "console.log('‚úÖ Token do OPERADOR salvo');"
                    ],
                    "_lastExecutionId": "05a533d0-3bae-46df-a73f-1ec79316d67c"
                  }
                }
              ]
            },
            {
              "id": "5f104a4f-dc5f-439b-b69d-2de1dd6f8244",
              "name": "Auth - Get Financeiro Token",
              "request": {
                "url": {
                  "path": [
                    "realms",
                    "jetski-saas",
                    "protocol",
                    "openid-connect",
                    "token"
                  ],
                  "host": [
                    "{{keycloakUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "method": "POST",
                "body": {
                  "mode": "urlencoded",
                  "urlencoded": [
                    {
                      "key": "grant_type",
                      "value": "password"
                    },
                    {
                      "key": "client_id",
                      "value": "jetski-api"
                    },
                    {
                      "key": "client_secret",
                      "value": "jetski-secret"
                    },
                    {
                      "key": "username",
                      "value": "financeiro.teste@example.com"
                    },
                    {
                      "key": "password",
                      "value": "senha123"
                    }
                  ]
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.environment.set('financeiro_token', json.access_token);",
                      "console.log('‚úÖ Token do FINANCEIRO salvo');"
                    ],
                    "_lastExecutionId": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "a5036501-4640-4636-80b1-6098a8de4053",
          "length": 19,
          "cycles": 1,
          "position": 2,
          "iteration": 0,
          "httpRequestId": "0104aac0-3314-4b5a-b7dd-884a5965ac16",
          "scriptId": "9be6bdb6-00a4-4d04-80fc-4df4b1c52974",
          "execution": "33b180ee-270e-4324-b3c5-c08c05dd34c6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 401",
          "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:4)",
          "checksum": "8dbce7c7b1c273db44e8148b98039592",
          "id": "3d358eca-02b4-4d7d-bd84-e18d1bfef1ff",
          "timestamp": 1761992114415,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b05b5065-8686-4514-8a41-9483a80b85e5",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "a4e64f8a-c732-4c5e-b882-46f6d452dc1f",
          "scriptId": "9a125b89-1620-4293-8e9d-b8cce7262859",
          "execution": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "Resposta √© JSON v√°lido",
          "message": "expected response body to be a valid json but got error No data, empty input at 1:1",
          "stack": "AssertionError: expected response body to be a valid json but got error No data, empty input at 1:1\n   at Object.eval sandbox-script.js:2:4)",
          "checksum": "01a177c4cc3c2c377c1dcd262f9175b6",
          "id": "1b2ff05d-19fc-4cf1-beda-a4e30655d232",
          "timestamp": 1761992114417,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 4,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b05b5065-8686-4514-8a41-9483a80b85e5",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "a4e64f8a-c732-4c5e-b882-46f6d452dc1f",
          "scriptId": "9a125b89-1620-4293-8e9d-b8cce7262859",
          "execution": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "9562c947-f95d-4e8c-bd8c-7da60ad1c2d6",
          "timestamp": 1761992114419,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
          "name": "1.1 Consolidar Fechamento Di√°rio",
          "request": {
            "description": {
              "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Resposta √© JSON v√°lido', function() {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                  "    const dtReferencia = pm.variables.get('dt_referencia');",
                  "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                  "});",
                  "",
                  "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                  "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                  "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                  "});",
                  "",
                  "pm.test('Possui breakdown por forma de pagamento', function() {",
                  "    pm.expect(json).to.have.property('totalDinheiro');",
                  "    pm.expect(json).to.have.property('totalCartao');",
                  "    pm.expect(json).to.have.property('totalPix');",
                  "});",
                  "",
                  "pm.test('Total faturado = soma das formas de pagamento', function() {",
                  "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                  "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                  "});",
                  "",
                  "// Salvar ID para pr√≥ximas requisi√ß√µes",
                  "pm.environment.set('fechamento_diario_id', json.id);",
                  "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                ],
                "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                "type": "text/javascript",
                "exec": [
                  "// Definir data de refer√™ncia (hoje)",
                  "const hoje = new Date().toISOString().split('T')[0];",
                  "pm.variables.set('dt_referencia', hoje);",
                  "console.log('üìÖ Data de refer√™ncia:', hoje);"
                ],
                "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "b05b5065-8686-4514-8a41-9483a80b85e5",
          "length": 19,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "a4e64f8a-c732-4c5e-b882-46f6d452dc1f",
          "scriptId": "9a125b89-1620-4293-8e9d-b8cce7262859"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:5)",
          "checksum": "e7d990dc3eb0848292fbcc286cafe15e",
          "id": "42e9bc39-60f0-464d-a4d6-aa3d340d1f0e",
          "timestamp": 1761992114446,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 5,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4faed872-3859-4db4-92b1-a2b7eccbd8cf",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "b810213c-a8fc-413e-92e1-f5c2ee3e18fd",
          "scriptId": "13d9ea84-53a1-44c8-a451-2f2349073193",
          "execution": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "4e6d1a01-9a6a-4235-ab60-0b74ceb3a1cf",
          "timestamp": 1761992114448,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
          "name": "1.2 Consultar Fechamento Criado",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('ID corresponde ao criado', function() {",
                  "    const id = pm.environment.get('fechamento_diario_id');",
                  "    pm.expect(json.id).to.eql(id);",
                  "});",
                  "",
                  "pm.test('Possui operador respons√°vel', function() {",
                  "    pm.expect(json).to.have.property('operadorId');",
                  "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                  "});",
                  "",
                  "pm.test('Timestamps de auditoria presentes', function() {",
                  "    pm.expect(json).to.have.property('createdAt');",
                  "    pm.expect(json).to.have.property('updatedAt');",
                  "});"
                ],
                "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4faed872-3859-4db4-92b1-a2b7eccbd8cf",
          "length": 19,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "b810213c-a8fc-413e-92e1-f5c2ee3e18fd",
          "scriptId": "13d9ea84-53a1-44c8-a451-2f2349073193"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:6)",
          "checksum": "458acdd73f592c6c43ab338b57ff0445",
          "id": "2df77b72-cecd-4e5f-a02f-21660f7ad546",
          "timestamp": 1761992114474,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 6,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "fc6366da-088c-40ce-8add-40899817947e",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "f4b9fc1a-b756-400b-a951-9c75adb60119",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "d558960a-28a2-44bf-91c6-c140de5c934f",
          "scriptId": "fc6366da-088c-40ce-8add-40899817947e",
          "execution": "3355c8a7-7562-47a5-bca0-21d76e327922"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "7b02aed4-38ee-47c8-917c-f35993d32996",
          "timestamp": 1761992114477,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
          "name": "1.3 Fechar o Dia (Lock)",
          "request": {
            "description": {
              "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "fc6366da-088c-40ce-8add-40899817947e",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});",
                  "",
                  "pm.test('Agora est√° bloqueado (RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "pm.test('Possui data de fechamento', function() {",
                  "    pm.expect(json).to.have.property('dtFechamento');",
                  "    pm.expect(json.dtFechamento).to.not.be.null;",
                  "});",
                  "",
                  "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                ],
                "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "f4b9fc1a-b756-400b-a951-9c75adb60119",
          "length": 19,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "d558960a-28a2-44bf-91c6-c140de5c934f",
          "scriptId": "fc6366da-088c-40ce-8add-40899817947e"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:7)",
          "checksum": "028db8dae0e28cf4430da7b4a4aa5129",
          "id": "febcb7e4-f907-4a7c-ba90-1f8e9b2ee5ef",
          "timestamp": 1761992114506,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 7,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "bbe50522-ed09-4657-8593-f06dcea1cc7a",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "13b3fc44-044d-4b49-af21-453a85dd0344",
          "scriptId": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
          "execution": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "6c09da67-5334-447a-8060-a8f2c3099f69",
          "timestamp": 1761992114507,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
          "name": "1.4 Tentar Reabrir (Gerente)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status voltou para \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Bloqueio foi removido', function() {",
                  "    pm.expect(json.bloqueado).to.be.false;",
                  "});",
                  "",
                  "pm.test('Data de fechamento foi limpa', function() {",
                  "    pm.expect(json.dtFechamento).to.be.null;",
                  "});",
                  "",
                  "console.log('üîì Fechamento reaberto pelo GERENTE');"
                ],
                "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "bbe50522-ed09-4657-8593-f06dcea1cc7a",
          "length": 19,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "13b3fc44-044d-4b49-af21-453a85dd0344",
          "scriptId": "e336c438-f7d5-4e8f-94e3-84ea489d64a3"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:8)",
          "checksum": "4f83c692681cdfca76bd2471e42ebff4",
          "id": "9a5f3fbc-8599-4675-98be-5b61b4bdb1e7",
          "timestamp": 1761992114531,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 8,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "5a622226-01b8-4706-8ce7-48887adf217c",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "adfda7fd-f63c-4bcb-91d0-3aacda43f5fa",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "2ac0a0a8-dd73-4e55-a192-ca86f222dc0e",
          "scriptId": "ce6b5505-6082-426f-bc63-2f834bae5b26",
          "execution": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "fcc4f1d4-b6ac-45a5-b3a6-ac4b7fa07495",
          "timestamp": 1761992114532,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "5a622226-01b8-4706-8ce7-48887adf217c",
          "name": "1.5 Fechar Novamente",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{operador_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "pm.expect(json.status).to.eql('fechado');"
                ],
                "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "adfda7fd-f63c-4bcb-91d0-3aacda43f5fa",
          "length": 19,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "2ac0a0a8-dd73-4e55-a192-ca86f222dc0e",
          "scriptId": "ce6b5505-6082-426f-bc63-2f834bae5b26"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:9)",
          "checksum": "74c71c4347180a74fd629f6b6499513b",
          "id": "39c45b87-3589-4c9e-ad18-366b4b29e557",
          "timestamp": 1761992114572,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 9,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "162bcbe4-6873-4354-8c02-1ba001a6f268",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "27e9e321-2d46-4841-bc9b-57254e88d1ac",
          "scriptId": "68147f72-2b83-41df-bc36-c00b307f2300",
          "execution": "48860b5f-b550-48dc-b149-dd771c6f797a"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "76dad6f3-c585-42cc-89b2-7ef99d3f4651",
          "timestamp": 1761992114576,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
          "name": "1.6 Aprovar Fechamento (Gerente)",
          "request": {
            "description": {
              "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                  "    pm.expect(json.bloqueado).to.be.true;",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                ],
                "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "162bcbe4-6873-4354-8c02-1ba001a6f268",
          "length": 19,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "27e9e321-2d46-4841-bc9b-57254e88d1ac",
          "scriptId": "68147f72-2b83-41df-bc36-c00b307f2300"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 400 Bad Request",
          "message": "expected response to have status code 400 but got 401",
          "stack": "AssertionError: expected response to have status code 400 but got 401\n   at Object.eval sandbox-script.js:1:10)",
          "checksum": "c9cd6331f68ba527136a375794230861",
          "id": "830f1828-bee6-4120-a17b-89a671529b49",
          "timestamp": 1761992114603,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 10,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "41f95fb4-7acc-4640-bbd7-ddd451f39ca5",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "369641c9-aed1-4384-96bc-3c2fde3d4f95",
          "scriptId": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
          "execution": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "251b594b-ceed-4c44-b531-9dd4e5a7bf8a",
          "timestamp": 1761992114604,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
          "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
          "request": {
            "description": {
              "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "dia",
                "{{fechamento_diario_id}}",
                "reabrir"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 400 Bad Request', function() {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Mensagem de erro apropriada', function() {",
                  "    pm.expect(json.message).to.include('aprovado');",
                  "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                  "});",
                  "",
                  "pm.test('Tipo de erro √© BusinessException', function() {",
                  "    pm.expect(json.error).to.include('Business');",
                  "});",
                  "",
                  "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                ],
                "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
              }
            }
          ]
        },
        "parent": {
          "id": "a5563779-234d-4cce-b073-cd41b634497b",
          "name": "1Ô∏è‚É£ Jornada: Fechamento Di√°rio Completo",
          "description": {
            "content": "**Jornada Completa:** Consolida√ß√£o ‚Üí Fechamento ‚Üí Reabertura ‚Üí Aprova√ß√£o\n\n**Personas:** OPERADOR, GERENTE\n**Total de Testes:** 27 assertions\n\n**Fluxo de Estados (RN06):**\n```\nABERTO ‚Üí FECHADO ‚Üí APROVADO ‚õî\n  ‚Üë         ‚Üì\n  ‚îî‚îÄreabrir‚îÄ‚îò\n```",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "76639f4f-6ff4-48d0-8949-4bfb1aaa5143",
              "name": "1.1 Consolidar Fechamento Di√°rio",
              "request": {
                "description": {
                  "content": "**Persona:** üëî OPERADOR\n\n**Business Logic:**\n- Agrega todas as loca√ß√µes finalizadas do dia\n- Calcula totais por forma de pagamento\n- Consolida abastecimentos e comiss√µes\n- Cria fechamento com status ABERTO\n\n**Testes:** 10 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dtReferencia\": \"{{dt_referencia}}\",\n  \"observacoes\": \"Consolida√ß√£o autom√°tica via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9a125b89-1620-4293-8e9d-b8cce7262859",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "pm.test('Resposta √© JSON v√°lido', function() {",
                      "    pm.response.to.be.json;",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "    pm.expect(json.id).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('N√£o est√° bloqueado inicialmente', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de refer√™ncia corresponde ao enviado', function() {",
                      "    const dtReferencia = pm.variables.get('dt_referencia');",
                      "    pm.expect(json.dtReferencia).to.eql(dtReferencia);",
                      "});",
                      "",
                      "pm.test('Totais financeiros s√£o n√∫meros v√°lidos', function() {",
                      "    pm.expect(json.totalLocacoes).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalFaturado).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalCombustivel).to.be.a('number').and.at.least(0);",
                      "    pm.expect(json.totalComissoes).to.be.a('number').and.at.least(0);",
                      "});",
                      "",
                      "pm.test('Possui breakdown por forma de pagamento', function() {",
                      "    pm.expect(json).to.have.property('totalDinheiro');",
                      "    pm.expect(json).to.have.property('totalCartao');",
                      "    pm.expect(json).to.have.property('totalPix');",
                      "});",
                      "",
                      "pm.test('Total faturado = soma das formas de pagamento', function() {",
                      "    const soma = json.totalDinheiro + json.totalCartao + json.totalPix;",
                      "    pm.expect(json.totalFaturado).to.be.closeTo(soma, 0.01);",
                      "});",
                      "",
                      "// Salvar ID para pr√≥ximas requisi√ß√µes",
                      "pm.environment.set('fechamento_diario_id', json.id);",
                      "console.log('‚úÖ Fechamento di√°rio consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "85a06555-a4c0-40a7-b3f3-f2ac982f687f"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4410677c-4efa-4c48-928f-7e4f60cf8ddf",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir data de refer√™ncia (hoje)",
                      "const hoje = new Date().toISOString().split('T')[0];",
                      "pm.variables.set('dt_referencia', hoje);",
                      "console.log('üìÖ Data de refer√™ncia:', hoje);"
                    ],
                    "_lastExecutionId": "6a505c51-d4cc-4bf3-9084-aeecca40ef02"
                  }
                }
              ]
            },
            {
              "id": "65ab95f6-091b-4428-a140-bfc2c04b36f0",
              "name": "1.2 Consultar Fechamento Criado",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "13d9ea84-53a1-44c8-a451-2f2349073193",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('ID corresponde ao criado', function() {",
                      "    const id = pm.environment.get('fechamento_diario_id');",
                      "    pm.expect(json.id).to.eql(id);",
                      "});",
                      "",
                      "pm.test('Possui operador respons√°vel', function() {",
                      "    pm.expect(json).to.have.property('operadorId');",
                      "    pm.expect(json.operadorId).to.be.a('string').and.not.empty;",
                      "});",
                      "",
                      "pm.test('Timestamps de auditoria presentes', function() {",
                      "    pm.expect(json).to.have.property('createdAt');",
                      "    pm.expect(json).to.have.property('updatedAt');",
                      "});"
                    ],
                    "_lastExecutionId": "5b5b775a-0b45-4090-9578-f89d42ceb2a8"
                  }
                }
              ]
            },
            {
              "id": "da2a24f2-0f57-4cba-a2e5-9c8b43a36363",
              "name": "1.3 Fechar o Dia (Lock)",
              "request": {
                "description": {
                  "content": "**RN06:** Bloqueio retroativo\n\n**Efeitos:**\n- Status: aberto ‚Üí fechado\n- bloqueado = true\n- dtFechamento = now()\n- Loca√ß√µes do dia n√£o podem mais ser editadas\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "fc6366da-088c-40ce-8add-40899817947e",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});",
                      "",
                      "pm.test('Agora est√° bloqueado (RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "pm.test('Possui data de fechamento', function() {",
                      "    pm.expect(json).to.have.property('dtFechamento');",
                      "    pm.expect(json.dtFechamento).to.not.be.null;",
                      "});",
                      "",
                      "console.log('üîí Fechamento bloqueado - edi√ß√µes retroativas impedidas');"
                    ],
                    "_lastExecutionId": "3355c8a7-7562-47a5-bca0-21d76e327922"
                  }
                }
              ]
            },
            {
              "id": "d889284f-f87c-4f3f-b201-1b85bbe7d47b",
              "name": "1.4 Tentar Reabrir (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Regra:** S√≥ pode reabrir se status == \"fechado\"\n**Erro:** 400 se status == \"aprovado\" (imut√°vel)\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "e336c438-f7d5-4e8f-94e3-84ea489d64a3",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status voltou para \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Bloqueio foi removido', function() {",
                      "    pm.expect(json.bloqueado).to.be.false;",
                      "});",
                      "",
                      "pm.test('Data de fechamento foi limpa', function() {",
                      "    pm.expect(json.dtFechamento).to.be.null;",
                      "});",
                      "",
                      "console.log('üîì Fechamento reaberto pelo GERENTE');"
                    ],
                    "_lastExecutionId": "2568ed6c-432c-4d16-ae09-b6c0925063c8"
                  }
                }
              ]
            },
            {
              "id": "5a622226-01b8-4706-8ce7-48887adf217c",
              "name": "1.5 Fechar Novamente",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{operador_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ce6b5505-6082-426f-bc63-2f834bae5b26",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "pm.expect(json.status).to.eql('fechado');"
                    ],
                    "_lastExecutionId": "50c79d01-30bc-446d-b3e7-7e203d94ef7c"
                  }
                }
              ]
            },
            {
              "id": "23120f1a-04ad-4525-a8db-d7b856a6a258",
              "name": "1.6 Aprovar Fechamento (Gerente)",
              "request": {
                "description": {
                  "content": "**RN06:** Estado final imut√°vel\n\n**ABAC:** Requer role GERENTE\n\n**Efeitos:**\n- Status: fechado ‚Üí aprovado\n- N√£o pode mais ser reaberto\n- Dados financeiros consolidados\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "68147f72-2b83-41df-bc36-c00b307f2300",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "pm.test('Permanece bloqueado (imut√°vel RN06)', function() {",
                      "    pm.expect(json.bloqueado).to.be.true;",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento APROVADO - permanentemente bloqueado');"
                    ],
                    "_lastExecutionId": "48860b5f-b550-48dc-b149-dd771c6f797a"
                  }
                }
              ]
            },
            {
              "id": "ed3b8fb0-58e4-4c01-969b-e2ea66fc72e7",
              "name": "1.7 Tentar Reabrir Aprovado (Deve Falhar)",
              "request": {
                "description": {
                  "content": "**Teste Negativo**\n\nValida que fechamento aprovado n√£o pode ser reaberto (RN06)\n\n**Expected:** 400 Bad Request\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "dia",
                    "{{fechamento_diario_id}}",
                    "reabrir"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "21a3855c-8fc4-4fce-ac2a-883900c5f37b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 400 Bad Request', function() {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Mensagem de erro apropriada', function() {",
                      "    pm.expect(json.message).to.include('aprovado');",
                      "    pm.expect(json.message).to.include('n√£o pode ser reaberto');",
                      "});",
                      "",
                      "pm.test('Tipo de erro √© BusinessException', function() {",
                      "    pm.expect(json.error).to.include('Business');",
                      "});",
                      "",
                      "console.log('‚úÖ Valida√ß√£o RN06: fechamento aprovado √© imut√°vel');"
                    ],
                    "_lastExecutionId": "bb3e2502-0398-46cc-8b20-a0e3f122990d"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "41f95fb4-7acc-4640-bbd7-ddd451f39ca5",
          "length": 19,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "369641c9-aed1-4384-96bc-3c2fde3d4f95",
          "scriptId": "21a3855c-8fc4-4fce-ac2a-883900c5f37b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 401",
          "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:11)",
          "checksum": "f89f9bd94e8591435714c542c95346ef",
          "id": "2958f194-92b7-496c-90ca-ce4c0cddff41",
          "timestamp": 1761992114634,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 11,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "8d7ddeb9-369f-4239-9eac-a69fb7f0253b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "3897ad11-fd41-4b0a-a267-284ad2815efd",
          "scriptId": "19f02666-ef57-43ad-925b-de17f60afa36",
          "execution": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "ac065b74-ac18-451a-a0a6-caca934ce951",
          "timestamp": 1761992114636,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
          "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID da pol√≠tica', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                  "    pm.expect(json.nivel).to.eql('MODELO');",
                  "});",
                  "",
                  "pm.test('Tipo √© PERCENTUAL', function() {",
                  "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                  "});",
                  "",
                  "pm.test('Percentual configurado corretamente', function() {",
                  "    pm.expect(json.percentual).to.eql(12.0);",
                  "});",
                  "",
                  "pm.test('Pol√≠tica est√° ativa', function() {",
                  "    pm.expect(json.ativo).to.be.true;",
                  "});",
                  "",
                  "pm.environment.set('politica_comissao_id', json.id);",
                  "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                ],
                "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "8d7ddeb9-369f-4239-9eac-a69fb7f0253b",
          "length": 19,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "3897ad11-fd41-4b0a-a267-284ad2815efd",
          "scriptId": "19f02666-ef57-43ad-925b-de17f60afa36"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:12)",
          "checksum": "a388ab19a066ae20cb9e4477d3def919",
          "id": "7614e020-cd7c-46e2-b3ee-431023bbcb3a",
          "timestamp": 1761992114661,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 12,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "9f551150-3d21-46b9-8273-155b43d2b1ae",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "2285eb07-4919-4ac5-b8f6-96c499053651",
          "scriptId": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
          "execution": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "85bbde30-c24f-4e3a-8be8-f4e3ff945bc4",
          "timestamp": 1761992114663,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
          "name": "2.2 Listar Pol√≠ticas Ativas",
          "request": {
            "url": {
              "path": [
                "v1",
                "politicas-comissao"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [
                {
                  "key": "ativo",
                  "value": "true"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                  "    const politicaId = pm.environment.get('politica_comissao_id');",
                  "    const found = json.find(p => p.id === politicaId);",
                  "    pm.expect(found).to.not.be.undefined;",
                  "});"
                ],
                "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "9f551150-3d21-46b9-8273-155b43d2b1ae",
          "length": 19,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "2285eb07-4919-4ac5-b8f6-96c499053651",
          "scriptId": "9598a645-7c1d-4a43-a820-8891a1dbc01b"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:13)",
          "checksum": "ffc155f817903d452210d4731e014eb0",
          "id": "f4cbde97-8397-4cf2-b76c-5b7c10210220",
          "timestamp": 1761992114687,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 13,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e0e2f299-23b8-41fb-a5e1-e33566f29892",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "7c2c383b-2ab2-4eab-b082-3b0249fdc2ad",
          "scriptId": "7588bcc8-8a71-45f8-8c41-88860209c954",
          "execution": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "a14ce4bc-2251-45df-ada6-ba244c3f85db",
          "timestamp": 1761992114689,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
          "name": "2.3 Consultar Comiss√µes Pendentes",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "pendentes"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array de comiss√µes', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    const comissao = json[0];",
                  "    ",
                  "    pm.test('Comiss√£o possui estrutura correta', function() {",
                  "        pm.expect(comissao).to.have.property('id');",
                  "        pm.expect(comissao).to.have.property('vendedorId');",
                  "        pm.expect(comissao).to.have.property('locacaoId');",
                  "        pm.expect(comissao).to.have.property('valorBase');",
                  "        pm.expect(comissao).to.have.property('valorComissao');",
                  "        pm.expect(comissao).to.have.property('taxaAplicada');",
                  "        pm.expect(comissao).to.have.property('status');",
                  "    });",
                  "    ",
                  "    pm.test('Status √© PENDENTE', function() {",
                  "        pm.expect(comissao.status).to.eql('PENDENTE');",
                  "    });",
                  "    ",
                  "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                  "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                  "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                  "    });",
                  "    ",
                  "    // Salvar para aprova√ß√£o",
                  "    pm.environment.set('comissao_id', comissao.id);",
                  "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                  "}"
                ],
                "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e0e2f299-23b8-41fb-a5e1-e33566f29892",
          "length": 19,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "7c2c383b-2ab2-4eab-b082-3b0249fdc2ad",
          "scriptId": "7588bcc8-8a71-45f8-8c41-88860209c954"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:15)",
          "checksum": "699b71c9574616ec13f8062851214e7d",
          "id": "4e581476-6e78-4aab-8a12-978b9b950a65",
          "timestamp": 1761992114750,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "0f3d3008-8075-4736-93ad-e38f46c20cbd",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "91c48b27-c652-4095-8a43-e2f9b929032a",
          "scriptId": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
          "execution": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "61b3ea54-1313-41ae-949f-e54f8ee63789",
          "timestamp": 1761992114755,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
          "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
          "request": {
            "description": {
              "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "comissoes",
                "aguardando-pagamento"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{financeiro_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "GET"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Resposta √© array', function() {",
                  "    pm.expect(json).to.be.an('array');",
                  "});",
                  "",
                  "if (json.length > 0) {",
                  "    pm.test('Todas t√™m status APROVADA', function() {",
                  "        json.forEach(c => {",
                  "            pm.expect(c.status).to.eql('APROVADA');",
                  "        });",
                  "    });",
                  "}"
                ],
                "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
              }
            }
          ]
        },
        "parent": {
          "id": "62871ecf-c39b-4659-9013-4c5c05997859",
          "name": "2Ô∏è‚É£ Jornada: Comiss√µes - Do C√°lculo ao Pagamento",
          "description": {
            "content": "**Jornada Completa:** Pol√≠tica ‚Üí C√°lculo ‚Üí Aprova√ß√£o ‚Üí Pagamento\n\n**Personas:** GERENTE, FINANCEIRO\n**Total de Testes:** ~20 assertions\n\n**RN04:** Comiss√µes hier√°rquicas com workflow de aprova√ß√£o",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "c5611fef-7856-455a-b61a-ccdb172d82e7",
              "name": "2.1 Criar Pol√≠tica de Comiss√£o (Modelo)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Hierarquia de pol√≠ticas\n1. CAMPANHA (prioridade 1)\n2. **MODELO** (prioridade 2) ‚¨Ö AQUI\n3. FAIXA_DURACAO (prioridade 3)\n4. VENDEDOR (prioridade 4)\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"nivel\": \"MODELO\",\n  \"modeloId\": \"{{modelo_id}}\",\n  \"tipoComissao\": \"PERCENTUAL\",\n  \"percentual\": 12.0,\n  \"descricao\": \"Pol√≠tica teste via Postman - 12% por modelo\",\n  \"ativo\": true\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "19f02666-ef57-43ad-925b-de17f60afa36",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID da pol√≠tica', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('N√≠vel √© MODELO (hierarquia RN04)', function() {",
                      "    pm.expect(json.nivel).to.eql('MODELO');",
                      "});",
                      "",
                      "pm.test('Tipo √© PERCENTUAL', function() {",
                      "    pm.expect(json.tipoComissao).to.eql('PERCENTUAL');",
                      "});",
                      "",
                      "pm.test('Percentual configurado corretamente', function() {",
                      "    pm.expect(json.percentual).to.eql(12.0);",
                      "});",
                      "",
                      "pm.test('Pol√≠tica est√° ativa', function() {",
                      "    pm.expect(json.ativo).to.be.true;",
                      "});",
                      "",
                      "pm.environment.set('politica_comissao_id', json.id);",
                      "console.log('‚úÖ Pol√≠tica de comiss√£o criada (MODELO, 12%)');"
                    ],
                    "_lastExecutionId": "123be977-ebf2-4663-94d2-bc4a2dd458c3"
                  }
                }
              ]
            },
            {
              "id": "c5344ed7-4544-4e58-8d81-97a065155ca6",
              "name": "2.2 Listar Pol√≠ticas Ativas",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "politicas-comissao"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [
                    {
                      "key": "ativo",
                      "value": "true"
                    }
                  ],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "9598a645-7c1d-4a43-a820-8891a1dbc01b",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "pm.test('Cont√©m a pol√≠tica rec√©m-criada', function() {",
                      "    const politicaId = pm.environment.get('politica_comissao_id');",
                      "    const found = json.find(p => p.id === politicaId);",
                      "    pm.expect(found).to.not.be.undefined;",
                      "});"
                    ],
                    "_lastExecutionId": "d551deb0-d309-48f2-9c9e-5cdadb1c32fb"
                  }
                }
              ]
            },
            {
              "id": "8bc1eaef-42e9-49df-8a90-db0085060258",
              "name": "2.3 Consultar Comiss√µes Pendentes",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**RN04:** Lista comiss√µes aguardando aprova√ß√£o\n\n**Valida√ß√µes:**\n- Estrutura da comiss√£o\n- C√°lculo correto (valorBase √ó taxa)\n- Status PENDENTE\n\n**Testes:** 7 assertions (se houver comiss√µes)",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "pendentes"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "7588bcc8-8a71-45f8-8c41-88860209c954",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array de comiss√µes', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    const comissao = json[0];",
                      "    ",
                      "    pm.test('Comiss√£o possui estrutura correta', function() {",
                      "        pm.expect(comissao).to.have.property('id');",
                      "        pm.expect(comissao).to.have.property('vendedorId');",
                      "        pm.expect(comissao).to.have.property('locacaoId');",
                      "        pm.expect(comissao).to.have.property('valorBase');",
                      "        pm.expect(comissao).to.have.property('valorComissao');",
                      "        pm.expect(comissao).to.have.property('taxaAplicada');",
                      "        pm.expect(comissao).to.have.property('status');",
                      "    });",
                      "    ",
                      "    pm.test('Status √© PENDENTE', function() {",
                      "        pm.expect(comissao.status).to.eql('PENDENTE');",
                      "    });",
                      "    ",
                      "    pm.test('C√°lculo da comiss√£o (RN04)', function() {",
                      "        const esperado = comissao.valorBase * (comissao.taxaAplicada / 100);",
                      "        pm.expect(comissao.valorComissao).to.be.closeTo(esperado, 0.01);",
                      "    });",
                      "    ",
                      "    // Salvar para aprova√ß√£o",
                      "    pm.environment.set('comissao_id', comissao.id);",
                      "    console.log('‚úÖ Comiss√£o pendente encontrada:', comissao.valorComissao);",
                      "}"
                    ],
                    "_lastExecutionId": "5f35b0ac-d0e0-4491-8914-c0bd950dc5f2"
                  }
                }
              ]
            },
            {
              "id": "8492365c-5c40-41a7-8777-623fcdc8666c",
              "name": "2.4 Aprovar Comiss√£o (Gerente)",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**ABAC:** Valida al√ßada do gerente via OPA\n\n**Workflow:**\nPENDENTE ‚Üí **APROVADA** ‚Üí PAGA\n\n**Testes:** 3 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"observacoes\": \"Aprovado via Postman - performance OK\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ae1d983b-f0a8-401e-86ea-9aa9698921c5",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para aprovar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para APROVADA', function() {",
                      "    pm.expect(json.status).to.eql('APROVADA');",
                      "});",
                      "",
                      "pm.test('Valores permanecem inalterados', function() {",
                      "    pm.expect(json).to.have.property('valorComissao');",
                      "    pm.expect(json.valorComissao).to.be.a('number').and.above(0);",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o APROVADA pelo GERENTE');"
                    ],
                    "_lastExecutionId": "59596d37-d8a8-455a-bbc8-69a79a1d353b"
                  }
                }
              ]
            },
            {
              "id": "c7af89c5-f12f-48d5-b09b-1434e5935297",
              "name": "2.5 Consultar Comiss√µes Aguardando Pagamento",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\nLista comiss√µes aprovadas que ainda n√£o foram pagas.",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "aguardando-pagamento"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "GET"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Resposta √© array', function() {",
                      "    pm.expect(json).to.be.an('array');",
                      "});",
                      "",
                      "if (json.length > 0) {",
                      "    pm.test('Todas t√™m status APROVADA', function() {",
                      "        json.forEach(c => {",
                      "            pm.expect(c.status).to.eql('APROVADA');",
                      "        });",
                      "    });",
                      "}"
                    ],
                    "_lastExecutionId": "52e2f7ee-9af3-44ab-a75f-a24afebdef4a"
                  }
                }
              ]
            },
            {
              "id": "4c4352c4-43a5-44bf-96f3-7a0a1a7a811b",
              "name": "2.6 Pagar Comiss√£o (Financeiro)",
              "request": {
                "description": {
                  "content": "**Persona:** üí∞ FINANCEIRO\n\n**Workflow Completo:**\nPENDENTE ‚Üí APROVADA ‚Üí **PAGA** ‚úÖ\n\n**ABAC:** Requer role FINANCEIRO\n\n**Testes:** 4 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "comissoes",
                    "{{comissao_id}}",
                    "pagar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{financeiro_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"dataPagamento\": \"{{$isoTimestamp}}\",\n  \"metodoPagamento\": \"PIX\",\n  \"comprovante\": \"https://storage.example.com/comprovante-pix.pdf\",\n  \"observacoes\": \"Pagamento efetuado via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "94f292f1-8fa4-493e-9073-74988c599e72",
                    "type": "text/javascript",
                    "exec": [
                      "const comissaoId = pm.environment.get('comissao_id');",
                      "",
                      "if (!comissaoId) {",
                      "    console.log('‚ö†Ô∏è Sem comiss√µes para pagar - pulando teste');",
                      "    pm.test.skip('Sem comiss√µes dispon√≠veis');",
                      "    return;",
                      "}",
                      "",
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© PAGA', function() {",
                      "    pm.expect(json.status).to.eql('PAGA');",
                      "});",
                      "",
                      "pm.test('Possui data de pagamento', function() {",
                      "    pm.expect(json).to.have.property('dataPagamento');",
                      "    pm.expect(json.dataPagamento).to.not.be.null;",
                      "});",
                      "",
                      "pm.test('M√©todo de pagamento registrado', function() {",
                      "    pm.expect(json).to.have.property('metodoPagamento');",
                      "    pm.expect(json.metodoPagamento).to.eql('PIX');",
                      "});",
                      "",
                      "console.log('‚úÖ Comiss√£o PAGA pelo FINANCEIRO');"
                    ],
                    "_lastExecutionId": "9bac8cb1-6488-4716-abd9-fae4d53862f4"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "0f3d3008-8075-4736-93ad-e38f46c20cbd",
          "length": 19,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "91c48b27-c652-4095-8a43-e2f9b929032a",
          "scriptId": "00e3e4c4-32a7-422e-bf2b-fd8c4bcca2d6"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 201 Created",
          "message": "expected response to have status code 201 but got 401",
          "stack": "AssertionError: expected response to have status code 201 but got 401\n   at Object.eval sandbox-script.js:1:17)",
          "checksum": "b3f13c78292afe2d648a1414cd4c96bd",
          "id": "03536ea2-9d1f-44bf-9eef-d4e65237ef4b",
          "timestamp": 1761992114817,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 17,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e75b4040-4836-4fa1-951d-c499e6b3bcc9",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "ad76b252-963f-47c9-8a14-e42168763df1",
          "scriptId": "898480df-15a6-42e6-8562-68fddfa3520a",
          "execution": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "9b62c731-b9d9-424b-b877-72aa3768f8b2",
          "timestamp": 1761992114819,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
          "name": "3.1 Consolidar M√™s",
          "request": {
            "description": {
              "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "consolidar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 201 Created', function() {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Possui ID do fechamento mensal', function() {",
                  "    pm.expect(json).to.have.property('id');",
                  "});",
                  "",
                  "pm.test('M√™s e ano corretos', function() {",
                  "    const mes = pm.variables.get('mes_referencia');",
                  "    const ano = pm.variables.get('ano_referencia');",
                  "    pm.expect(json.mes).to.eql(parseInt(mes));",
                  "    pm.expect(json.ano).to.eql(parseInt(ano));",
                  "});",
                  "",
                  "pm.test('Status inicial √© \"aberto\"', function() {",
                  "    pm.expect(json.status).to.eql('aberto');",
                  "});",
                  "",
                  "pm.test('Possui totais consolidados', function() {",
                  "    pm.expect(json).to.have.property('totalReceita');",
                  "    pm.expect(json).to.have.property('totalDespesas');",
                  "    pm.expect(json).to.have.property('diasOperacao');",
                  "});",
                  "",
                  "pm.test('Possui breakdown de comiss√µes', function() {",
                  "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                  "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                  "    pm.expect(json).to.have.property('totalComissoesPagas');",
                  "});",
                  "",
                  "pm.environment.set('fechamento_mensal_id', json.id);",
                  "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                ],
                "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                "type": "text/javascript",
                "exec": [
                  "// Definir m√™s/ano (m√™s atual)",
                  "const hoje = new Date();",
                  "const mes = (hoje.getMonth() + 1).toString();",
                  "const ano = hoje.getFullYear().toString();",
                  "pm.variables.set('mes_referencia', mes);",
                  "pm.variables.set('ano_referencia', ano);",
                  "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                ],
                "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "e75b4040-4836-4fa1-951d-c499e6b3bcc9",
          "length": 19,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "ad76b252-963f-47c9-8a14-e42168763df1",
          "scriptId": "898480df-15a6-42e6-8562-68fddfa3520a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:18)",
          "checksum": "cd72f33258a74483e0a3726af86cb25a",
          "id": "e14d2e53-bf02-4b76-9c03-fd39f3a9e554",
          "timestamp": 1761992114875,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 18,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2c66a7ee-d7eb-49c4-92be-f51a58cb2525",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "16c218db-cfa1-46a8-9e4b-85b7709d352f",
          "scriptId": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
          "execution": "03706da5-9991-4284-a668-d3e0b75047c3"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "b42ab5eb-d884-46ea-a5a4-56e69a283023",
          "timestamp": 1761992114878,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
          "name": "3.2 Fechar M√™s",
          "request": {
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "fechar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status mudou para \"fechado\"', function() {",
                  "    pm.expect(json.status).to.eql('fechado');",
                  "});"
                ],
                "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "2c66a7ee-d7eb-49c4-92be-f51a58cb2525",
          "length": 19,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "16c218db-cfa1-46a8-9e4b-85b7709d352f",
          "scriptId": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "Status 200 OK",
          "message": "expected response to have status code 200 but got 401",
          "stack": "AssertionError: expected response to have status code 200 but got 401\n   at Object.eval sandbox-script.js:1:19)",
          "checksum": "4306e3179a0e78223db2c4db21131194",
          "id": "7a9a75bf-a222-47cd-81f5-42c5677d10b1",
          "timestamp": 1761992114901,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 19,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "7ad095e1-70c6-4abe-a1ac-4232a5acf7f8",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "c7c896e8-5308-4cfb-9f71-4e668e06a544",
          "scriptId": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
          "execution": "24346c64-e3b0-4e25-ad98-73f0febd0127"
        }
      },
      {
        "error": {
          "type": "Error",
          "name": "JSONError",
          "message": "No data, empty input at 1:1\n\n^",
          "checksum": "dd12d8ea84467ec693558d8bb4288cb9",
          "id": "bcfed144-ef87-413e-82e5-7a161efbe3a7",
          "timestamp": 1761992114903,
          "stacktrace": []
        },
        "at": "test-script",
        "source": {
          "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
          "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
          "request": {
            "description": {
              "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
              "type": "text/plain"
            },
            "url": {
              "path": [
                "v1",
                "fechamento",
                "mes",
                "{{fechamento_mensal_id}}",
                "aprovar"
              ],
              "host": [
                "{{baseUrl}}"
              ],
              "query": [],
              "variable": []
            },
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{gerente_token}}"
              },
              {
                "key": "X-Tenant-Id",
                "value": "{{tenantId}}"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200 OK', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const json = pm.response.json();",
                  "",
                  "pm.test('Status final √© \"aprovado\"', function() {",
                  "    pm.expect(json.status).to.eql('aprovado');",
                  "});",
                  "",
                  "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                ],
                "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
              }
            }
          ]
        },
        "parent": {
          "id": "83d2031d-03cf-4ee4-bcfa-4cc0780271c8",
          "name": "3Ô∏è‚É£ Jornada: Fechamento Mensal",
          "description": {
            "content": "**Jornada:** Consolida√ß√£o mensal com libera√ß√£o de comiss√µes\n\n**Persona:** GERENTE\n**Total de Testes:** ~8 assertions",
            "type": "text/plain"
          },
          "item": [
            {
              "id": "a9ce8be2-50cc-4226-be47-800e736b261e",
              "name": "3.1 Consolidar M√™s",
              "request": {
                "description": {
                  "content": "**Persona:** üë®‚Äçüíº GERENTE\n\n**Agrega√ß√£o:**\n- Soma todos os fechamentos di√°rios do m√™s\n- Calcula receita, despesas, comiss√µes\n- Identifica diverg√™ncias\n\n**Testes:** 6 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "consolidar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"mes\": {{mes_referencia}},\n  \"ano\": {{ano_referencia}},\n  \"observacoes\": \"Fechamento mensal via Postman\"\n}"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "898480df-15a6-42e6-8562-68fddfa3520a",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 201 Created', function() {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Possui ID do fechamento mensal', function() {",
                      "    pm.expect(json).to.have.property('id');",
                      "});",
                      "",
                      "pm.test('M√™s e ano corretos', function() {",
                      "    const mes = pm.variables.get('mes_referencia');",
                      "    const ano = pm.variables.get('ano_referencia');",
                      "    pm.expect(json.mes).to.eql(parseInt(mes));",
                      "    pm.expect(json.ano).to.eql(parseInt(ano));",
                      "});",
                      "",
                      "pm.test('Status inicial √© \"aberto\"', function() {",
                      "    pm.expect(json.status).to.eql('aberto');",
                      "});",
                      "",
                      "pm.test('Possui totais consolidados', function() {",
                      "    pm.expect(json).to.have.property('totalReceita');",
                      "    pm.expect(json).to.have.property('totalDespesas');",
                      "    pm.expect(json).to.have.property('diasOperacao');",
                      "});",
                      "",
                      "pm.test('Possui breakdown de comiss√µes', function() {",
                      "    pm.expect(json).to.have.property('totalComissoesPendentes');",
                      "    pm.expect(json).to.have.property('totalComissoesAprovadas');",
                      "    pm.expect(json).to.have.property('totalComissoesPagas');",
                      "});",
                      "",
                      "pm.environment.set('fechamento_mensal_id', json.id);",
                      "console.log('‚úÖ Fechamento mensal consolidado:', json.id);"
                    ],
                    "_lastExecutionId": "0e6af9c4-dd53-4911-9dfe-7c29fa1425ed"
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "eff776ac-2a05-432d-8880-f0f4f30c06d8",
                    "type": "text/javascript",
                    "exec": [
                      "// Definir m√™s/ano (m√™s atual)",
                      "const hoje = new Date();",
                      "const mes = (hoje.getMonth() + 1).toString();",
                      "const ano = hoje.getFullYear().toString();",
                      "pm.variables.set('mes_referencia', mes);",
                      "pm.variables.set('ano_referencia', ano);",
                      "console.log(`üìÖ Consolidando: ${mes}/${ano}`);"
                    ],
                    "_lastExecutionId": "f36ae70f-0da3-4957-9582-de76ea126348"
                  }
                }
              ]
            },
            {
              "id": "08d1338e-9be4-493a-9feb-0b3017fef14f",
              "name": "3.2 Fechar M√™s",
              "request": {
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "fechar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "ab670f2c-a6d7-4940-a5b5-4b7c37dd0254",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status mudou para \"fechado\"', function() {",
                      "    pm.expect(json.status).to.eql('fechado');",
                      "});"
                    ],
                    "_lastExecutionId": "03706da5-9991-4284-a668-d3e0b75047c3"
                  }
                }
              ]
            },
            {
              "id": "30f2bfea-e040-44b4-bb01-18e8cd1003ab",
              "name": "3.3 Aprovar M√™s (Libera Comiss√µes)",
              "request": {
                "description": {
                  "content": "**RN06 + RN04:** Aprova√ß√£o mensal libera workflow de comiss√µes\n\n**Trigger:** Comiss√µes PENDENTES ‚Üí dispon√≠veis para aprova√ß√£o\n\n**Testes:** 2 assertions",
                  "type": "text/plain"
                },
                "url": {
                  "path": [
                    "v1",
                    "fechamento",
                    "mes",
                    "{{fechamento_mensal_id}}",
                    "aprovar"
                  ],
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "query": [],
                  "variable": []
                },
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{gerente_token}}"
                  },
                  {
                    "key": "X-Tenant-Id",
                    "value": "{{tenantId}}"
                  }
                ],
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "id": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5",
                    "type": "text/javascript",
                    "exec": [
                      "pm.test('Status 200 OK', function() {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "const json = pm.response.json();",
                      "",
                      "pm.test('Status final √© \"aprovado\"', function() {",
                      "    pm.expect(json.status).to.eql('aprovado');",
                      "});",
                      "",
                      "console.log('‚úÖ Fechamento mensal APROVADO - comiss√µes liberadas para pagamento');"
                    ],
                    "_lastExecutionId": "24346c64-e3b0-4e25-ad98-73f0febd0127"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "7ad095e1-70c6-4abe-a1ac-4232a5acf7f8",
          "length": 19,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "c7c896e8-5308-4cfb-9f71-4e668e06a544",
          "scriptId": "3d0ece28-bbea-4eb3-9f4d-1e9613e901e5"
        }
      }
    ],
    "error": null
  }
}